;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_scheme";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.geometry":dependencies[0],"prezi_cet_model_editor":dependencies[1],"prezi_editor_commander":dependencies[2],"prezi_featureswitcher":dependencies[3],"prezi_i18n":dependencies[4],"prezi_image_color_thief":dependencies[5],"prezi_logger":dependencies[6],"prezi_plugin_api":dependencies[7],"prezi_plugin_meta":dependencies[8],"prezi_styleschemeprovider":dependencies[9]}};})());};})(arguments);var moduleImpl=(function(){return module(function(m){var B=m.dependencies["prezi.geometry"],v=m.dependencies.prezi_cet_model_editor,d=m.dependencies.prezi_i18n,h=m.dependencies.prezi_logger,g=m.dependencies.prezi_plugin_api,C=m.dependencies.prezi_plugin_meta,w=m.dependencies.prezi_editor_commander,D=m.dependencies.prezi_styleschemeprovider,y=m.dependencies.prezi_featureswitcher,E=m.dependencies.prezi_image_color_thief,k={},n=this&&k.__awaiter||function(b,a,c,e){function l(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||
(c=Promise))(function(c,d){function f(a){try{u(e.next(a))}catch(t){d(t)}}function g(a){try{u(e["throw"](a))}catch(t){d(t)}}function u(a){a.done?c(a.value):l(a.value).then(f,g)}u((e=e.apply(b,a||[])).next())})};Object.defineProperty(k,"__esModule",{value:!0});var z=v.base.AssetKind,r;(function(b){b[b.LOADED=0]="LOADED";b[b.MISSING=1]="MISSING";b[b.UNINITIALIZED=2]="UNINITIALIZED"})(r=k.TemplateKind||(k.TemplateKind={}));var p;(function(b){b.Add="Add";b.Edit="Edit";b.None="None"})(p=k.SchemeCustomizerMode||
(k.SchemeCustomizerMode={}));class q{constructor(b,a,c){this.session=a;this.uiRoot=c;this.logger=h.LoggerModule.getLoggerManager().createLogger("prezi_scheme.SchemeStateManager");this.styleSchemeProvider=D.StyleSchemeProviderModule.getStyleSchemeProvider(b);b.onLicenseChange((a)=>{a=a.pitchCustomSchemes&&!y.isActive("js-scheme-paywall");this.uiRoot.getState().hasPremium!==a&&(this.uiRoot.setState({hasPremium:a}),this.loadSchemes())});b.onStyleSheetChange(()=>n(this,void 0,void 0,function*(){const {template:b}=
this.uiRoot.getState();if(b.kind===r.UNINITIALIZED||y.isActive("js-developer-features")){const c=a.document.read((a)=>a.meta.templateInfo);if(b.kind!==r.LOADED||b.id!==c.templateId){try{const b=yield a.document.progressiveAssetManager.getTemplateStyleSheetReader(c),e=w.EditorCommander.createColorMixCommander(),l=Object.assign(Object.assign({},e.schemeFromPrezi(b)),{isCustom:!1,id:c.templateId});this.uiRoot.setState({template:{kind:r.LOADED,id:c.templateId,colors:l}})}catch(u){this.uiRoot.setState({template:{kind:r.MISSING}})}this.updateSelectionAndUnsavedItem()}}}));
b.onDocumentChange(()=>{const {scheme:a}=this.getCurrentPreziSchemeAndId(),b=this.uiRoot.getState().currentPreziScheme,{isSidebarOpen:c,isCustomizerOpen:d}=this.uiRoot.getState(),f=c&&!d;this.uiRoot.setState({currentPreziScheme:a});f&&!q.areSchemesEqual(b,a)&&this.updateSelectionAndUnsavedItem()});b.onNetworkStatusChange((a)=>{this.uiRoot.setState({isNetworkOffline:a===g.NetworkStatus.Offline});const {customSchemeIsSuccesfullyLoaded:b}=this.uiRoot.getState();a!==g.NetworkStatus.Online||b||this.loadSchemes()});
b.onCurrentTopicChange((a)=>{const b=this.session.document.read((b)=>b.lookup.base(a)&&b.lookup.base(a).is(v.base.ObjectKind.overview));this.uiRoot.setState({onOverview:b})})}static initState(){return{anySelectedElement:!1,currentThumbnailUrl:null,currentPreziScheme:null,customSchemeList:[],customSchemeDisplayProgress:g.ListProgress.finished,customSchemeIsSuccesfullyLoaded:!1,editedScheme:null,hasPremium:!1,isCustomizerOpen:!1,isNetworkOffline:!0,isSidebarOpen:!1,presetSchemeList:[],preziHasBackground:!1,
savedEditedScheme:null,schemeCustomizerMode:p.None,selectedScheme:null,template:{kind:r.UNINITIALIZED},unsavedStyleScheme:null,onOverview:!0}}loadSchemes(){return n(this,void 0,void 0,function*(){const {hasPremium:b,isNetworkOffline:a,customSchemeDisplayProgress:c}=this.uiRoot.getState(),e=this.styleSchemeProvider.getPresetStyleSchemes();if(b&&!a){this.uiRoot.setState({customSchemeDisplayProgress:g.ListProgress.working});let a;try{a=yield this.styleSchemeProvider.getCustomStyleSchemes()}catch(u){a=
[],this.showErrorLoadSchemes()}this.uiRoot.setState({presetSchemeList:e,customSchemeList:a,customSchemeDisplayProgress:g.ListProgress.finished,customSchemeIsSuccesfullyLoaded:!0})}else this.uiRoot.setState({presetSchemeList:e,customSchemeDisplayProgress:a?g.ListProgress.finished:c});this.updateSelectionAndUnsavedItem()})}updateAnySelectedElement(b){this.uiRoot.setState({anySelectedElement:b})}openSidebar(){return n(this,void 0,void 0,function*(){const {isCustomizerOpen:b}=this.uiRoot.getState();h.avro.Avro.createDefaultLogger().logShowPresentationColorSchemeOptions({colorscheme_sidebar_mode:this.uiRoot.getState().isCustomizerOpen?
"SCHEMECUSTOMIZER":"SCHEMELIST"});this.session.document.read((a)=>{a=a.background.layers[0];this.uiRoot.setState({preziHasBackground:null!=a&&a.kind!==z.swf&&null!=a.url})});b?this.uiRoot.sidebar.open(f.SchemePlugin.SIDEBAR_ID,f.SchemePlugin.CUSTOMIZER_PAGE_ID):(this.uiRoot.sidebar.open(f.SchemePlugin.SIDEBAR_ID),this.updateSelectionAndUnsavedItem());this.uiRoot.setState({isSidebarOpen:!0})})}closeSidebar(){this.uiRoot.sidebar.close(f.SchemePlugin.SIDEBAR_ID)}toggleSidebar(){return n(this,void 0,
void 0,function*(){const {isSidebarOpen:b}=this.uiRoot.getState();b?this.closeSidebar():this.openSidebar()})}logAndApplyScheme(b,a){h.avro.Avro.createDefaultLogger().logSelectPresentationColorScheme({presentation_color_scheme_id:a.id});this.uiRoot.setState({selectedScheme:a});this.applySelectedScheme(b)}applySelectedScheme(b){const {selectedScheme:a}=this.uiRoot.getState();null!=a&&this.session.document.executeApiCommand(b,this.applyScheme(a))}applyScheme(b){const {id:a}=b;var c=this.styleSchemeProvider.createColorPaletteFromStyleScheme(b);
b=w.EditorCommander.createColorMixCommander();c=b.createMapping(c);return b.applyPaletteCmd(this.session.document.progressiveAssetManager,c,a,null)}getCurrentPreziScheme(){const b=w.EditorCommander.createColorMixCommander();return this.session.document.read((a)=>b.schemeFromPrezi(a.styleSheet))}switchToNextScheme(b){const {selectedScheme:a}=this.uiRoot.getState();var c=null;if(null==a)c=this.uiRoot.getState().presetSchemeList[0];else{c=this.uiRoot.getState().presetSchemeList;const b=(c.findIndex((b)=>
b.id===a.id)+1)%c.length;c=c[b]}this.uiRoot.setState({selectedScheme:c,currentThumbnailUrl:c.thumbnailUrl});this.applySelectedScheme(b);h.avro.Avro.createDefaultLogger().logRemixPresentationColorScheme({presentation_color_scheme_id:c.id})}handleBackFromEditing(){this.openRootPage();this.updateSelectionAndUnsavedItem()}saveScheme(b){return n(this,void 0,void 0,function*(){try{let a=b;b.title&&0!==b.title.length||(a=Object.assign(Object.assign({},b),{title:this.generateDefaultTitle()}));return yield this.styleSchemeProvider.saveCustomStyleScheme(a)}catch(a){return h.avro.Avro.createDefaultLogger().logLoadedColorSchemeSaveErrorDialog({presentation_color_scheme_id:b.id}),
this.showErrorSaveScheme(),null}})}deleteScheme(b){return n(this,void 0,void 0,function*(){try{return yield this.styleSchemeProvider.deleteCustomStyleScheme(b),!0}catch(a){return this.showErrorDeleteScheme(),!1}})}openSchemeCustomizer(b,a){var {selectedScheme:c}=this.uiRoot.getState();null!=c&&(b=a===p.Edit?Object.assign(Object.assign({},c),{id:c.isCustom?c.id:"",title:c.isCustom?c.title:""}):Object.assign(Object.assign({},c),{id:"",title:"",isCustom:!0}),c=a===p.Edit?Object.assign({},c):null,this.uiRoot.setState({isCustomizerOpen:!0,
schemeCustomizerMode:a,editedScheme:b,savedEditedScheme:c}),this.uiRoot.sidebar.open(f.SchemePlugin.SIDEBAR_ID,f.SchemePlugin.CUSTOMIZER_PAGE_ID))}generateDefaultTitle(){let b=f.SchemePlugin.DEFAULT_SCHEME_TITLE,a=2;for(;!this.isSchemeTitleUnique(b);)b=`${f.SchemePlugin.DEFAULT_SCHEME_TITLE} ${a}`,a++;return b}openSchemeCustomizerForBrand(){return n(this,void 0,void 0,function*(){const {customSchemeList:b}=this.uiRoot.getState();0<b.length&&null!==b[0]&&(this.uiRoot.setState({isCustomizerOpen:!0,
schemeCustomizerMode:p.Edit,selectedScheme:b[0],editedScheme:b[0],savedEditedScheme:b[0]}),this.uiRoot.sidebar.open(f.SchemePlugin.SIDEBAR_ID,f.SchemePlugin.CUSTOMIZER_PAGE_ID))})}openRootPage(){this.uiRoot.setState({schemeCustomizerMode:p.None,editedScheme:null,savedEditedScheme:null,isCustomizerOpen:!1});this.uiRoot.sidebar.open(f.SchemePlugin.SIDEBAR_ID)}updateEditedSchemeTitle(b){this.uiRoot.setState({editedScheme:Object.assign(Object.assign({},this.uiRoot.getState().editedScheme),{title:b})})}updateEditedSchemeColor(b,
a,c){const e=Array(7).fill(null).map((b,e)=>e===a?c:null);this.updateEditedSchemeColors(b,e)}updateEditedSchemeColors(b,a){const {editedScheme:c,hasPremium:e}=this.uiRoot.getState();if(null!==c&&e){var l=c.colorScheme;a={backgroundColor:a[0]?a[0]:l.backgroundColor,topicAColor:a[1]?a[1]:l.topicAColor,topicBColor:a[2]?a[2]:l.topicBColor,borderColor:a[3]?a[3]:l.borderColor,extraColor:a[4]?a[4]:l.extraColor,primaryTextColor:a[5]?a[5]:l.primaryTextColor,secondaryTextColor:a[6]?a[6]:l.secondaryTextColor};
a=Object.assign(Object.assign({},c),{colorScheme:a});this.setStateAndApplyEditedScheme(b,{editedScheme:a})}}updateEditedSchemeColorsFromBackgroundImage(b){return n(this,void 0,void 0,function*(){const a=yield this.updateEditedSchemeColorsFromBackgroundImageI(b);if("error"===a.status)switch(a.error){case "color_thief_error":this.showErrorColorThief();break;case "image_io_error":this.showErrorUnsupportedImage("scheme_plugin_from_background_failed")}})}updateEditedSchemeColorsFromBackgroundImageI(b){const a=
new Promise((a,b)=>{this.session.document.read((c)=>{c=c.background.layers[0];null!=c&&c.kind!==z.swf?(c=this.session.document.progressiveAssetManager.rewriteUrl(c.url),this.stealColorFromImage(c).then(a)):b([])})});return this.executeAsyncChangeColorFromImageCommand(b,a)}updateEditedSchemeColorsFromLogoImage(b,a){return n(this,void 0,void 0,function*(){const c=yield this.updateEditedSchemeColorsFromLogoImageI(b,a);if("error"===c.status)switch(c.error){case "color_thief_error":this.showErrorColorThief();
break;case "image_io_error":this.showErrorUnsupportedImage("scheme_plugin_from_logo_failed")}})}updateEditedSchemeColorsFromLogoImageI(b,a){const c=new Promise((b)=>{const c=new FileReader;c.onload=()=>{this.stealColorFromImage(c.result).then(b)};c.readAsDataURL(a)});return this.executeAsyncChangeColorFromImageCommand(b,c)}executeAsyncChangeColorFromImageCommand(b,a){return b.doAsync(a,(a,b)=>{if("ok"===b.status&&a.isValid()){const c=b.value.map(({r:a,g:b,b:c})=>f.SchemePlugin.getColorFromRGB(a,b,
c));this.updateEditedSchemeColors(a,c)}return b})}stealColorFromImage(b){return new Promise((a)=>{const c=new Image;c.crossOrigin="anonymous";c.onload=(b)=>{b=E.ColorThiefTool.getPalette(b.currentTarget,5,1);b=this.processColorThiefPalette(b);null==b?a({status:"error",error:"color_thief_error"}):(b=b.map((a)=>({r:Math.min(255,a[0]),g:Math.min(255,a[1]),b:Math.min(255,a[2]),a:1})),a({status:"ok",value:b}))};c.onerror=()=>{a({status:"error",error:"image_io_error"})};c.src=b})}processColorThiefPalette(b){if(null==
b)return null;const a=this.getUniqueColors(b);return 2>a.length?null:Array(5).fill(null).map((b,e)=>a[e%a.length])}getUniqueColors(b){return b.filter((a,c)=>b.findIndex((b)=>this.areColorsSimilar(a,b))===c)}areColorsSimilar(b,a){return Math.abs(b[0]-a[0])+Math.abs(b[1]-a[1])+Math.abs(b[2]-a[2])<q.COLOR_SIMILARITY_THRESHOLD}updateEditedSchemeDisplayFontFamily(b,a){const {editedScheme:c,hasPremium:e}=this.uiRoot.getState();null!==c&&e&&this.updateEditedSchemeAndApply(b,{fontScheme:{title:Object.assign(Object.assign({},
c.fontScheme.title),{fontFamily:a}),subtitle:Object.assign(Object.assign({},c.fontScheme.subtitle),{fontFamily:a}),subtitle2:Object.assign(Object.assign({},c.fontScheme.subtitle2),{fontFamily:a}),body:c.fontScheme.body,body2:c.fontScheme.body2}})}updateEditedSchemeBodyFontFamily(b,a){const {editedScheme:c,hasPremium:e}=this.uiRoot.getState();null!==c&&e&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},c.fontScheme),{body:Object.assign(Object.assign({},c.fontScheme.body),
{fontFamily:a}),body2:Object.assign(Object.assign({},c.fontScheme.body2),{fontFamily:a})})})}updateEditedSchemeTitleBold(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{title:Object.assign(Object.assign({},a.fontScheme.title),{hasBold:!a.fontScheme.title.hasBold})})})}updateEditedSchemeTitleItalic(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,
{fontScheme:Object.assign(Object.assign({},a.fontScheme),{title:Object.assign(Object.assign({},a.fontScheme.title),{hasItalic:!a.fontScheme.title.hasItalic})})})}updateEditedSchemeTitleBackground(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{title:Object.assign(Object.assign({},a.fontScheme.title),{hasBackground:!a.fontScheme.title.hasBackground})})})}updateEditedSchemeSubtitleBold(b){const {editedScheme:a,
hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{subtitle:Object.assign(Object.assign({},a.fontScheme.subtitle),{hasBold:!a.fontScheme.subtitle.hasBold}),subtitle2:Object.assign(Object.assign({},a.fontScheme.subtitle2),{hasBold:!a.fontScheme.subtitle.hasBold})})})}updateEditedSchemeSubtitleItalic(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},
a.fontScheme),{subtitle:Object.assign(Object.assign({},a.fontScheme.subtitle),{hasItalic:!a.fontScheme.subtitle.hasItalic}),subtitle2:Object.assign(Object.assign({},a.fontScheme.subtitle2),{hasItalic:!a.fontScheme.subtitle.hasItalic})})})}updateEditedSchemeSubtitleBackground(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{subtitle:Object.assign(Object.assign({},a.fontScheme.subtitle),
{hasBackground:!a.fontScheme.subtitle.hasBackground}),subtitle2:Object.assign(Object.assign({},a.fontScheme.subtitle2),{hasBackground:!a.fontScheme.subtitle.hasBackground})})})}updateEditedSchemeBodyBold(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{body:Object.assign(Object.assign({},a.fontScheme.body),{hasBold:!a.fontScheme.body.hasBold}),body2:Object.assign(Object.assign({},
a.fontScheme.body2),{hasBold:!a.fontScheme.body.hasBold})})})}updateEditedSchemeBodyItalic(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{body:Object.assign(Object.assign({},a.fontScheme.body),{hasItalic:!a.fontScheme.body.hasItalic}),body2:Object.assign(Object.assign({},a.fontScheme.body2),{hasItalic:!a.fontScheme.body.hasItalic})})})}updateEditedSchemeBodyBackground(b){const {editedScheme:a,
hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.updateEditedSchemeAndApply(b,{fontScheme:Object.assign(Object.assign({},a.fontScheme),{body:Object.assign(Object.assign({},a.fontScheme.body),{hasBackground:!a.fontScheme.body.hasBackground}),body2:Object.assign(Object.assign({},a.fontScheme.body2),{hasBackground:!a.fontScheme.body.hasBackground})})})}saveEditedSchemeAndReloadList(){return n(this,void 0,void 0,function*(){const {editedScheme:b,hasPremium:a}=this.uiRoot.getState();null!==b&&a&&
(yield this.saveScheme(b))&&(this.openRootPage(),yield this.loadSchemes())})}deleteEditedSchemeAndReturnToRoot(){return n(this,void 0,void 0,function*(){const {editedScheme:b,hasPremium:a}=this.uiRoot.getState();null!==b&&a&&(yield this.deleteScheme(b))&&(this.openRootPage(),yield this.loadSchemes())})}applyEditedScheme(b){const {editedScheme:a,hasPremium:c}=this.uiRoot.getState();null!==a&&c&&this.session.document.executeApiCommand(b,this.applyScheme(a))}setStateAndApplyEditedScheme(b,a){this.uiRoot.setState(a);
this.applyEditedScheme(b)}updateEditedSchemeAndApply(b,a){const {editedScheme:c,hasPremium:e}=this.uiRoot.getState();null!==c&&e&&this.setStateAndApplyEditedScheme(b,{editedScheme:Object.assign(Object.assign({},c),a)})}static serializeScheme(b){return JSON.stringify({colorScheme:{backgroundColor:b.colorScheme.backgroundColor.getRGBString(),topicAColor:b.colorScheme.topicAColor.getRGBString(),topicBColor:b.colorScheme.topicBColor.getRGBString(),borderColor:b.colorScheme.borderColor.getRGBString(),
extraColor:b.colorScheme.extraColor.getRGBString(),primaryTextColor:b.colorScheme.primaryTextColor.getRGBString(),secondaryTextColor:b.colorScheme.secondaryTextColor.getRGBString()},fontScheme:null})}isSaveSchemeButtonEnabled(){const {savedEditedScheme:b,editedScheme:a,schemeCustomizerMode:c,isNetworkOffline:e}=this.uiRoot.getState();if(e)return!1;switch(c){case p.Add:return!this.checkTitleError();case p.Edit:return!this.checkTitleError()&&(a.title!==b.title||!q.areSchemesEqual(b,a));default:return!1}}checkTitleError(){const {savedEditedScheme:b,
editedScheme:a,schemeCustomizerMode:c}=this.uiRoot.getState();return a.title&&0!==a.title.length?c===p.Add&&!this.isSchemeTitleUnique(a.title)||c===p.Edit&&a.title!==b.title&&!this.isSchemeTitleUnique(a.title)?d.I18n.ts("Name already used"):null:null}isDeleteSchemeButtonEnabled(){const {schemeCustomizerMode:b,selectedScheme:a,isNetworkOffline:c}=this.uiRoot.getState();return c?!1:b===p.Edit&&a.isCustom}isCopyButtonEnabled(){const {schemeCustomizerMode:b,isNetworkOffline:a}=this.uiRoot.getState();
return!a&&b!==p.Add}static areSchemesEqual(b,a){return null==b&&null==a?!0:null==b||null==a?!1:q.serializeScheme(b)===q.serializeScheme(a)}isSchemeTitleUnique(b){return!this.uiRoot.getState().customSchemeList.map((a)=>a.title).some((a)=>a===b)}allSchemeLoaded(){const {customSchemeDisplayProgress:b,presetSchemeList:a,template:c,isNetworkOffline:e}=this.uiRoot.getState();return(e||b===g.ListProgress.finished)&&0<a.length&&(c.kind===r.LOADED||c.kind===r.MISSING)}findFirstMatchingScheme(b){const {customSchemeList:a,
presetSchemeList:c,template:e}=this.uiRoot.getState(),d=[...a,...c,e.kind===r.LOADED?e.colors:null];let f=d.find((a)=>null!=a&&a.id===b.id);f=q.areSchemesEqual(f,b)?f:null;null==f&&(f=d.filter((a)=>null!=a).find((a)=>q.areSchemesEqual(b,a)));return f}updateSelectionAndUnsavedItem(){const {currentPreziScheme:b}=this.uiRoot.getState();if(this.allSchemeLoaded()&&null!=b){const a=this.findFirstMatchingScheme(b),c=null==a?this.removeSchemeIdAndTitle(b):null;this.uiRoot.setState({unsavedStyleScheme:c,selectedScheme:null!=
a?a:c,currentThumbnailUrl:b.thumbnailUrl})}}getCurrentPreziSchemeAndId(){return{schemeId:this.session.document.read((b)=>b.styleSheet.colorPaletteId),scheme:this.getCurrentPreziScheme()}}removeSchemeIdAndTitle(b){const {colorScheme:a,fontScheme:c,thumbnailUrl:e}=b;return{id:"",title:"",isCustom:!0,colorScheme:a,fontScheme:c,thumbnailUrl:e}}saveCopyAndReloadList(){return n(this,void 0,void 0,function*(){const {editedScheme:b,selectedScheme:a}=this.uiRoot.getState();var c=Object.assign(Object.assign({},
b||a),{id:null,title:this.generateCopyTitle(),isCustom:!0});if(c=yield this.saveScheme(c))h.avro.Avro.createDefaultLogger().logCopyPresentationColorScheme({copied_presentation_color_scheme_id:c.id,original_presentation_color_scheme_id:a.id}),this.openRootPage(),yield this.loadSchemes()})}generateCopyTitle(){const {editedScheme:b,selectedScheme:a}=this.uiRoot.getState();var {title:c}=b||a;c=c||f.SchemePlugin.DEFAULT_SCHEME_TITLE;c=b&&b.title!==a.title?c:d.I18n.tsFormatKeys("Copy of {title}",{title:c});
if(this.isSchemeTitleUnique(c))return c;{let a=2;for(;!this.isSchemeTitleUnique(`${c} ${a}`);)++a;return`${c} ${a}`}}showErrorUnsupportedImage(b){this.uiRoot.dialog.showError(d.I18n.ts("Unsupported file type"),d.I18n.ts("Please try again with a supported image file"),b)}showErrorSaveScheme(){this.uiRoot.dialog.showError(d.I18n.ts("Looks like there\u2019s an issue with saving your colors."),d.I18n.ts("We\u2019re unable to save your colors at this time. Please try again."),"scheme_plugin_save_scheme_failed")}showErrorDeleteScheme(){this.uiRoot.dialog.showError(d.I18n.ts("Looks like there\u2019s an issue with deleting your colors."),
d.I18n.ts("We\u2019re unable to delete your colors at this time. Please try again."),"scheme_plugin_delete_scheme_failed")}showErrorLoadSchemes(){this.uiRoot.dialog.showError(d.I18n.ts("Looks like there\u2019s an issue with loading your colors."),d.I18n.ts("We\u2019re unable to load your colors at this time. Please try again."),"scheme_plugin_load_schemes_failed")}showErrorColorThief(){this.uiRoot.dialog.showError(d.I18n.ts("Unable to create palette"),d.I18n.ts("We couldn\u2019t detect enough colors to create a palette. Please try again with a different image file."),
"scheme_plugin_palette_failed")}}k.SchemeStateManager=q;q.SCHEME_TITLE_INPUT_MAX_LENGTH=26;q.COLOR_SIMILARITY_THRESHOLD=30;var f={},x=this&&f.__awaiter||function(b,a,c,e){function d(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{h(e.next(a))}catch(t){f(t)}}function l(a){try{h(e["throw"](a))}catch(t){f(t)}}function h(a){a.done?c(a.value):d(a.value).then(g,l)}h((e=e.apply(b,a||[])).next())})};Object.defineProperty(f,"__esModule",{value:!0});
var A=v.base.FillKind;f.SchemePlugin=class{constructor(){this.onLogoFileSelected=(b,a)=>{h.avro.Avro.createDefaultLogger().logCreatePresentationColorSchemeFromLogo();this.stateManager.updateEditedSchemeColorsFromLogoImage(b,a)};this.handleEdit=(b,a=null)=>{const {hasPremium:c}=this.uiRoot.getState();null!==a&&this.uiRoot.setState({selectedScheme:a});if(c){var {selectedScheme:a}=this.uiRoot.getState();h.avro.Avro.createDefaultLogger().logEditPresentationColorScheme({presentation_color_scheme_id:a.id});
this.stateManager.openSchemeCustomizer(b,a&&a.id?k.SchemeCustomizerMode.Edit:k.SchemeCustomizerMode.Add)}else this.openPaywallModal()};this.logger=h.LoggerModule.getLoggerManager().createLogger("prezi_scheme.SchemePlugin")}init(b){this.uiRoot=b.declareUI(k.SchemeStateManager.initState(),(a,b)=>{b.createMenuItem(this.createMixerButton());!a.anySelectedElement&&a.onOverview&&b.createMenuItem(this.createContextMenuButton());b.createSidebar((a)=>this.createSidebarArgs(a));null!=a.currentPreziScheme&&
null!=a.currentPreziScheme.colorScheme&&(a=a.currentPreziScheme.colorScheme,b.createColorGrid({colors:[a.backgroundColor.getRGBData(),a.topicAColor.getRGBData(),a.topicBColor.getRGBData(),a.borderColor.getRGBData(),a.extraColor.getRGBData()],buttonArgs:[{onClick:()=>this.stateManager.openSidebar(),id:"open-scheme-sidebar",content:{text:d.I18n.ts("Color settings")},color:g.ButtonColor.Gray}],weight:0,id:"scheme-colors",title:d.I18n.ts("Scheme Colors")}))});this.stateManager=new k.SchemeStateManager(b,
this.session,this.uiRoot);this.stateManager.loadSchemes();b.onSelectionChange((a)=>{this.stateManager.updateAnySelectedElement(0<a.allObjects.length)})}processMessage(b){if("schemeSidebar"===b)this.stateManager.openSidebar();else if("updateSchemesAndOpenEditBrandScheme"===b)this.stateManager.loadSchemes().then(()=>this.stateManager.openSidebar()).then(()=>this.stateManager.openSchemeCustomizerForBrand());else throw Error(`unexpected message: ${b}`);}createMixerButton(){const {currentThumbnailUrl:b}=
this.uiRoot.getState();return{kind:g.MenuItemKind.mixerButton,enabled:!0,onClick:(a)=>{this.stateManager.switchToNextScheme(a)},onClickSecondary:()=>{this.stateManager.toggleSidebar()},url:b,parent:g.TabMenuId.Style,weight:3,id:"color-mixer-button",title:d.I18n.ts("Colors")}}createContextMenuButton(){return{kind:g.MenuItemKind.context,enabled:!0,onClick:()=>{this.stateManager.toggleSidebar()},weight:33,id:"color-mixer-context-menu-item",title:d.I18n.ts("Change colors")}}createSidebarArgs(b){var {editedScheme:a}=
this.uiRoot.getState();a=null===a?{}:{[f.SchemePlugin.CUSTOMIZER_PAGE_ID]:this.createSchemeCustomizerPage(b,a)};return{id:f.SchemePlugin.SIDEBAR_ID,root:this.createRootPage(b),pages:a,onOpen:(a)=>{a=a.pageId===f.SchemePlugin.CUSTOMIZER_PAGE_ID;this.uiRoot.setState({isSidebarOpen:!0,isCustomizerOpen:a});a||this.stateManager.updateSelectionAndUnsavedItem()},onClose:()=>{const {isCustomizerOpen:a}=this.uiRoot.getState();h.avro.Avro.createDefaultLogger().logClosePresentationColorSchemeSidebar({colorscheme_sidebar_mode:a?
"SCHEMECUSTOMIZER":"SCHEMELIST"});this.uiRoot.setState({isSidebarOpen:!1,isCustomizerOpen:!1})},onPageBack:()=>{h.avro.Avro.createDefaultLogger().logBackFromColorSchemeEditing({colorscheme_sidebar_mode:"SCHEMECUSTOMIZER"});this.stateManager.handleBackFromEditing()}}}createRootPage(b){const a=this.createCustomSection(b),c=this.createPresetSection(b);b=this.createOriginalTemplateSection(b);return{title:f.SchemePlugin.SIDEBAR_TITLE,content:[...[],...a,...c,...b]}}createUnsavedItem(b){const {unsavedStyleScheme:a}=
this.uiRoot.getState();return a?b.image({id:"__UNSAVED__",title:d.I18n.ts("(Unsaved)"),src:{url:a.thumbnailUrl},onClick:(b)=>this.stateManager.logAndApplyScheme(b,a),dataLookup:`${f.SchemePlugin.SIDEBAR_ID}/unsaved-item`,primaryAction:{id:"editAction",onClick:(b)=>this.handleEdit(b,a),icon:g.IconSmallId.Edit,enabled:!0,title:d.I18n.ts("Edit")}}):null}createOriginalTemplateSection(b){const {isSidebarOpen:a,template:c,selectedScheme:e}=this.uiRoot.getState();return a&&c.kind===k.TemplateKind.LOADED?
[b.sectionHeader({content:d.I18n.ts("Template palette")}),b.simpleList((a)=>({id:f.SchemePlugin.ID_UNSAVED_SECTION,activeId:null!=e?e.id:null,items:[this.createOriginalTemplateItem(a)],itemType:g.ListItemType.large,itemLayout:g.ListItemLayout.fixed,showTitle:!1}))]:[]}createOriginalTemplateItem(b){const {template:a}=this.uiRoot.getState();return a.kind===k.TemplateKind.LOADED?b.image({id:a.colors.id,src:{url:a.colors.thumbnailUrl},onClick:(b)=>{h.avro.Avro.createDefaultLogger().logRevertToTemplateDefault({template_id:a.id});
this.stateManager.logAndApplyScheme(b,a.colors)},dataLookup:`${f.SchemePlugin.SIDEBAR_ID}/template-colors-item`,primaryAction:{id:"editAction",onClick:(b)=>this.handleEdit(b,a.colors),icon:g.IconSmallId.Edit,enabled:!0,title:d.I18n.ts("Edit")}}):null}createCustomSection(b){return[b.sectionHeader({content:d.I18n.ts("My palettes")}),this.getListItems(b),b.separator()]}getListItems(b){const {hasPremium:a,customSchemeList:c,customSchemeDisplayProgress:e}=this.uiRoot.getState();return a?this.createList(f.SchemePlugin.ID_CUSTOM_SECTION,
b,(a)=>{const b=this.createUnsavedItem(a);let e=c.map((b,c)=>this.createItem(a,b,`${f.SchemePlugin.SIDEBAR_ID}/custom-item-${c}`,!0));e.sort(this.sortAlphabetically);null!=b&&(e=[b,...e]);return e=[this.createAddButtonItem(a),...e]},!0,e,!1):this.createList(f.SchemePlugin.ID_CUSTOM_SECTION,b,(a)=>{const b=this.createUnsavedItem(a);let c=[];null!=b&&(c=[b,...c]);return c=[this.createAddButtonItem(a),...c]},!0)}createAddButtonItem(b){const {hasPremium:a,selectedScheme:c}=this.uiRoot.getState();return b.image({title:d.I18n.ts("Create new"),
src:{url:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0wLjUgMTA3LjVWMC40OTk5NjlIMTA3LjVWMTA3LjVIMC41WiIgZmlsbD0iI0Y2RjdGOSIgc3Ryb2tlPSIjREZFMUU0Ii8+CjxjaXJjbGUgY3g9IjU0IiBjeT0iNTQiIHI9IjIwIiBmaWxsPSIjMzE4MUZGIi8+CjxwYXRoIGQ9Ik01NS4zMzMgNTIuNjY3SDYyQzYyLjM1MzUgNTIuNjY3IDYyLjY5MjYgNTIuODA3NCA2Mi45NDI2IDUzLjA1NzRDNjMuMTkyNiA1My4zMDc0IDYzLjMzMyA1My42NDY1IDYzLjMzMyA1NEM2My4zMzMgNTQuMzUzNSA2My4xOTI2IDU0LjY5MjYgNjIuOTQyNiA1NC45NDI2QzYyLjY5MjYgNTUuMTkyNiA2Mi4zNTM1IDU1LjMzMyA2MiA1NS4zMzNINTUuMzMzVjYyQzU1LjMzMyA2Mi4zNTM1IDU1LjE5MjYgNjIuNjkyNiA1NC45NDI2IDYyLjk0MjZDNTQuNjkyNiA2My4xOTI2IDU0LjM1MzUgNjMuMzMzIDU0IDYzLjMzM0M1My42NDY1IDYzLjMzMyA1My4zMDc0IDYzLjE5MjYgNTMuMDU3NCA2Mi45NDI2QzUyLjgwNzQgNjIuNjkyNiA1Mi42NjcgNjIuMzUzNSA1Mi42NjcgNjJWNTUuMzMzSDQ2QzQ1LjY0NjUgNTUuMzMzIDQ1LjMwNzQgNTUuMTkyNiA0NS4wNTc0IDU0Ljk0MjZDNDQuODA3NCA1NC42OTI2IDQ0LjY2NyA1NC4zNTM1IDQ0LjY2NyA1NEM0NC42NjcgNTMuNjQ2NSA0NC44MDc0IDUzLjMwNzQgNDUuMDU3NCA1My4wNTc0QzQ1LjMwNzQgNTIuODA3NCA0NS42NDY1IDUyLjY2NyA0NiA1Mi42NjdINTIuNjY3VjQ2QzUyLjY2NyA0NS42NDY1IDUyLjgwNzQgNDUuMzA3NCA1My4wNTc0IDQ1LjA1NzRDNTMuMzA3NCA0NC44MDc0IDUzLjY0NjUgNDQuNjY3IDU0IDQ0LjY2N0M1NC4zNTM1IDQ0LjY2NyA1NC42OTI2IDQ0LjgwNzQgNTQuOTQyNiA0NS4wNTc0QzU1LjE5MjYgNDUuMzA3NCA1NS4zMzMgNDUuNjQ2NSA1NS4zMzMgNDZWNTIuNjY3WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cgo="},
onClick:(b)=>{a?(h.avro.Avro.createDefaultLogger().logAddPresentationColorScheme({presentation_color_scheme_id:c?c.id:"new"}),this.stateManager.openSchemeCustomizer(b,k.SchemeCustomizerMode.Add)):this.openPaywallModal()},dataLookup:`${f.SchemePlugin.SIDEBAR_ID}/add-scheme-button`})}createFromLogoButton(b){const {hasPremium:a}=this.uiRoot.getState();return b.button(g.ButtonSize.Large,g.ButtonAlign.Start,(b)=>[a?b.upload({color:g.ButtonColor.Gray,id:"from-logo-file",content:{text:d.I18n.ts("Logo")},
fileFilter:{allowImage:!0},onClick:()=>{h.avro.Avro.createDefaultLogger().logStartSetFromLogo()},onFileSelected:(a,{file:b})=>{this.onLogoFileSelected(a,b)}}):b.button({color:g.ButtonColor.Gray,id:"from-logo-file",content:{text:d.I18n.ts("Logo")},onClick:()=>{this.openPaywallModal()}})])}createFromBackgroundButton(b){return b.button(g.ButtonSize.Large,g.ButtonAlign.Start,(a)=>[a.button({id:"from-logo-background-image-button",color:g.ButtonColor.Gray,content:{text:d.I18n.ts("Background image")},disabled:!this.uiRoot.getState().preziHasBackground,
onClick:(a)=>{this.uiRoot.getState().hasPremium?(h.avro.Avro.createDefaultLogger().logCreatePresentationColorSchemeFromBackground(),this.stateManager.updateEditedSchemeColorsFromBackgroundImage(a)):this.openPaywallModal()}})])}createPresetSection(b){const {presetSchemeList:a}=this.uiRoot.getState();return[b.sectionHeader({content:d.I18n.ts("Default palettes")}),this.createList(f.SchemePlugin.ID_PRESET_SECTION,b,(b)=>a.map((a,c)=>this.createItem(b,a,`${f.SchemePlugin.SIDEBAR_ID}/preset-item-${c}`,
!1)),!1)]}sortAlphabetically(b,a){b=b.title.toLowerCase();a=a.title.toLowerCase();return b<a?-1:b>a?1:0}createList(b,a,c,e,d,f=!1){const {unsavedStyleScheme:l,selectedScheme:h}=this.uiRoot.getState();return a.simpleList((a)=>{a=[...c(a)];f&&a.sort(this.sortAlphabetically);return{activeId:l?"__UNSAVED__":h?h.id:null,id:b,items:a,itemType:g.ListItemType.large,itemLayout:g.ListItemLayout.fixed,showTitle:e,progress:d}})}createItem(b,a,c,e){return b.image({id:a.id,title:e?a.title:null,src:{url:a.thumbnailUrl},
onClick:(b)=>{this.stateManager.logAndApplyScheme(b,a)},dataLookup:c,primaryAction:{id:"editAction",onClick:(b)=>this.handleEdit(b,a),icon:g.IconSmallId.Edit,enabled:!0,title:d.I18n.ts("Edit")}})}createSchemeCustomizerPage(b,a){const {hasPremium:c}=this.uiRoot.getState(),e=[];c||e.push(...[b.sectionHeader({content:d.I18n.ts("Ready to unlock more features?")}),b.label(d.I18n.ts("Get access to advanced color editing and much more by upgrading your Prezi license.")),b.button(g.ButtonSize.Large,g.ButtonAlign.Start,
(a)=>[a.button({color:g.ButtonColor.Blue,id:"style-scheme-customizer-upgrade-button",content:{text:d.I18n.ts("Upgrade now")},onClick:()=>{this.openPaywallModal()}})]),b.separator()]);e.push(...[b.sectionHeader({content:d.I18n.ts("Name")}),this.createTitleInput(b,a),b.separator(),b.sectionHeader({content:d.I18n.ts("Create palette from:")}),this.createFromLogoButton(b),this.createFromBackgroundButton(b),b.separator(),this.createColorPicker(b,a.colorScheme.backgroundColor,0,d.I18n.tsFormatKeys("Color {index} (background)",
{index:1})),this.createColorPicker(b,a.colorScheme.topicAColor,1,d.I18n.tsFormatKeys("Color {index} (topics)",{index:2})),this.createColorPicker(b,a.colorScheme.topicBColor,2,d.I18n.tsFormatKeys("Color {index} (subtopics)",{index:3})),this.createColorPicker(b,a.colorScheme.borderColor,3,d.I18n.tsFormatKeys("Color {index} (border)",{index:4})),this.createColorPicker(b,a.colorScheme.extraColor,4,d.I18n.tsFormatKeys("Color {index} (accent)",{index:5})),b.separator(),this.createColorPicker(b,a.colorScheme.primaryTextColor,
5,d.I18n.ts("Primary text color")),this.createColorPicker(b,a.colorScheme.secondaryTextColor,6,d.I18n.ts("Secondary text color")),...this.createCrossLinkToTextSidebar(b)]);return{title:f.SchemePlugin.SIDEBAR_TITLE,content:e,footer:[this.createButtonSection(b)]}}createTitleInput(b,a){const {hasPremium:c}=this.uiRoot.getState();return b.inputField({id:"style-scheme-customizer-name-input",placeholderText:f.SchemePlugin.DEFAULT_SCHEME_TITLE,value:a.title,disabled:!1,maxLength:k.SchemeStateManager.SCHEME_TITLE_INPUT_MAX_LENGTH,
autofocus:!0,onValueChange:(a,b)=>{c?this.stateManager.updateEditedSchemeTitle(b):this.openPaywallModal()},errorText:this.stateManager.checkTitleError()})}createColorPicker(b,a,c,e){const {hasPremium:d}=this.uiRoot.getState();a=a.getRGBData();return b.colorPicker({id:`style-scheme-customizer-color-picker-${c}`,label:e,fills:{solidFill:{fillKind:A.solid,color:{r:a.r,g:a.g,b:a.b,a:1}},current:A.solid,hasAlpha:!1},showThemeColors:!1,showColorWheel:!0,onShowPopup:()=>{if(d)return!0;this.openPaywallModal();
return!1},onChange:(a,b)=>{b.isFinal&&this.updateSchemeColor(a,b.newFill.color,c)}})}updateSchemeColor(b,a,c){const {r:e,g:d,b:g}=a;a=f.SchemePlugin.getColorFromRGB(e,d,g);const k={presentation_color_scheme_id:this.uiRoot.getState().editedScheme.id,colorscheme_attrib_name:"SCHEME_COLOR_ONE SCHEME_COLOR_TWO SCHEME_COLOR_THREE SCHEME_COLOR_FOUR SCHEME_COLOR_FIVE TEXT_COLOR_PRIMARY TEXT_COLOR_SECONDARY".split(" ")[c],color_hexcode:a.getRGBAString()};5===c||6===c?h.avro.Avro.createDefaultLogger().logSetPresentationTextColor(k):
h.avro.Avro.createDefaultLogger().logSetPresentationColor(k);this.stateManager.updateEditedSchemeColor(b,c,a)}createButtonSection(b){const {hasPremium:a}=this.uiRoot.getState();return b.button(g.ButtonSize.Large,g.ButtonAlign.Center,(b)=>[b.button({color:g.ButtonColor.Blue,id:"style-scheme-customizer-save-button",content:{text:d.I18n.ts("Save")},disabled:!this.stateManager.isSaveSchemeButtonEnabled(),onClick:(b)=>x(this,void 0,void 0,function*(){a?(h.avro.Avro.createDefaultLogger().logSavePresentationColorScheme({presentation_color_scheme_id:this.uiRoot.getState().editedScheme.id}),
yield this.stateManager.saveEditedSchemeAndReloadList(b)):this.openPaywallModal()})}),b.button({color:g.ButtonColor.Gray,id:"style-scheme-customizer-copy-button",content:{icon:g.IconSmallId.Copy},disabled:!this.stateManager.isCopyButtonEnabled(),onClick:()=>x(this,void 0,void 0,function*(){a?yield this.stateManager.saveCopyAndReloadList():this.openPaywallModal()}),tooltipText:d.I18n.ts("Make a copy"),tooltipPosition:"top"}),b.button({color:g.ButtonColor.Gray,id:"style-scheme-customizer-delete-button",
content:{icon:g.IconSmallId.Trash},disabled:!this.stateManager.isDeleteSchemeButtonEnabled(),onClick:(b)=>x(this,void 0,void 0,function*(){a?(h.avro.Avro.createDefaultLogger().logDeletePresentationColorScheme({presentation_color_scheme_id:this.uiRoot.getState().editedScheme.id}),yield this.stateManager.deleteEditedSchemeAndReturnToRoot(b)):this.openPaywallModal()}),tooltipText:d.I18n.ts("Delete"),tooltipPosition:"top"})])}openPaywallModal(){this.uiRoot.dialog.showBuiltIn(g.BuiltinDialog.upgradeLicenseScheme)}createCrossLinkToTextSidebar(b){return[b.separator(),
b.infoMessage(d.I18n.ts("Looking to customize the font and formatting of your text?")),b.button(g.ButtonSize.Small,g.ButtonAlign.End,(a)=>[a.button({color:g.ButtonColor.Gray,id:"crosslink-to-fonts-sidebar",content:{text:d.I18n.ts("Set text styles")},onClick:()=>{this.pluginAccess.send(C.textStyle,"textStyleSidebar")}})])]}static getColorFromRGB(b,a,c){return B.Geometry.colorFromRGB(b/255,a/255,c/255)}};f.SchemePlugin.SIDEBAR_ID="scheme-sidebar";f.SchemePlugin.CUSTOMIZER_PAGE_ID="scheme-customizer-page";
f.SchemePlugin.SIDEBAR_TITLE=d.I18n.ts("Colors");f.SchemePlugin.dataType="SCHEME";f.SchemePlugin.ID_CUSTOM_SECTION="schemes-custom";f.SchemePlugin.ID_CUSTOM_PREVIEW_SECTION="schemes-custom-preview";f.SchemePlugin.ID_PRESET_SECTION="schemes-preset";f.SchemePlugin.ID_UNSAVED_SECTION="schemes-unsaved";f.SchemePlugin.DEFAULT_SCHEME_TITLE=d.I18n.ts("Untitled colors");m={};Object.defineProperty(m,"__esModule",{value:!0});m.lazyModule={createPlugin(){return new f.SchemePlugin}};return m});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_scheme",["require","prezi.geometry","prezi_cet_model_editor","prezi_editor_commander","prezi_featureswitcher","prezi_i18n","prezi_image_color_thief","prezi_logger","prezi_plugin_api","prezi_plugin_meta","prezi_styleschemeprovider"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_scheme.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.geometry"),require("prezi_cet_model_editor"),require("prezi_editor_commander"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_image_color_thief"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_styleschemeprovider"));}else{this["prezi_scheme"]=__factory(this["prezi.geometry"],this["prezi_cet_model_editor"],this["prezi_editor_commander"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_image_color_thief"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_styleschemeprovider"]);}}).call(this);