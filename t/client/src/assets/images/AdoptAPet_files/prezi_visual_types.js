;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_visual_types";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_cet_model_editor":dependencies[0],"prezi_featureswitcher":dependencies[1],"prezi_i18n":dependencies[2],"prezi_plugin_api":dependencies[3],"prezi_utils":dependencies[4]}};})());};})(arguments);var moduleImpl=(function(){return module(function(e){var h=e.dependencies.prezi_plugin_api,c=e.dependencies.prezi_cet_model_editor,p=e.dependencies.prezi_utils,n=e.dependencies.prezi_featureswitcher,k=e.dependencies.prezi_i18n,l={};Object.defineProperty(l,"__esModule",{value:!0});l.$=class{init(a){this.u=a.declareUI({j:[],o:[],w:new Set},(a,b)=>{const {j:c,w:d}=a;1>c.length||d.forEach((a)=>this.aa(b,a))});a.onSelectionChange(()=>this.session.document.read((a)=>this.v(a)))}v(a){let d=[],b=[],f=new Set;const e=this.session.coverEdit.getReadonlyMode(a),
m=this.session.selection.getReadonlySelectionInfo(a).allObjects;b=this.session.selection.getReadonlySelectionInfo(a).groups.map((a)=>a.members.map((a)=>a.id));e.kind!==h.CoverEditModeKind.Advanced&&e.kind!==h.CoverEditModeKind.InsideAdvanced||!m.every((a)=>a.is(c.base.ObjectKind.simpleObject))||(d=m.map((a)=>a.id),m.forEach((b)=>{if(b.is(c.base.ObjectKind.simpleObject)){const d=e.topic===this.session.insertTarget.getSimpleObjectParentReader(a),g=this.ba(b);0>g.visual.contentChildren.map((a)=>a.id).indexOf(b.id)&&
f.add("visual");!d&&0>g.cover.contentChildren.map((a)=>a.id).indexOf(b.id)&&f.add("cover");n.isActive("js-visual-types")&&d&&g.is(c.base.ObjectKind.planetTopic)&&0>g.master.contentChildren.map((a)=>a.id).indexOf(b.id)&&f.add("master");n.isActive("js-visual-types")&&!d&&g.is(c.base.ObjectKind.planetTopic)&&0>g.surface.contentChildren.map((a)=>a.id).indexOf(b.id)&&f.add("surface");d&&g.is(c.base.ObjectKind.planetTopic)&&0>g.contentChildren.map((a)=>a.id).indexOf(b.id)&&f.add("content")}}));this.u.setState({j:d,
o:b,w:f})}i(a,c,b,f){const {j:d,o:e}=this.u.getState();a.createMenuItem({kind:h.MenuItemKind.context,id:`context-menu-convert-to-${b}`,title:c,weight:13,onClick:(a)=>this.session.document.executeApiCommand(a,{name:`Transform entities into ${b}s`,run:(a)=>{d.map((b)=>a.lookup.simpleObject(b)).sort((a,b)=>a.isAbove(b)?1:-1).forEach((a)=>f(a));e.filter((a)=>2<=a.length).forEach(([b,...c])=>{b=a.lookup.simpleObject(b);b.parent.add.group([b,...c.map((b)=>a.lookup.simpleObject(b))])});this.v(a)}})})}ba(a){if(a.parent.is(c.base.ObjectKind.planetTopic))return a.parent;
if(a.parent.is(c.base.ObjectKind.cover)||a.parent.is(c.base.ObjectKind.surface)||a.parent.is(c.base.ObjectKind.master)||a.parent.is(c.base.ObjectKind.visual))return a.parent.parent;throw Error("Cannot determine object parent");}f(a){if(a.parent.is(c.base.ObjectKind.planetTopic))return a.parent;if(a.parent.is(c.base.ObjectKind.cover)||a.parent.is(c.base.ObjectKind.surface)||a.parent.is(c.base.ObjectKind.master)||a.parent.is(c.base.ObjectKind.visual))return a.parent.parent;throw Error("Cannot determine object parent");
}aa(a,d){switch(d){case "cover":return this.i(a,k.I18n.ts("Make it visible outside only",{context:"Make it visible outside only"}),d,(a)=>a.parent=this.f(a).cover);case "visual":return this.i(a,k.I18n.ts("Make it visible both inside and outside",{context:"Make it visible both inside and outside"}),d,(a)=>a.parent=this.f(a).visual);case "content":return this.i(a,k.I18n.ts("Make it visible inside only",{context:"Make it visible inside only"}),d,(a)=>{const b=this.f(a);b.is(c.base.ObjectKind.planetTopic)&&
(a.parent=b)});case "surface":return this.i(a,"[DEV] Make it a surface",d,(a)=>{const b=this.f(a);b.is(c.base.ObjectKind.planetTopic)&&(a.parent=b.surface)});case "master":return this.i(a,"[DEV] Make it a master",d,(a)=>a.parent=this.f(a).master);default:return p.Utils.assertNever(d)}}};e={};Object.defineProperty(e,"__esModule",{value:!0});e.lazyModule={createPlugin(){return new l.$}};return e});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_visual_types",["require","prezi_cet_model_editor","prezi_featureswitcher","prezi_i18n","prezi_plugin_api","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_visual_types.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi_cet_model_editor"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_plugin_api"),require("prezi_utils"));}else{this["prezi_visual_types"]=__factory(this["prezi_cet_model_editor"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_plugin_api"],this["prezi_utils"]);}}).call(this);