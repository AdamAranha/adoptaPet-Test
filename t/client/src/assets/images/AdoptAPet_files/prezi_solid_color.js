;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_solid_color";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi.geometry":dependencies[1],"prezi_cet_model_editor":dependencies[2],"prezi_editor_commander":dependencies[3],"prezi_featureswitcher":dependencies[4],"prezi_i18n":dependencies[5],"prezi_logger":dependencies[6],"prezi_plugin_api":dependencies[7],"prezi_styleschemeprovider":dependencies[8],"prezi_utils":dependencies[9]}};})());};})(arguments);var moduleImpl=(function(){return module(function(f){var p=f.dependencies.prezi_cet_model_editor,l=f.dependencies.prezi_plugin_api,q=f.dependencies.prezi_utils,k=f.dependencies.prezi_i18n,m=f.dependencies.prezi_editor_commander,r={};Object.defineProperty(r,"__esModule",{value:!0});var h=p.base.ObjectKind,t=p.base.FillKind,u=p.base.DocumentGeneration;r.SolidColorPlugin=class{init(e){this.uiRoot=e.declareUI({currentTopic:null,currentSelection:[],currentColor:null,currentPresetIndex:-1,colorTargetPresetColors:[],colorableItems:[]},(c,
b)=>{const {colorableItems:d}=c;0<d.length&&(this.createPresetDropdown(c,b),this.createColorPicker(c,b))});e.onCurrentTopicChange((c)=>{this.session.document.read((b)=>{this.updateColorTargetTopics(b,{currentTopic:c})})});e.onSelectionChange((c)=>{this.session.document.read((b)=>{this.updateColorTargetTopics(b,{currentSelection:c.allObjects.map((b)=>b.id)})})});e.onDocumentChange(()=>{this.session.document.read((c)=>{this.updateColorTargetTopics(c,{})})})}createColorPicker(e,c){const {currentColor:b,
colorableItems:d}=e,h=(b)=>(g)=>{m.EditorCommander.createColorGroup(g,d.map((b)=>g.lookup.base(b))).applyColor(b,!0)};c.createPropertyBarItem((c)=>{const g=k.I18n.ts("Fill color");let d=null;return c.colorPicker({id:"solid-colorpicker",title:g,tooltip:g,weight:1,parent:l.PropertyBarId.Left,icon:l.IconSmallId.FillColor,fills:{solidFill:{fillKind:t.solid,color:b},current:t.solid,canPickClearFill:!0,hasAlpha:!0},onChange:(b,a)=>{const c=a.newFill.fillKind===t.solid?a.newFill.color:null;null!=d&&d.isActive()||
(d=this.session.document.beginLongRunningCommand(b,{name:"applySolidColorInTransaction"},()=>{}));d.isActive()&&(d.execute(b,h(c)),a.isFinal&&d.end())},showThemeColors:!0,isOverlayColorPicker:!0})})}createPresetDropdown(e,c){const {currentPresetIndex:b,colorTargetPresetColors:d,colorableItems:h}=e,f=[];d.forEach((b,d)=>{b=this.getPresetForColor(b.color);f.push({id:`${d}`,imgUrl:b.imgUrl})});0<d.length&&c.createPropertyBarItem((c)=>c.popupButton((c)=>({id:"solid-color-presetdropdown",tooltipText:k.I18n.ts("Style presets"),
content:{text:k.I18n.ts("Style presets")},weight:0,parent:l.PropertyBarId.Left,popupHeader:[c.sectionHeader({content:k.I18n.ts("Style presets")})],popupContent:[c.simpleList((c)=>({items:f.map((a)=>{const b=f.findIndex((b)=>b.id===a.id);return c.image({id:a.id,src:{url:a.imgUrl},dataLookup:d[b].styes.filterStyle,onClick:(a)=>{this.session.document.executeApiCommand(a,{name:"applySolidColorPreset",run:(a)=>{const c=m.EditorCommander.createColorGroup(a,h.map((b)=>a.lookup.base(b)));c.setPresets(d[b].styes);
c.applyPresets()}})}})}).concat(this.createClearPresetItem(c,h)),itemLayout:l.ListItemLayout.fixed,itemType:l.ListItemType.small,showTitle:!1,progress:l.ListProgress.finished,flexGrow:1,activeId:0<=b?f[b].id:null})),c.infoMessage(k.I18n.ts("Style presets generate automatically and change according to your color scheme."))]})))}createClearPresetItem(e,c){return e.image({id:"clear-preset",src:{url:q.Utils.svgToUrl('<svg width="69" height="69" viewBox="0 0 69 69" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d="M0 69L69 0" stroke="#FA375A" stroke-width="2"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>')},
dataLookup:"clear-preset-filter",onClick:(b)=>{this.session.document.executeApiCommand(b,{name:"clearSolidColorPreset",run:(b)=>{const d=m.EditorCommander.createColorGroup(b,c.map((c)=>b.lookup.base(c)));d.setPresets({shapeStyle:null,filterStyle:null,arcStyle:null});d.applyPresets()}})}})}getPresetForColor(e){const c=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${[-50,-50,100,100]}"
				width="${100}" height="${100}">
				<rect fill="${m.toCssColor(e)}" x="${-50}" y="${-50}" width="${100}" height="${100}"/>
			</svg>`;return{imgUrl:q.Utils.svgToUrl(c),hasLightColor:m.hasLightColor(e,1)}}updateColorTargetTopics(e,c){c=Object.assign(Object.assign({},this.uiRoot.getState()),c);var b=0<c.currentSelection.length?c.currentSelection:[c.currentTopic],d=b.every((a)=>{a=e.lookup.base(a);return null==a?!1:a.is(h.planetTopic)||a.is(h.stackTopic)?!0:!1}),f=b.every((a)=>{a=e.lookup.base(a);return null==a?!1:a.is(h.pdf)||a.is(h.swf)||a.is(h.image)});const l=m.EditorCommander.createLayoutQuery(),g=m.EditorCommander.createColorGroup(e,
[]);let k=!1;d&&b.forEach((a)=>{a=e.lookup.base(a);if(a.is(h.planetTopic)||a.is(h.stackTopic)){a=g.helper.getColorableVisualObjects(a).filter((a)=>l.isTopicShapeObject(a));const b=a.filter((a)=>a.is(h.pdf)||a.is(h.swf)||a.is(h.image));k=k||a.length!==b.length;g.addObjects(b)}});f&&b.forEach((a)=>{a=e.lookup.base(a);switch(a.kind){case h.pdf:g.addObjects([a]);break;case h.swf:e.meta.isSupportedGeneration(u.SwfTint)&&g.addObjects([a]);break;case h.image:null!=a.filterStyle&&g.addObjects([a]);break;
default:k=!0}});b=null;let n=[];d=-1;!k&&0<g.size()?(b=g.getMainColors().filter((a)=>null!=a),d=b.map((a)=>a.a).reduce((a,b)=>Math.max(a,b),0),b=1<b.length?{r:0,g:0,b:0,a:d}:0<b.length?b[0]:null,d=g.getPresets(),n=d.reduce((a,b)=>{const c=g.helper.getColorsForStyle(b.styleEnum);null==a?a=c:q.Utils.arrayEquals(a,c,(a,b)=>g.helper.colorEquals(a.color,b.color))?a.forEach((a,b)=>a.styes=Object.assign(Object.assign({},a.styes),c[b].styes)):a=[];return a},null),n=null!=n?n.filter((a)=>null!=a&&null!=a.color):
[],d=d.reduce((a,b)=>{const c=g.helper.getColorFromStyleDeclaration(b.styleClass);b=n.findIndex((a)=>g.helper.colorEquals(a.color,c));return null==a||a===b?b:-1},null),d=null==d?-1:d,f=g.editorIds()):f=[];this.uiRoot.setState(Object.assign(Object.assign({},c),{currentColor:b,colorTargetPresetColors:n,currentPresetIndex:d,colorableItems:f}))}};f={};Object.defineProperty(f,"__esModule",{value:!0});f.lazyModule={createPlugin(){return new r.SolidColorPlugin}};return f});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_solid_color",["require","prezi.engine.dom","prezi.geometry","prezi_cet_model_editor","prezi_editor_commander","prezi_featureswitcher","prezi_i18n","prezi_logger","prezi_plugin_api","prezi_styleschemeprovider","prezi_utils"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_solid_color.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi.geometry"),require("prezi_cet_model_editor"),require("prezi_editor_commander"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_styleschemeprovider"),require("prezi_utils"));}else{this["prezi_solid_color"]=__factory(this["prezi.engine.dom"],this["prezi.geometry"],this["prezi_cet_model_editor"],this["prezi_editor_commander"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_styleschemeprovider"],this["prezi_utils"]);}}).call(this);