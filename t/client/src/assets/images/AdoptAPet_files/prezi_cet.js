;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_cet";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi.engine.dom":dependencies[0],"prezi.engine.dom.converter.xpdom2":dependencies[1],"prezi.geometry":dependencies[2],"prezi.text":dependencies[3],"prezi.text.model":dependencies[4],"prezi_bacon":dependencies[5],"prezi_cet_model":dependencies[6],"prezi_cet_renderer":dependencies[7],"prezi_externalserviceprovider":dependencies[8],"prezi_featureswitcher":dependencies[9],"prezi_logger":dependencies[10],"prezi_nativeapitypes":dependencies[11],"prezi_service_assetloader":dependencies[12],"prezi_service_data":dependencies[13],"prezi_service_fontcatalogue":dependencies[14],"prezi_service_media":dependencies[15],"prezi_utils":dependencies[16],"prezi_video":dependencies[17]}};})());};})(arguments);var moduleImpl=(function(){return module(function(P){function aa(a){const b=a?a.intent.name:"no-intent";if(null==a)return{message:b,snapshotBefore:{reset:()=>{}},snapshotAfter:{reset:()=>{}}};if(!(a instanceof ia))throw Error("not a TransactionImpl "+a);return{message:b,snapshotBefore:a.snapshotBefore,snapshotAfter:a.snapshotAfter}}var Rc=null,$a=P.dependencies["prezi.text"],Pa=P.dependencies["prezi.text.model"],ab=P.dependencies.prezi_externalserviceprovider,Q=P.dependencies.prezi_featureswitcher,D=P.dependencies.prezi_nativeapitypes,
H=P.dependencies.prezi_service_data,Sc=P.dependencies.prezi_service_fontcatalogue,m=P.dependencies["prezi.engine.dom"],v=P.dependencies["prezi.geometry"],f=P.dependencies.prezi_cet_model,h=P.dependencies.prezi_cet_renderer,t=P.dependencies.prezi_logger,Tc=P.dependencies.prezi_service_assetloader,x=P.dependencies.prezi_utils,T=P.dependencies.prezi_video,p=P.dependencies.prezi_bacon,bb={};Object.defineProperty(bb,"__esModule",{value:!0});bb.pl=class{constructor(){}getNavigationMode(){return e.NavigationMode.NEW_TRANSITION}reset(){}};
var yb={};Object.defineProperty(yb,"__esModule",{value:!0});yb.tq=class{constructor(a,b){this.eb=a;this.N=b;this.uk=p.Bacon.newBus()}start(a,b,c=!1){null==b&&(b=[0]);if(0!==b.length){var d=this.N.getLogAllFrames();this.N.getStatisticsProcessor().setAutoplaySpeedTest(a);this.N.setLogAllFrames(c);this.N.stopScheduledTest();var g=0,f=this.eb.getPathNavigator().getNavigationStrategy();this.eb.getPathNavigator().setNavigationStrategy(new bb.pl);this.eb.setLoop(1<b.length);this.eb.setInterval(b[0]);this.eb.getPathNavigator().go(this.eb.getPathNavigator().getPath().getPathPosition(0,
0));var F=()=>{};F=this.eb.getEventStream().onValue((a)=>{switch(a.getType()){case e.AutoPlayEventType.START:case e.AutoPlayEventType.RESTART:this.uk.push(!0);a=b[g++];g>=b.length&&this.eb.setLoop(!1);this.eb.setInterval(a);this.N.setExperiment(a+"_msec_delay");break;case e.AutoPlayEventType.STOP:F(),this.eb.getPathNavigator().setNavigationStrategy(f),this.N.stop(),this.N.setLogAllFrames(d),this.N.startScheduledTest(),this.N.getStatisticsProcessor().stopAutoplaySpeedTest(),this.uk.push(!1)}});this.N.start();
this.eb.start()}}getSpeedTestInProgressStream(){return this.uk.toProperty(!1)}};var zb={};Object.defineProperty(zb,"__esModule",{value:!0});zb.Nq=class{static getEmailsInString(a){const b=new RegExp(/[a-zA-Z-1-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*/,"g"),c=[];let d;for(;null!==(d=b.exec(a));)c.push({str:d[0],pos:d.index,end:d.index+d[0].length});return c}};var J={};Object.defineProperty(J,"__esModule",{value:!0});J.Ha=class{static Ao(a,b){let c=!1;if(0<b.length)for(let e=0;e<
a.getLength();e++){var d=a.getCharacterStylesAt(e),g;if(g=null!=d){g=d.isUrl();a:{for(let a=0,c=b.length;a<c;a++)if(d=b[a],d.pos<=e&&e<d.end){d=!0;break a}d=!1}g=g!==d}if(g){c=!0;break}}return c}static wo(a){const b=J.Ha.bj(a);var c=J.Ha.Ao(a,b);if(c){a=a.applyStyles(0,a.getLength(),J.Ha.mm,!1);for(let d=0,g=b.length;d<g;d++)c=b[d],a=a.applyStyles(c.pos,c.end,J.Ha.um,!1)}return a}static Iv(a){const b=J.Ha.bj(a);var c=J.Ha.Ao(a,b);if(c){a=a.applyStyles(0,a.getLength(),J.Ha.mm,!1);for(let d=0,g=b.length;d<
g;d++)c=b[d],a=a.applyStyles(c.pos,c.end,J.Ha.um,!1)}return a}static Wu(a){let b=J.Ha.bj(a.getText()),c=[];for(let d=0,g=b.length;d<g;d++){let g=b[d],e=a.getLayoutBoundsForRange(g.pos,g.end);c.push({url:g.str,bounds:e})}return c}static bj(a){const b=[];let c=0;for(let d=0,g=a.getParagraphCount();d<g;d++){const g=a.getParagraph(d);this.getUrlsInString(g.getText()).forEach((a)=>{b.push({pos:c+a.pos,end:c+a.end,str:a.str})});c+=g.getText().length+1}return b}static getUrlsInString(a){const b=x.Utils.getUrlRegExp(),
c=[];for(;;){const d=b.exec(a);if(null==d)break;c.push({pos:d.index,end:d.index+d[0].length,str:d[0]})}return c}};J.Ha.um=Pa.LayoutModel.createEmptyCharacterStyleContainer().setUrl(1);J.Ha.mm=Pa.LayoutModel.createEmptyCharacterStyleContainer().setUrl(0);var Ab={};Object.defineProperty(Ab,"__esModule",{value:!0});Ab.pq=class{constructor(a){this.ca=a;this.ym=[];this.eg=[];this.Nd=[]}addThumbnailRenderer(a,b){this.Nd.push({Ax:b,assetId:a});0<this.jn(a).length&&this.Np(a)}removeAssetId(a){const b=this.ca.getRecentAssetId(a);
this.Nd=this.Nd.filter((a)=>this.ca.getRecentAssetId(a.assetId)===b);this.eg=this.eg.filter((a)=>this.ca.getRecentAssetId(a.assetId)===b)}jn(a){const b=this.ca.getRecentAssetId(a);return this.ym.map((a)=>this.j.getEntityById(a)).filter((a)=>null!=a).map((a)=>a.getWrapper(f.CetModel.ID.MEDIA_ASSET.W)).filter((a)=>this.ca.getRecentAssetId(a.getOfflineAssetId())===b)}registerIMediaAssetW(a){const b=this.ca.getRecentAssetId(a.getOfflineAssetId());var c=a.getEntity().get(this.getKey());if(null==c||this.ca.getRecentAssetId(c.assetId)!==
b)c=this.eg.find((a)=>this.ca.getRecentAssetId(a.assetId)===b),a.getEntity().set(this.getKey(),null!=c?c:{assetId:b,id:null,thumbnail:null}),this.ym.push(a.getId()),this.Np(b)}Np(a){const b=this.ca.getRecentAssetId(a);a=this.Nd.findIndex((a)=>this.ca.getRecentAssetId(a.assetId)===b);if(-1!==a){var c=this.Nd[a];c.Ax().then((a)=>{const b={thumbnail:a,assetId:c.assetId};this.eg.push(b);this.j.executeNoDomBatchUpdate((a)=>{for(const c of this.jn(b.assetId))a.getEntityById(c.getId()).set(this.getKey(),
b)})}).catch(()=>{});this.Nd.splice(a,1)}}getThumbnail(a){const b=a.getEntity().get(this.getKey());return null==b||this.ca.getRecentAssetId(b.assetId)!==this.ca.getRecentAssetId(a.getOfflineAssetId())||null==b.thumbnail?null:b}getKey(){return e.Cet.getAssetThumbnailKey()}};var ja={};Object.defineProperty(ja,"__esModule",{value:!0});ja.cd=class{constructor(){}static Ru(){let a=ja.cd.startTime;null!=window.performance&&null!=window.performance.timing&&null!=window.performance.timing.navigationStart&&
(a=window.performance.timing.navigationStart);return(new ja.cd).now()-a}now(){return(new Date).getTime()}Bp(a,b){return x.Utils.delay(a,b)}xx(a){null!=a&&a.stop()}};ja.cd.startTime=(new Date).getTime();var I={};Object.defineProperty(I,"__esModule",{value:!0});(function(a){a[a.IDLE=0]="IDLE";a[a.li=1]="WORKING";a[a.Gd=2]="STOPPED";a[a.sc=3]="DISPOSED"})(I.Ea||(I.Ea={}));var R={};Object.defineProperty(R,"__esModule",{value:!0});R.Xa=class{constructor(a,b){this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.EagleTypePanning");
this.camera=a;this.Oa=b;this.state=I.Ea.IDLE}init(a){this.state!==I.Ea.sc&&(this.Rb=a,this.kf=this.camera.getTransform(),this.state=I.Ea.IDLE)}stop(){return this.state===I.Ea.sc?this.state:this.state=this.state===I.Ea.li?I.Ea.Gd:I.Ea.sc}Hv(){return this.state===I.Ea.li}ex(a){this.state!==I.Ea.sc&&(this.mo=this.Oa.now(),this.he=a,this.state=I.Ea.li,this.update())}update(){var a=this.state;if(a===I.Ea.sc||a===I.Ea.IDLE)return this.state;if(null==this.Rb||null==this.he)return this.logger.print("Not initialized in state: "+
x.Utils.stringify(this.state)),this.state;var b=this.Oa.now();a=Math.floor(Math.max(1,Math.floor((b-this.mo)/R.Xa.yr)));this.mo=b;b=this.camera.getTransform();for(let c=0;c<a&&this.state!==I.Ea.sc;c++)b=this.Lx(b);this.camera.hk(b);return this.state}Lx(a){let b=this.Zs(),c=this.Ws(b),d=this.Ys(a,c);return this.Av(c,d)?(a=this.nu(a),this.dispose(),a):this.ew(a,d,b)}Zs(){return{x:(this.he.x-this.Rb.x)*R.Xa.bl,y:(this.he.y-this.Rb.y)*R.Xa.bl}}Ws(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))}Ys(a,
b){a=Math.log(a.getScale());b=Math.log(this.kf.getScale())-b/R.Xa.sr;return Math.exp(a+(b-a)*R.Xa.Yr)}Av(a,b){b/=this.kf.getScale();return a<R.Xa.Vq&&R.Xa.Wq<b&&this.state===I.Ea.Gd}nu(a){var b=this.he.x-this.Rb.x,c=this.he.y-this.Rb.y;let d=a.scaleAroundPoint(this.Rb,this.kf.getScale()/a.getScale());a=this.kf.getScale()/a.getScale();return d.translate({x:a*b,y:a*c})}ew(a,b,c){let d=a.scaleAroundPoint(this.Rb,b/a.getScale());a=b/a.getScale();c={x:a*c.x,y:a*c.y};this.Rb={x:c.x+this.Rb.x,y:c.y+this.Rb.y};
return d.translate(c)}dispose(){this.kf=this.he=null;this.state=I.Ea.sc}};R.Xa.bl=.125;R.Xa.Yr=.06666666666666667;R.Xa.Vq=5E-4;R.Xa.Wq=.999;R.Xa.sr=400;R.Xa.yr=17;var cb={};Object.defineProperty(cb,"__esModule",{value:!0});cb.Qk=class{constructor(a,b,c){this.Ef=a;this.fd=b;this.Se=c}update(a){a=Math.round(a);return this.Ef.update(a>this.fd?this.Se*(a-this.fd)+this.fd:a)}Xi(){return this.Se}rk(){throw Error("setup should not be called on AcceleratedTransition, use new()");}kd(){return Math.round(0<
this.Se?(this.Ef.kd()-this.fd)/this.Se+this.fd:this.fd+this.fd/-this.Se)}Dg(){return this.Ef.Dg()}lh(a){this.Ef.lh(a)}};var K={};Object.defineProperty(K,"__esModule",{value:!0});class pa{static Bx(a){return a*Math.PI/180}static sinh(a){return(Math.exp(a)-Math.exp(-a))/2}static cosh(a){return(Math.exp(a)+Math.exp(-a))/2}static tanh(a){return pa.sinh(a)/pa.cosh(a)}static Ey(a){return a*a}static min(a,b){return a<b?a:b}static max(a,b){return a<b?b:a}}K.Yk=class{constructor(){this.Jb=1.4}rk(a,b,c){this.w=
K.$c.mg(a);this.J=K.$c.mg(b);this.bm();this.bg=c;this.Ol();isNaN(this.tb)&&(this.tb=1.2,this.Pg=!0)}lh(a){this.w=K.$c.mg(a.concat(this.w.zd()));this.J=K.$c.mg(a.concat(this.J.zd()));this.bm();this.kj()}Ol(){}kj(){}bm(){this.w.rotation%=360;this.J.rotation%=360;-180>this.w.rotation?this.w.rotation+=360:180<this.w.rotation&&(this.w.rotation-=360);180<Math.abs(this.J.rotation-this.w.rotation)&&(0>this.J.rotation?this.J.rotation+=360:0<this.J.rotation&&(this.J.rotation-=360))}update(a){let b,c;var d=
Math.round(a);let g=1E3*this.tb;if(0===g)return this.J.zd();if(0>d)return this.w.zd();if(d>g)return this.J.zd();this.Pg?(a=this.qg(d,this.w.x,this.J.x-this.w.x,g),b=this.qg(d,this.w.y,this.J.y-this.w.y,g),c=this.qg(d,this.w.scale,this.J.scale-this.w.scale,g),d=this.sm(d,this.w.rotation,this.J.rotation-this.w.rotation,g),a=new K.$c(a,b,c,d)):a=this.Tu(d,g);return a.zd()}Tu(a,b){a=this.Tm(a,b);b=this.Au(this.S*a);return new K.$c(this.w.x+b*this.Ex,this.w.y+b*this.Fx,this.bg/this.Bu(this.S*a),(this.w.rotation+
a*(this.J.rotation-this.w.rotation))%360)}Tm(a,b){return this.cu(a,this.eu,this.Mi,b)/b}kd(){return Math.round(1E3*this.tb)}Dg(){if(null==this.J)throw"getEndPosition: Transition is not initialized yet!";return this.J.zd()}qg(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}sm(a,b,c,d){return c*a/d+b}bu(a,b,c){a/=c;return b*a*a}du(a,b,c,d){a/=d;return-c*a*(a-2)+b}cu(a,b,c,d){return a<b?this.bu(a,c,b):a<d-b?this.sm(a-b,c,d-2*c,d-2*b):this.du(a-d+b,d-c,c,b)}Au(a){return this.se*pa.cosh(this.je)*
pa.tanh(this.Jb*a+this.je)/(this.Jb*this.Jb)-this.se*pa.sinh(this.je)/(this.Jb*this.Jb)+this.Fk}Bu(a){return this.se*pa.cosh(this.je)/pa.cosh(this.Jb*a+this.je)}};K.my=class extends K.Yk{constructor(a){super();this.Pg=!0;this.tb=null==a?1.2:a}};K.il=class extends K.Yk{constructor(a=1){super();this.Tp=a}Ol(){this.Pg=!1;var a=this.J.x-this.w.x;let b=this.J.y-this.w.y;a=Math.sqrt(a*a+b*b);Math.abs(0-a)<=Math.pow(2,-30)&&Math.abs(this.J.rotation-this.w.rotation)<=Math.pow(2,-30)&&Math.abs(1-this.w.scale/
this.J.scale)<=Math.pow(2,-30)?this.tb=0:(this.Pg=.3>Math.abs(1-this.w.scale/this.J.scale)&&5>Math.abs(this.w.rotation-this.J.rotation)&&a<1.8*this.bg/this.J.scale,this.tb=this.Mv(this.kj()),this.tb*=1+1.5*Math.abs(this.J.rotation-this.w.rotation)/180,isNaN(this.tb)||(this.tb=Math.min(this.tb,5)*this.Tp,this.Xs()))}Xs(){let a=1E3*this.tb;this.Mi=a*(.5-this.qg(Math.max(a-1500,0),0,.5-.28,3500));this.eu=2*this.Mi*a/(a+2*this.Mi)}kj(){this.se=this.bg/this.w.scale;this.Ok=this.bg/this.J.scale;this.Fk=
0;this.Oh=Math.sqrt(Math.pow(this.J.x-this.w.x,2)+Math.pow(this.J.y-this.w.y,2));var a=this.Ok*this.Ok-this.se*this.se;let b=Math.pow(this.Jb,4)*Math.pow(this.Oh-this.Fk,2),c=2*this.Jb*this.Jb*(this.Oh-this.Fk),d=(a+b)/(this.se*c);a=(a-b)/(this.Ok*c);this.je=Math.log(-d+Math.sqrt(d*d+1));this.S=(Math.log(-a+Math.sqrt(a*a+1))-this.je)/this.Jb;this.Ex=(this.J.x-this.w.x)/this.Oh;this.Fx=(this.J.y-this.w.y)/this.Oh;return this.S}Mv(a){var b,c;if(isNaN(a)||!isFinite(a))return NaN;null==b&&(b=1.2/1.34);
null==c&&(c=3/1.34);return.3>a?b:5.3<a?c:b+(a-.3)*(c-b)/5}};K.$q=class extends K.il{constructor(a=1){super();this.Jb=1.15;this.Tp=a}Tm(a,b){return this.au(a,b)}au(a,b){a/=b/4;return 1>a?.5*a:.5*(Math.pow((a-1)/3-1,3)+2)}};K.$c=class{constructor(a,b,c,d){this.x=a;this.y=b;this.scale=c;this.rotation=d}static mg(a){var b=Math.cos(-a.getRotationRad());let c=Math.sin(-a.getRotationRad()),d=a.getTranslation(),g=d.x/a.getScale()*b-d.y/a.getScale()*c;b=d.x/a.getScale()*c+d.y/a.getScale()*b;return new K.$c(g,
b,a.getScale(),a.getRotationDeg())}zd(){let a=pa.Bx(this.rotation),b=Math.cos(a),c=Math.sin(a);return v.Geometry.transform2dFromRad({x:(this.x*b-this.y*c)*this.scale,y:(this.x*c+this.y*b)*this.scale},this.scale,a)}};var Bb={};Object.defineProperty(Bb,"__esModule",{value:!0});Bb.tr=class{constructor(){}rk(a,b){this.w=a;this.J=b;this.Cl=this.w.getTranslation().x;this.Dl=this.w.getTranslation().y;this.Al=this.w.getScale();this.yl=this.w.getRotationRad();this.Bs=this.J.getTranslation().x-this.Cl;this.Cs=
this.J.getTranslation().y-this.Dl;this.As=this.J.getScale()-this.Al;this.zs=this.J.getRotationRad()-this.yl}lh(a){this.w=a.concat(this.w);this.J=a.concat(this.J)}update(a){a=Math.round(a)/this.kd();return v.Geometry.transform2dFromRad({x:this.Cl+a*this.Bs,y:this.Dl+a*this.Cs},this.Al+a*this.As,this.yl+a*this.zs)}kd(){return 1E3}Dg(){if(null==this.J)throw"getEndPosition: Transition is not initialized yet!";return this.J}};var G={};Object.defineProperty(G,"__esModule",{value:!0});G.Id=class{constructor(a){this.delegate=
a;null==G.Id.Ed&&(G.Id.Ed=t.LoggerModule.getLoggerManager().createLogger("prezi_cet_modelcomponent.UniverseLimitWatchingTransformWrapper"))}getEntity(){return this.delegate.getEntity()}getId(){return this.delegate.getId()}setLocalToWorld(a){if(k.i.hasPdomComponent(this.getEntity())){if(isNaN(a.getTranslation().x)||isNaN(a.getTranslation().y)||isNaN(a.getScale())||isNaN(a.getRotationRad())){a=this.getId();h.CetRendererModule.logMonitoringOncePerSession(G.Id.Ed,a,"nan_transform","transform",Error("Tried to set transform with NaN components!"),
this.getEntity().tsto(),t.Level.WARN);return}if(G.Db.zv(a)){const a=this.getId();h.CetRendererModule.logMonitoringOncePerSession(G.Id.Ed,a,"possible_universe_limit_violation","transform","possible_universe_limit_violation",this.getEntity().tsto(),t.Level.WARN)}}null!=this.getLocalToWorld()&&this.getLocalToWorld().equalsWithin(a,Math.pow(2,-40))||(this.delegate.setLocalToWorld(a),h.CetRendererModule.updateWorldProperties(this.getEntity()))}getLocalToWorld(){return this.delegate.getLocalToWorld()}getWorldToLocal(){return this.delegate.getWorldToLocal()}asMutableEntity(){return this.delegate.asMutableEntity()}toIPdom(){return this.delegate.toIPdom()}};
G.Db=class{static zv(a){const b=a.getScale();return b>G.Db.$f||b<this.hn(a.getTranslation())}static hn(a){return Math.max(Math.abs(a.x),Math.abs(a.y))/1E6}static an(a){return 10*this.hn(a)}static Qg(a){a=a.invert();const b=a.getScale();return b>G.Db.$f?e.ZoomingLimit.ZoomOutLimitReached:b<this.an(a.getTranslation())?e.ZoomingLimit.ZoomInLimitReached:e.ZoomingLimit.WithinLimits}static Pw(a){a=a.invert();const b=a.getScale();let c=1;if(b>G.Db.$f)c=G.Db.$f/b;else{const d=this.an(a.getTranslation());
b<d&&(c=d/b)}return a.scaleAroundPoint(a.getTranslation(),c).invert()}};G.Db.$f=5E3;var Cb={};Object.defineProperty(Cb,"__esModule",{value:!0});Cb.ar=class{constructor(a,b,c,d){this.target=a;this.camera=b;this.Oa=c;this.$d=d;this.startTime=c.now();this.co=this.bo=this.Dk=this.dk=!1;this.yk=this.Ml()}Vi(){return this.target.getScale()>this.camera.getTransform().getScale()?e.ZoomingDirection.ZOOM_IN:e.ZoomingDirection.ZOOM_OUT}rj(){return this.dk&&this.Dk}getCenter(){return this.target.getTranslation()}getTarget(){return this.target}updateTarget(a){this.target=
a;this.yk=this.Ml()}update(){if(!this.rj()){var a=this.Oa.now(),b=a-this.startTime;this.startTime=a;a=this.camera.getTransform();b=v.Geometry.transform2dFromRad(this.tv(b),this.uv(b),a.getRotationRad());a=G.Db.Qg(b);Q.isActive("js-zoom-limits")&&this.$d&&(a===e.ZoomingLimit.ZoomInLimitReached&&this.Vi()===e.ZoomingDirection.ZOOM_IN||a===e.ZoomingLimit.ZoomOutLimitReached&&this.Vi()===e.ZoomingDirection.ZOOM_OUT)?(this.Dk=this.dk=!0,this.bo=a===e.ZoomingLimit.ZoomInLimitReached,this.co=a===e.ZoomingLimit.ZoomOutLimitReached):
this.camera.hk(b)}}Ml(){const a=this.camera.viewportInWorld(),b=this.camera.getTransform().getScale()/this.target.getScale();return{width:a.getWidth()*b,height:a.getHeight()*b}}tv(a){const b=this.target.getTranslation(),c=this.camera.getTransform().getTranslation();if(.5>v.Geometry.distance(b,c))return this.Dk=!0,this.target.getTranslation();a=1-Math.pow(.9916890167,a);return{x:c.x+(b.x-c.x)*a,y:c.y+(b.y-c.y)*a}}uv(a){const b=this.camera.viewportInWorld();let c={height:1E3/b.getHeight(),width:1E3/
b.getWidth()};var d=1E3/this.yk.height-c.height,g=1E3/this.yk.width-c.width;if(d*d+g*g<5E-6*5E-6)return this.dk=!0,this.target.getScale();a=1-Math.pow(.9916890167,a);c={height:1E3/(c.height+d*a),width:1E3/(c.width+g*a)};return b.getHeight()/c.height*this.camera.getTransform().getScale()}};var ka={};Object.defineProperty(ka,"__esModule",{value:!0});ka.Vc=class{constructor(a,b,c,d){this.Ki=e.CameraNavigationType.NONE;this.qd=this.yo=this.Vg=this.version=0;this.uo=this.xj=this.viewport=a;this.id=ka.Vc.rd++;
this.Ck=null!=b?b:p.Bacon.newBus();this.Wh=null!=d?d:p.Bacon.newBus();this.Gf=p.Bacon.newBus();this.ah=p.Bacon.newBus();this.Mh=p.Bacon.newBus();this.ke=v.Geometry.transform2dIdentity();this.version++;this.Bd=v.Geometry.transform2dIdentity();this.Ai=!0;this.$l=p.Bacon.newBus();this.Jp=p.Bacon.newBus()}hx(a){this.Vp=a}setReferenceTransformEntity(a){if(this.qf!==a){const b=this.Xd().invert();let c=this.Vp.getLocalToWorldInRenderedScene(a);null==c&&(c=v.Geometry.transform2dIdentity());this.ke=c.concat(this.getViewportTransform());
null!=this.transition&&this.transition.lh(c.concat(b));this.qf=a;this.Rg=c}}Xd(a){if(null==this.qf)return v.Geometry.transform2dIdentity();a=(null!=a?a:this.Vp).getLocalToWorldInRenderedScene(this.qf);return null==a?(this.ke=this.Rg.invert().concat(this.ke),this.Rg=v.Geometry.transform2dIdentity(),this.qf=null,this.Rg):this.Rg=a}getCameraTransformStream(){return this.$l.toProperty(this.cm())}getStageAreaStream(){return this.Jp.toProperty(this.Eh)}cm(a,b){let c=null;null!=this.Ma&&(c=e.CameraTransitionType.Pan);
null!=this.Va&&(c=e.CameraTransitionType.Zoom);null!=this.transition&&(c=e.CameraTransitionType.Fly);const d=v.Geometry.obbFromRect(this.viewport.getData()).transform(this.getTransform(b).invert());return{isCameraOnPath:this.Ai,viewportTransform:null!=a?a:this.getViewportTransform(b),worldOBB:d,currentTransitionType:c}}bt(){this.cancelPanning();this.Ke();this.cancelZooming()}getId(){return this.id}getVersion(){return this.version}setCameraOnPath(a){this.Ai=a}isCameraOnPath(){return this.Ai}getViewport(){return this.viewport}getMarginCorrectedViewport(){return this.xj}getStageArea(){return this.Eh}getWorldArea(){return v.Geometry.obbFromRect(this.Eh.getData()).transform(this.getTransform().invert())}nk(a){this.Eh=
a;this.Jp.push(this.Eh)}Ah(a){this.viewport=a;this.version++}getTransformStream(){return this.Ck.skipDuplicates()}getTargetTransform(){return null!=this.transition?this.Xd().invert().concat(this.transition.Dg()).concat(this.Bd):this.getTransform()}getZoomingStream(){return this.Wh.skipDuplicates()}getZoomingLimitStream(){return this.Gf.skipDuplicates()}getPanningStream(){return this.ah.skipDuplicates()}getTransitionStream(){return this.Mh.skipDuplicates()}jx(a,b){this.uo=a;let c=Math.min(a.getWidth()/
this.getViewport().getWidth(),a.getHeight()/this.getViewport().getHeight()),d=this.getViewport().getWidth()*c,g=this.getViewport().getHeight()*c,e,f;Math.ceil(d)<a.getWidth()?(e=Math.ceil(a.getTopLeft().x+(a.getWidth()-d)/2),f=a.getTopLeft().y):(f=Math.ceil(a.getTopLeft().y+(a.getHeight()-g)/2),e=a.getTopLeft().x);this.xj=v.Geometry.rectangleFromData({x:e,y:f,width:d,height:g});a=v.Geometry.transform2dFromRad({x:e-this.getViewport().getTopLeft().x*c,y:f-this.getViewport().getTopLeft().y*c},c,0);b&&
this.setViewportTransform(this.getTransform().concat(a.invert()),null,!1);this.Bd=a;this.version++}getMarginCorrectedStageArea(){return this.uo}getTransform(a){return this.getViewportTransform(a).concat(this.Bd)}getViewportTransform(a){return this.Xd(a).invert().concat(this.ke)}getViewportMarginCorrectionTransform(){return this.Bd}setViewportTransform(a,b,c=!0){this.ri(a,b);c&&this.Ke();this.Ck.push(this.getTransform(b))}hk(a){this.ri(a.concat(this.Bd.invert()));this.Ke();null!=this.Ij&&this.Ij()}ri(a,
b){this.yo=(new Date).getTime();this.ke=this.Xd(b).concat(a);this.version++;let c=this.cm(a,b);x.Utils.delay(()=>{this.$l.push(c)},0);Q.isActive("js-zoom-limits")&&this.$d&&(a=a.concat(this.Bd),this.Gf.push(G.Db.Qg(a)))}Yw(a){this.Ij=a}cancelZooming(){null!=this.Va&&(this.Va=null,this.Wh.push(e.ZoomingEvent.NoZoom))}startFreeZoom(a){this.Va=new Cb.ar(a,this,new ja.cd,this.$d);this.Ij()}updateFreeZoom(a){null!=this.Va&&this.Va.updateTarget(a)}getOngoingZoomTarget(){return null==this.Va||this.Va.rj()?
null:this.Va.getTarget()}Kx(){null!=this.Ma&&this.Ma.update()===I.Ea.sc&&(this.ah.push(e.PanningEvent.PanningFinished),this.Ma=null)}Sx(){null!=this.Va&&(this.Va.update(),this.Va.bo?(this.Gf.push(e.ZoomingLimit.ZoomInLimitReached),this.vj(e.ZoomingLimit.ZoomInLimitReached)):this.Va.co&&(this.Gf.push(e.ZoomingLimit.ZoomOutLimitReached),this.vj(e.ZoomingLimit.ZoomOutLimitReached)));null==this.Va||this.Va.rj()?this.Wh.push(e.ZoomingEvent.NoZoom):this.Wh.push(this.Va.Vi()===e.ZoomingDirection.ZOOM_IN?
e.ZoomingEvent.ZoomIn:e.ZoomingEvent.ZoomOut)}vj(a){a===e.ZoomingLimit.ZoomInLimitReached?t.avro.Avro.createDefaultLogger().logTriggeredUniversalLimit({universal_limit_event:"ZOOM_IN_LIMIT_REACHED"}):a===e.ZoomingLimit.ZoomOutLimitReached&&t.avro.Avro.createDefaultLogger().logTriggeredUniversalLimit({universal_limit_event:"ZOOM_OUT_LIMIT_REACHED"})}setPanningTargetPosition(a){null!=this.Ma&&(this.setCameraOnPath(!1),this.ah.push(e.PanningEvent.PanningStarted),this.Ma.ex(a))}stopPanning(){null!=this.Ma&&
this.Ma.stop()}startPanning(a){null!=this.Ma&&this.Ma.dispose();this.Ma=new R.Xa(this,new ja.cd);this.Ma.init(a)}cancelPanning(){null!=this.Ma&&(this.Ma.dispose(),this.ah.push(e.PanningEvent.PanningFinished),this.Ma=null)}screenPointToWorld(a){let b=v.Geometry.createFromTransform(this.getTransform());b.invert();return b.transformPoint(a)}worldPointToScreen(a){return v.Geometry.createFromTransform(this.getTransform()).transformPoint(a)}viewportInWorld(){return this.screenAreaToWorld(this.viewport)}screenAreaToWorld(a){let b=
v.Geometry.createFromTransform(this.getTransform());b.invert();return b.transformToBoundingBox(a)}Ue(a,b,c=1,d=e.CameraNavigationType.FLY){Q.isActive("js-for-test-fast-fly")&&(c/=100);c=this.isCameraOnPath()?new K.il(c):new K.$q(c);this.Wp(a,b,c);this.Ki=d}slideTo(a){let b=new Bb.tr;this.Wp(a,()=>{},b);this.sg()}invertCurrentTransition(a){this.accelerateCurrentTransition(-a)}Uu(){return this.isInAcceleratedTransition()?this.transition.Ef:this.transition}Xi(){return this.isInAcceleratedTransition()?
this.transition.Xi():1}accelerateCurrentTransition(a){let b=(new Date).getTime()-this.qd,c=a*this.Xi();0>a&&(this.Lc=null);this.transition=new cb.Qk(this.Uu(),Math.round(b),c);this.Mh.push(e.TransitionEvent.TransitionStarted)}Wp(a,b,c){this.bt();let d=this.xj.getData().width;const g=this.ke,f=this.Xd().concat(a);this.Ck.push(a);c.rk(g,f,d);this.Lc=null!=b?[b]:[];this.qd=(new Date).getTime();this.transition=c;this.Mh.push(e.TransitionEvent.TransitionStarted)}sg(){Q.isActive("js-zoom-limits")&&this.$d&&
G.Db.Qg(this.getTargetTransform())&&this.whenTransitionFinished((a)=>{a&&(a=G.Db.Pw(this.getTargetTransform()),this.hk(a))})}whenTransitionFinished(a){null==this.transition&&a(!0);null==this.Lc&&(this.Lc=[]);this.Lc.push(a)}Ox(){this.bq((new Date).getTime())}ru(){null!=this.transition&&this.bq(this.qd+this.transition.kd()+1)}bq(a){this.Vg=a;if(null!=this.transition){var b=this.Vg-this.qd;a=this.transition.update(b);var c=this.Xd();if(b>this.transition.kd()&&(this.Km(!0),this.Ke(),Q.isActive("js-zoom-limits")&&
this.$d&&(b=c.invert().concat(a).concat(this.Bd),b=G.Db.Qg(b),b!==e.ZoomingLimit.WithinLimits))){this.Gf.push(b);this.vj(b);return}this.ri(c.invert().concat(a));null!=this.aw&&this.aw()}}Km(a){if(null!=this.Lc){let b=this.Lc.slice();this.Lc=null;for(let c of b)c(a)}}Ke(){null!=this.transition&&(this.Km(!1),this.transition=null,this.Mh.push(e.TransitionEvent.TransitionFinished),this.Lc=null,this.qd=0,this.Ki=e.CameraNavigationType.NONE)}zj(){return!this.isCameraSettledDown()||null!=this.Ma&&this.Ma.Hv()}isCameraSettledDown(){return this.Vg-
this.yo>=ka.Vc.dl&&this.Vg-this.qd>=ka.Vc.dl}isInTransition(){return null!=this.transition}isInAcceleratedTransition(){return this.transition instanceof cb.Qk}getRemainingTransitionTime(){if(null!=this.transition){let a=(new Date).getTime();return Math.max(this.qd+this.transition.kd()-a,0)}return 0}Xw(a){this.tu=a}getFocusedEntity(){return this.tu}getCurrentCameraNavigation(){return this.Ki}getSnapshot(){const a=this.getTransform(),b=this.getMarginCorrectedViewport(),c=this.getStageArea();return{getTransform:()=>
a,getMarginCorrectedViewport:()=>b,getStageArea:()=>c}}setIsZoomLimitEnforced(a){this.$d=a}};ka.Vc.dl=200;ka.Vc.rd=0;var db={};Object.defineProperty(db,"__esModule",{value:!0});db.nl=class{constructor(a){this.fh=!1;this.Ti=a;db.nl.nv()}static nv(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;null==window.requestAnimationFrame&&(window.requestAnimationFrame=function(){return 1})}request(){this.fh||
(window.requestAnimationFrame(()=>this.Fw()),this.fh=!0)}Fw(){this.fh=!1;null!=this.Ti&&this.Ti()}reset(){this.Ti=null}isAnimFramePending(){return this.fh}};var y={};Object.defineProperty(y,"__esModule",{value:!0});y.lr=class{constructor(a,b){this.te=a;this.sd=b}};y.na=class{constructor(a,b,c,d,g,e,f){this.Dj=[];this.Jj=[];this.pg=new Map;this.uj=null;this.dg=!1;this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.CanvasEngine");this.pb=a;this.Qi=!0;this.Sg=y.na.Tf;null!=f&&(y.na.Tf=
f.getZeroTimestamp(),this.N=f);this.ha=b;a=(a)=>{this.ha.resizeStage(a);null!=this.N&&this.N.setResolution(a.width,a.height)};a(this.pb.getSize());this.pb.getResizeStream().onValue(a);this.Na=d;this.requestAnimationFrame=new db.nl(()=>this.update());this.vm=p.Bacon.newBus();this.Oa=new ja.cd;this.jb={};this.le={};this.ip=-1;this.Fb=e;this.Hl=e.toProperty("");this.Gs();this.Hs(g);this.ha.markViewChanged();window.addEventListener("scroll",()=>{this.uj=Date.now()},!0)}static Ls(a){return a.asArray().every((a)=>
!a.hasComponent(h.CetRendererModule.getDrawComponentKey())||e.Cet.draw(a).hasError()||e.Cet.draw(a).isFullyRenderable(a))}start(){this.kh()}Gs(){this.Hl.filter((a)=>"allAssetsLoaded"===a).onValue(()=>{this.Qv()})}Hs(a){a.filter((a)=>a).onValue(()=>{this.kh()})}dispose(){this.pb.setCanvas(null);this.requestAnimationFrame.reset();null!=this.getMainStage()&&this.getMainStage().dispose()}fk(){this.Di();this.kh()}vh(){var a=this.Nu();a!==y.na.Zc&&(a===y.na.Xk?this.fk():(a-=this.Oa.now(),16<a?this.gj=this.Oa.Bp(()=>
this.fk(),Math.floor(a)):this.fk()))}Di(){this.Oa.xx(this.gj);this.gj=null}bk(a){for(let b of a)try{b()}catch(c){t.LoggerModule.logException(this.logger,"CanvasEngine","runCallbacks",c)}a.splice(0,a.length)}Kw(){var a=this.Oa.now(),b=[];for(let c in this.jb)if(this.jb.hasOwnProperty(c)){const d=this.jb[c];d.sd<=a&&b.push(d)}for(const a of b)a.sd=y.na.Zc;for(const c of b){a=null;try{const b=(new Date).getTime();a=c.te.update();const g=(new Date).getTime();null!=this.N&&this.N.updateIdleWorkerMeasurements(c.te.getId(),
g-b)}catch(d){t.LoggerModule.logException(this.logger,"worker","runIdleWorkers",d,{object_id:c.te.getId()});try{c.te.reset(),a=y.na.Iq}catch(g){t.LoggerModule.logException(this.logger,"worker","exception_during_cancel",g,{object_id:c.te.getId()}),a=y.na.Zc}}a!==y.na.Zc&&(c.sd=this.Oa.now()+a)}for(const a of b)a.sd===y.na.Zc&&(b=a.te.getId(),delete this.jb[b])}Lw(a){var b=a;a=this.Oa.now()+b;let c=[];for(let d in this.le)if(this.le.hasOwnProperty(d)){if(1>=b)break;b=this.le[d];try{b.update()}catch(g){t.LoggerModule.logException(this.logger,
"worker","runRenderWorkers",g,{object_id:b.getId()}),c.push(b.getId())}b=a-this.Oa.now()}for(let a of c)delete this.le[a]}Nu(){if(0<this.Dj.length)return y.na.Xk;if(0===Object.keys(this.jb).length)return y.na.Zc;let a=Number.POSITIVE_INFINITY;for(let b in this.jb)if(this.jb.hasOwnProperty(b)){let c=this.jb[b];c.sd<a&&(a=c.sd)}return a}addRenderWorker(a){this.le[a.getId()]=a}addIdleWorker(a,b){let c=this.Oa.now();b===y.na.Zc?(a=a.getId(),delete this.jb[a]):(b=c+b,null!=this.jb[a.getId()]?this.jb[a.getId()].sd=
b:this.jb[a.getId()]=new y.lr(a,b));this.Di();this.vh()}removeRenderWorker(a){a=a.getId();delete this.le[a]}removeIdleWorker(a){delete this.jb[a.getId()];this.Di();this.vh()}getMainStage(){return this.ha}Nn(){return!this.ha.wj&&!this.hasPendingTweens()}xv(){return this.Nn()&&this.Go()&&this.Fo()}Go(){var a,b;return(null!==(b=null===(a=this.ha.getModelScene())||void 0===a?void 0:a.getSceneHierarchy().getScenes())&&void 0!==b?b:[]).every((a)=>!a.isInTransaction())}Fo(){return null==this.uj||this.uj<
Date.now()-300}update(){if(this.ha.wj){this.ip=this.Oa.now();if(null!=this.N){this.Qi&&(this.N.setFirstMainDraw(ja.cd.Ru()),this.Qi=!1);this.N.updateCameraTransform(this.ha.getCamera().getTransform());this.N.executeWithMeasurementMergeShortFrames(()=>this.ha.drawFrame(),"mainDraw");var a=this.N.getCurrentTimestamp();this.Sg!==y.na.Tf&&this.N.updateProbeWithMeasurement("userFrame",this.Sg,a);var b=this.ha.getCamera().zj()||this.ha.Aj();b||this.Sg===y.na.Tf||(this.N.addEndOfTransitionLabel(),this.N.updateProbeWithMeasurement("userFrame",
a,a));this.Sg=b?a:y.na.Tf}else this.Qi=!1,this.ha.drawFrame();this.bk(this.Jj);a=this.Oa.now()-this.ip;a<y.na.cl&&this.Lw(y.na.cl-a)}else this.bk(this.Jj),this.bk(this.Dj),this.Go()&&this.Fo()&&(this.Kw(),null!=this.N&&this.N.incrementIdleFrames());if(!this.Ss)this.Sl(),this.Ss=!0;else if(!this.dg)for(a=(a)=>{let b=this.pg.get(a),c=!1;null==b?(b=a.startNewTracking("CanvasEngine-"+a.getName()+"-allAssetsLoaded",[h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.getIsLoadedComponentKey()],
()=>!0),this.pg.set(a,b),c=!0):a.forChangedEntities(()=>{c=!0},b);return c},b=this.ha.getRenderedScene();null!=b;){if(a(b.getEntityList())){this.Sl();if(this.dg){for(let [a,b]of this.pg.entries())a.stopTracking(b);this.pg.clear()}break}b=b.getParentScene()}a=this.ha.getNextFrameTime();0<a&&this.Oa.Bp(()=>{this.ha.markViewChanged()},Math.floor(a));null!=this.N&&this.N.frameEnded();null==this.gj&&this.vh();this.vm.push(null)}Sl(){y.na.Ls(this.getMainStage().Vd())&&(this.dg=!0,this.Fb.push("allAssetsLoaded"))}Kl(){null!=
this.N&&(this.N.setAllAssetsLoaded(!1),this.N.setPreprocessingDone(!1));this.dg=!1}kh(){this.requestAnimationFrame.request()}isAnimFramePending(){return this.requestAnimationFrame.isAnimFramePending()}getEndOfFrameStream(){return this.vm}Zg(){this.kh()}Qv(){null!=this.N&&this.N.setAllAssetsLoaded(!0)}hasPendingTweens(){return 0<=this.ha.getNextFrameTime()}createIdleStream(a){return this.hm(a,!0)}createUpdateStream(a){return this.hm(a,!1)}hm(a,b){let c=p.Bacon.newBus(),d=[];const g=()=>{const a=d;
d=[];for(let b of a)try{c.push(b)}catch(Ia){t.LoggerModule.logException(this.logger,"CanvasEngine","openValve",Ia)}};a.onValue((a)=>{0===d.length&&(b?(this.Dj.push(()=>g()),this.vh()):this.Jj.push(()=>g()));d.push(a)});return c}};y.na.Xk=0;y.na.Zc=-1;y.na.cl=33;y.na.Iq=100;var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});Qa.Zh=class{constructor(a,b,c){this.logger=t.LoggerModule.getLoggerManager().createLogger("DomLayerManager");this.Ri={};this.Ac=a;this.camera=b;this.video=c}removeElement(a){a=
window.document.getElementById(a);null!=a&&a.parentNode.removeChild(a)}getElement(a){return window.document.getElementById(a)}createElement(a){var b=window.document.getElementById(a);null==b&&(b=window.document.createElement("div"),b.id=a,this.Ac.appendChild(b),b.style.display="none");return b}createCanvasElement(a){var b=window.document.getElementById(a);null==b&&(b=window.document.createElement("canvas"),b.id=a,this.Ac.appendChild(b));return b}createIconElement(a,b,c){let d=window.document.getElementById(a);
null==d&&(d=window.document.createElement("i"),d.id=a,a=$(d),a.addClass(b),a.css("font-size",c+"px"),this.Ac.appendChild(d));return d}positionElementToTopLeft(a,b,c){a=window.document.getElementById(a);null!=a&&(a.style.position="absolute",a.style.left=b+"px",a.style.right="",a.style.top=c+"px")}positionElementToTopRight(a,b,c){a=window.document.getElementById(a);null!=a&&(a.style.position="absolute",a.style.left="",a.style.right=b+"px",a.style.top=c+"px")}positionElementToCenter(a,b,c){a=window.document.getElementById(a);
null!=a&&(a.style.position="absolute",a.style.right="",a.style.left=(this.getWidth()-b)/2+"px",a.style.top=(this.getHeight()-c)/2+"px")}getCameraScale(){return this.camera.getTransform().getScale()}getOffsetLeft(){return this.Ac.offsetLeft}getOffsetTop(){return this.Ac.offsetTop}getWidth(){return this.Ac.clientWidth}getHeight(){return this.Ac.clientHeight}transform(a,b,c=null){this.wi(a,b,c,(a)=>"matrix("+a.a+","+a.b+","+a.c+","+a.d+","+a.x+","+a.y+")")}dt(a){const b=this.getWidth()/2,c=this.getHeight()/
2;return{x:b+a.x,y:c+a.y}}transformScreen(a,b,c){const d=window.document.getElementById(a);if(null==d)throw Error(`No element found in DOM with id: ${a}`);d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.transformOrigin="0% 0%";a=v.Geometry.createFromTransform(v.Geometry.transform2dFromRad(this.dt(b),1,0));c=v.Geometry.createFromTransform(v.Geometry.transform2dFromRad({x:0,y:0},1,c));c.multiplyFromLeft(a);this.Qs(d,c.getData())}transformWithoutScale(a,b,c=null){this.wi(a,b,
c,(a)=>"matrix(1,"+a.b+","+a.c+",1,"+a.x+","+a.y+")")}transformWithoutScaleAndRotation(a,b,c=null){this.wi(a,b,c,(a)=>"matrix(1,0,0,1,"+a.x+","+a.y+")")}Qs(a,b){b=`matrix3d(
			${b.a}, ${b.b}, 0, 0,
			${b.c}, ${b.d}, 0, 0,
			0, 0, 1, 0,
			${b.x}, ${b.y}, 0, 1
		)`;a.style.webkitTransform=b;a.style.transform=b}wi(a,b,c,d){a=window.document.getElementById(a);if(null!=a){var g=v.Geometry.createFromTransform(this.camera.getTransform());b.concat(g);null!=c&&b.concat(c);b=b.getData();d=d(b);a.style.webkitTransform=d;a.style.transform=d}}setElementAlpha(a,b,c=!1){let d=window.document.getElementById(a);null==d?this.logger.warn({action:"missing_element_with_id ",object:"dom_layer",trigger:"machine",payload:{uy:a}}):null!=d&&null!=d.style&&(d.style.opacity=String(b),
0>=b&&!c?(d.style.left="-9999px",d.style.position="absolute"):(d.style.removeProperty("left"),d.style.removeProperty("position")))}createIFrame(a,b,c,d,g){null==g&&(g=this.Ac);let e=window.document.getElementById(a);null==e&&(e=window.document.createElement("iframe"),e.id=a,e.width=c+"px",e.height=d+"px",e.frameBorder="0",e.src=b,g.appendChild(e));return e}insertUIElement(a,b){$(b).css("pointer-events","auto");$(b).css("z-index","2901");$(a).append(b)}createUIContainer(a){a=this.createElement(a);
a.style.display="none";a.style.zIndex="2900";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.bottom="0px";return a}createVideoPlayer(a,b,c,d,g,e){let f=this.Bt(a);b=this.At(b,d,g,e);f.appendChild(b);c=this.createVideo(c);b.appendChild(c);c=$(b);this.video.initializeFlowplayer(c);$(".fp-ui").hide();$(".fp-engine").css("z-index",1901);c=this.video.getFlowplayerInstance(b);return this.Ri[a]=c}Bt(a){a=this.createElement(a);a.style.left="-9999px";a.style.position="absolute";a.style.opacity=
"0";a.style.display="block";a.style.zIndex="1900";a.style.pointerEvents="auto";return a}At(a,b,c,d){let g=window.document.createElement("div");g.id="flowplayer_"+a;g.style.width=b+"px";g.style.height=c+"px";g.style.background="#000";a=$(g);a.css("z-index",1902);null!=d&&(a.addClass("is-splash"),this.El(a,d));return g}updateVideoSplashImage(a,b){this.El($("#flowplayer_"+a),b)}El(a,b){a.css("background","#000 url("+b+") no-repeat center");a.css("background-size","contain")}createVideo(a){let b=window.document.createElement("source");
b.type=this.getVideoType(a);b.src=a;a=window.document.createElement("video");a.appendChild(b);"video/flash"!==b.type&&(a.crossOrigin="anonymous");return a}getVideoType(a){a=a.split(".");let b=a[a.length-1].split("?")[0].toLowerCase();return Qa.Zh.er.some((a)=>a===b)?"video/mp4":"video/flash"}getVideoElement(a){return $("#"+a+" .flowplayer video")[0]}removeVideoPlayer(a){var b=this.Ri[a];null!=b&&(delete this.Ri[a],b.unload());b=this.getVideoElement(a);null!=b&&(b.pause(0),b.src="",b.load(),$(b).remove());
this.removeElement(a)}sendPostMessageTo(a,b){let c=window.document.getElementById(b);null!=c.contentWindow?c.contentWindow.postMessage(a,"*"):this.logger.error({action:"send_message_to_not_iframe_element ",object:b,trigger:"machine"})}setElementClickable(a,b){window.document.getElementById(a).style.pointerEvents=b?"auto":"none"}};Qa.Zh.er=["mp4","m4v"];var U={};Object.defineProperty(U,"__esModule",{value:!0});U.mb=class{constructor(){this.ag=!1;this.version=0}getName(){let a=k.i.getComponentKey(this);
return null==a?"<< unnamed >>":a.getName()}getVersion(){return this.version}setVersion(a){this.version=a;null!=this.U&&this.U.componentChanged(this,this.isTracked)}incrementVersion(){this.setVersion(f.CetModel.getNextComponentVersion())}ignoreOnCommit(){return this.ag}dispose(){}setOnEntity(a,b){this.U=a;this.isTracked=b}createChildComponent(){throw Error("not implemented");}};var S={};Object.defineProperty(S,"__esModule",{value:!0});S.cb=class extends U.mb{constructor(a,b,c){super();this.Gg=a;this.dh=
b;this.kg=null!=c?c:[]}static lw(a){return new S.cb("PersistentGroupMember",a.getId(),null)}static jw(a){return new S.cb("PersistentGroup",null,a)}static kw(a){return new S.cb("PersistentGroupClickableMember",a.getId(),null)}createChildComponent(){let a=new S.cb(this.Gg,this.dh,this.kg.slice());a.version=this.version;return a}getGroupType(){return this.Gg}getParentId(){return this.dh}getChildIds(){let a=[];for(let b of this.kg)a.push(b);return a}withGroupType(a){return new S.cb(a,this.dh,this.kg)}withParentId(a){return new S.cb(this.Gg,
a,this.kg)}withChildIds(a){return new S.cb(this.Gg,this.dh,a)}};var xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.He=class extends U.mb{constructor(){super();this.alpha=1;this.enabled=!0}createChildComponent(){let a=new xa.He;a.alpha=this.alpha;a.enabled=this.enabled;a.version=this.version;return a}getAlpha(){return this.alpha}isVisible(){return this.enabled&&0<this.alpha}isEnabled(){return this.enabled}setEnabled(a){this.enabled!==a&&(this.enabled=a,this.incrementVersion());return this}setAlpha(a){this.alpha!==
a&&(this.alpha=a,this.incrementVersion());return this}};var l={};Object.defineProperty(l,"__esModule",{value:!0});l.f=class{static setFocusBehavior(a,b){a.setComponent(l.f.xe,b);return a}static setGroupingComp(a,b){a.setUntypedComponent(l.f.GROUPING,b);return a}static setGrouping(a,b,c,d){return l.f.setGroupingComp(a,new S.cb(b,c,d))}static setZOrderComp(a,b){a.setUntypedComponent(h.CetRendererModule.getZOrderComponentKey(),b);return a}static setFadingComp(a,b){a.setUntypedComponent(h.CetRendererModule.getFadingComponentKey(),
b);return a}static fading(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getFadingComponentKey(),b);return null!=a?a:null}static grouping(a,b=!1){a=a.getUntypedComponent(l.f.GROUPING,b);return null!=a?a:null}static zOrder(a){return h.CetRendererModule.zOrder(a)}static transform(a){return{getId:()=>a.getId(),getEntity:()=>a,getLocalToWorld:()=>h.CetRendererModule.getLocalToWorld(a),getWorldToLocal:()=>h.CetRendererModule.getLocalToWorld(a).invert(),toIPdom:()=>null}}static Zx(a){return l.f.world(a,
!1).getWorldBounds()}static Iy(a){return l.f.world(a).getWorldBoundingShape()}static hq(a){return l.f.world(a).getWorldAxisAlignedBounds()}static setVisibility(a,b,c=1){let d=l.f.updateVisibility(a);d.setEnabled(b);d.setAlpha(c);return a}static setWorldComp(a,b){a.setUntypedComponent(h.CetRendererModule.getWorldGeometryComponentKey(),b);return a}static world(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getWorldGeometryComponentKey(),b);return null!=a?a:null}static visibility(a,b=!1){a=a.getUntypedComponent(h.CetRendererModule.getVisibilityComponentKey(),
b);return null!=a?a:null}static updateVisibility(a){let b=a.getMutableComponent(h.CetRendererModule.getVisibilityComponentKey());null==b&&(b=new xa.He,a.setComponent(h.CetRendererModule.getVisibilityComponentKey(),b));return b}static commentVisibility(a){a=a.getUntypedComponent(h.CetRendererModule.getCommentVisibilityComponentKey());return null!=a?a:null}static updateCommentVisibility(a){let b=a.getMutableComponent(h.CetRendererModule.getCommentVisibilityComponentKey());null==b&&(b=new xa.He,a.setComponent(h.CetRendererModule.getCommentVisibilityComponentKey(),
b));return b}static getLocalBoundsComponent(a,b=!1){return h.CetRendererModule.getLocalBoundsComponent(a,b)}static getMutableLocalBoundsComponent(a){return h.CetRendererModule.getMutableLocalBoundsComponent(a)}static setLocalBounds(a,b,c){h.CetRendererModule.setLocalBounds(a,b,c);return a}};l.f.Pk=f.CetModel.createValueComponentKey("clip_aspect_ratio",!1,!1);l.f.Yh=f.CetModel.createValueComponentKey("decorator",!1,!1);l.f.xe=f.CetModel.createComponentKey("focus",!0,!1);l.f.GROUPING=f.CetModel.createComponentKey("grouping",
!1,!1);l.f.dr=f.CetModel.createValueComponentKey("hittest-disabled",!1,!1,!1);l.f.INIT=f.CetModel.createComponentKey("init",!1,!1);l.f.MODEL=f.CetModel.MODEL();l.f.PENDING_INSERT=f.CetModel.PENDING_INSERT();l.f.jy=f.CetModel.createValueComponentKey("placeholderText",!1,!1);l.f.De=f.CetModel.createComponentKey("session",!1,!1);l.f.Aa=f.CetModel.createComponentKey("shapedtext",!1,!0);l.f.ks=f.CetModel.createValueComponentKey("temporary-hittest-disabled",!1,!1,!1);l.f.sl=f.CetModel.createValueComponentKey("text_caret_offset",
!1,!0);l.f.Vf=f.CetModel.createValueComponentKey("text-range",!1,!0);l.f.VIDEO=f.CetModel.createComponentKey("video",!0,!1);var Db={};Object.defineProperty(Db,"__esModule",{value:!0});Db.Xq=class{constructor(a){this.zm=p.Bacon.newBus();this.camera=a}lc(){null!=this.Bc&&null==this.j.getEntityById(this.Bc.getId())&&(this.Bc=null);return this.Bc}Ik(){this.lc()}setScene(a){this.j=a}yh(a){if(this.Bc!==a){if(null!=this.Bc){var b=this.Bc.getComponent(l.f.xe);if(null!=b)b.onLostFocus()}if(null!=a&&(b=a.getComponent(l.f.xe),
null!=b))b.onFocus();this.Bc=a;this.camera.Xw(null==a?null:a.getId());this.zm.push(this.Bc)}}};var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.$h=class{constructor(a,b){this.id=a;this.Lp=this.duration=0;this.Bl=!1;this.km=!0;this.mc=0;this.Te=!1;this.delayBeforeRecurring=0;this.fq=!1;this.duration=b;this.ease=(new ba.uc).createLinear()}getId(){return this.id}getDuration(){return this.duration}getStartDelay(){return this.Lp}setStartDelay(a){this.Lp=a}getStartUpdate(){return this.ux}setStartUpdate(a){this.ux=
a}getEndUpdate(){return this.gu}setEndUpdate(a){this.gu=a}getEase(){return this.ease}setEase(a){this.ease=a}shouldFillBeforeStart(){return this.Bl}setFillBeforeStart(a){this.Bl=a}setUseUserStartTime(a){this.fq=a}shouldUseUserStartTime(){return this.fq}setDisableHittest(a){this.km=a}shouldDisableHittest(){return this.km&&0!==this.duration}setRecurring(a,b,c=Infinity){this.mc=c;this.Te=a;this.delayBeforeRecurring=b}isRecurring(){return 0<this.mc}getNumberOfRecurrings(){return this.mc}flipBeforeRecurring(){return this.Te}getDelayBeforeRecurring(){return this.delayBeforeRecurring}getPropertyNames(){throw Error("Not implemented");
}getStartValues(){throw Error("Not implemented");}getEndValues(){throw Error("Not implemented");}getOnCurrentValues(){throw Error("Not implemented");}getTweenedComponents(){throw Error("Not implemented");}cleanupTweenedComponents(a){if(null!=a)for(let b of this.getTweenedComponents())a.discardOwnComponent(b)}getTweenedComponentsVersion(a){let b=0;this.getTweenedComponents().map((c)=>{b+=a.getUntypedComponent(c).getVersion()});return b}};var Eb={};Object.defineProperty(Eb,"__esModule",{value:!0});
Eb.oq=class extends Ra.$h{constructor(a,b,c,d,g){super(a,b);this.sx=c;this.fu=d;this.ua=g}getPropertyNames(){return["alpha"]}getStartValues(){return[this.sx]}getEndValues(){return[this.fu]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);null!=d&&(null!=this.ua?d.set(this.ua,{isEnabled:!0,alpha:c("alpha")}):k.i.updateVisibility(d).setAlpha(c("alpha")))}}getTweenedComponents(){return null!=this.ua?[this.ua]:[h.CetRendererModule.getVisibilityComponentKey()]}};var Fb={};Object.defineProperty(Fb,
"__esModule",{value:!0});Fb.ls=class extends Ra.$h{constructor(a,b,c,d){super(a,b);this.vx=c;this.hu=d;this.ease=(new ba.uc).createLinear()}getPropertyNames(){return["wrapWidth"]}getStartValues(){return[this.vx]}getEndValues(){return[this.hu]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);if(null!=d){let a=k.i.shapedText(d);a=a.setWrapWidth(c("wrapWidth"));k.i.setText(d,a)}}}getTweenedComponents(){return[l.f.Aa]}};var Gb={};Object.defineProperty(Gb,"__esModule",{value:!0});Gb.ps=class extends Ra.$h{constructor(a,
b,c,d,g){super(a,b);this.Fh=c;this.rg=d;this.Wm=g;this.ease=(new ba.uc).createLinear()}getPropertyNames(){return["x","y","scale","rotation"]}getStartValues(){return[this.Fh.getTranslation().x,this.Fh.getTranslation().y,this.Fh.getScale(),this.Fh.getRotationRad()]}getEndValues(){return[this.rg.getTranslation().x,this.rg.getTranslation().y,this.rg.getScale(),this.rg.getRotationRad()]}getOnCurrentValues(a,b){return(c)=>{let d=a.getEntityById(b);null!=d&&(c=v.Geometry.transform2dFromRad({x:c("x"),y:c("y")},
c("scale"),c("rotation")),c=null!=this.Wm?c.concat(this.Wm()):c,k.i.updateTransform(d).setLocalToWorld(c))}}getTweenedComponents(){return[f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD]}cleanupTweenedComponents(a){k.i.cleanupTransformation(a)}getTweenedComponentsVersion(a){return k.i.Su(a)}};var qa={};Object.defineProperty(qa,"__esModule",{value:!0});qa.Hd=class{constructor(a,b){this.name=a;this.$t=b}getName(){return this.name}ease(a,b,c,d){return this.$t(a,b,c,d)}};var ba={};Object.defineProperty(ba,"__esModule",
{value:!0});ba.uc=class{constructor(){}createTransformTween(a,b,c,d,g){return new Gb.ps(a,b,c,d,g)}createAlphaTween(a,b,c,d,g){return new Eb.oq(a,b,c,d,g)}createTextWrapWidthTween(a,b,c,d){return new Fb.ls(a,b,c,d)}createLinear(){return new qa.Hd("linear",(a,b,c,d)=>b+a/d*c)}createQuadInOut(){return new qa.Hd("quadInOut",(a,b,c,d)=>{a/=d/2;if(1>a)return c/2*a*a+b;a--;return-c/2*(a*(a-2)-1)+b})}createElasticOut(a,b){return new qa.Hd("elasticOut",(c,d,g,e)=>{if(0===c)return d;if(1===(c/=e))return d+
g;if(null==b||0===b)b=.3*e;let f;a<Math.abs(g)?(a=g,f=b/4):f=b/(2*Math.PI)*Math.asin(g/a);return a*Math.pow(2,-10*c)*Math.sin(2*(c*e-f)*Math.PI/b)+g+d})}createCubicOut(){return new qa.Hd("cubicOut",(a,b,c,d)=>{a/=d;a--;return c*(a*a*a+1)+b})}createQuintOut(){return new qa.Hd("quintOut",(a,b,c,d)=>{a/=d;a--;return c*(a*a*a*a*a+1)+b})}createExpOut(a,b){return new qa.Hd("expOut",(c,d,g,e)=>g*(-Math.pow(a,b*c/e)+1)+d)}};var ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.Ge=class{constructor(a,
b,c,d,g,e,f,Ia){this.id=a;this.startTime=b;this.Dc=c;this.Af=d;this.interval=g;this.Dx=e;this.Hj=f;this.ease=Ia;this.vb=()=>{};this.onEnd=()=>{};this.Vn=()=>!1;null==Ia&&(this.ease=(new ba.uc).createLinear());ya.Ge.Yc=Math.pow(2,-40);this.mc=0;this.Te=!1;this.pf=this.delayBeforeRecurring=0}getId(){return this.id}Rs(a){this.startTime=a}dx(a,b,c=Infinity){this.mc=c;this.Te=a;this.delayBeforeRecurring=b;this.pf=0<this.mc?this.mc-1:0}step(a){if(a<this.startTime)return this.pi(this.Dc),this.Dc;if(this.startTime+
this.interval>a){var b={};for(let d in this.Dc)if(this.Dc.hasOwnProperty(d)){var c=this.Dc[d];let g=this.Af[d];c=Math.abs(g-c)<ya.Ge.Yc?g:this.ease.ease(a-this.startTime,c,g-c,this.interval);b[d]=c}this.pi(b);return b}this.pi(this.Af);0<this.pf&&(this.pf--,this.Te&&(b=this.Af,this.Af=this.Dc,this.Dc=b),this.startTime=a+this.delayBeforeRecurring);return this.Af}pi(a){this.Ds=a;this.Hj(a)}Qn(a){return 0===this.pf&&this.startTime+this.interval<=a}sj(a){return a>=this.startTime}Wi(){return this.startTime+
this.interval}af(a){return-1!==this.Dx.indexOf(a)}Gw(a){this.Dc=a;this.startTime=Date.now();this.pf=0<this.mc?this.mc-1:0}};var la={};Object.defineProperty(la,"__esModule",{value:!0});la.bd=class{constructor(){this.Ze=x.Utils.createLinkedList();this.od=!1}ju(a,b){this.fadeIn((b)=>{a.set(e.Cet.getPathVisibilityKey(),{isEnabled:!0,alpha:b})},280,b)}fadeIn(a,b,c){this.fade(a,la.bd.$k,la.bd.Zk,b,c)}lu(a,b){this.fadeOut((b)=>{a.set(e.Cet.getPathVisibilityKey(),{isEnabled:!0,alpha:b})},280,b)}fadeOut(a,
b,c){this.fade(a,la.bd.Zk,la.bd.$k,b,c)}fade(a,b,c,d,g){a(b);b=new ya.Ge(String(x.Utils.nextSerialId()),(new Date).getTime(),{alpha:b},{alpha:c},d,[],(b)=>{a(b.alpha)});null!=g&&(b.onEnd=g);this.Ze.add(b)}Ek(a){this.Ze.add(a)}Zi(a,b){let c=Number.POSITIVE_INFINITY;for(let d of a)d.sj(b)?c=0:(a=d.startTime-b,a<c&&(c=a));return c}getNextFrameTime(){var a=(new Date).getTime();a=this.Zi(this.Ze,a);return this.od?0:a===Number.POSITIVE_INFINITY?-1:a}needsFrameImmediately(){return 0===this.getNextFrameTime()}update(){let a=
x.Utils.createLinkedList(),b=(new Date).getTime();this.od=!1;for(let c of this.Ze)c.step(b),c.Qn(b)&&a.add(c);for(let b of a){if(null!=b.onEnd)b.onEnd();this.Ze.remove(b)}}af(a,b){if(null==a)return!0;for(let c of a)if(b.af(c))return!0;return!1}};la.bd.$k=0;la.bd.Zk=1;var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0});Hb.Qr=class{constructor(a,b){this.path=a;this.j=b}isFirst(a){return null!=a&&0===a.getStep()&&0===a.getAction()}isLast(a){return null!=a&&this.hasStep(a.getStep())&&a.getStep()===
this.path.getStepCount()-1&&a.getAction()===this.path.getActionCount(a.getStep())}has(a){return null!=a&&this.hasAction(a.getStep(),a.getAction())}hasStep(a){return 0<=a&&a<this.path.getStepCount()}hasAction(a,b){return this.hasStep(a)&&0<=b&&b<=this.path.getActionCount(a)}check(a){if(null==a)throw Error("Position was null");this.checkAction(a.getStep(),a.getAction())}checkStep(a){if(!this.hasStep(a))throw Error("Invalid step "+a+", step should be between [0,"+this.path.getStepCount()+")");}checkAction(a,
b){this.checkStep(a);if(!this.hasAction(a,b))throw Error("Invalid action "+b+" in step "+a+", action should be between [0,"+(this.path.getActionCount(a)+1)+")");}getFirst(){return 0===this.path.getStepCount()?null:this.path.getPathPosition(0,0)}getLast(){if(0===this.path.getStepCount())return null;let a=this.path.getStepCount()-1,b=0===this.path.getActionCount(a)?0:this.path.getActionCount(a)-1;return this.path.getPathPosition(a,b)}Lg(a){const b=k.i.pathKludge.getISomeEditorPathStepW(this.j.getEntityById(this.path.getPathStepEntityId(a)));
if(null==b)return!1;a=b.getActions().getAt(a.getAction());return null==a?!1:a.is(f.CetModel.ID.FADE_IN_OBJECT_EP)||a.is(f.CetModel.ID.FADE_OUT_OBJECT_EP)||a.is(f.CetModel.ID.FADE_IN_OBJECTS_EP)||a.is(f.CetModel.ID.FADE_OUT_OBJECTS_EP)}offset(a,b,c=!1){if(0===b)return a;if(1>b){if(0<a.getAction())return a=this.path.getPathPosition(a.getStep(),a.getAction()-1),b=c&&this.Lg(a)?b:b+1,this.offset(a,b,c);if(0===a.getStep())return this.path.getPathPosition(0,0);a=a.getStep()-1;var d=this.path.getActionCount(a);
a=this.path.getPathPosition(a,0===d?0:d);return this.offset(a,b+1,c)}d=this.path.getActionCount(a.getStep());if(0<d&&a.getAction()<d)return d=this.path.getPathPosition(a.getStep(),a.getAction()+1),b=c&&this.Lg(a)?b:b-1,this.offset(d,b,c);if(this.path.getStepCount()-1===a.getStep())return a;a=this.path.getPathPosition(a.getStep()+1,0);return this.offset(a,b-1,c)}canMoveBack(a,b){if(1>this.path.getStepCount()||!a)return!1;const c=a.getStep();a=a.getAction();if(0<c)return!0;if(0===a)return!1;if(!b)return!0;
for(b=0;b<a;b++)if(!this.Lg(this.path.getPathPosition(c,b)))return!0;return!1}canMoveForward(a,b){if(1>this.path.getStepCount()||!a)return!1;const c=a.getStep(),d=a.getAction();if(c<this.path.getStepCount()-1)return!0;a=this.path.getActionCount(c);if(d===a)return!1;if(!b)return!0;for(b=d;b<a;b++)if(!this.Lg(this.path.getPathPosition(c,b)))return!0;return!1}};var za={};Object.defineProperty(za,"__esModule",{value:!0});za.Be=class{constructor(a,b){this.step=a;this.action=b}getStep(){return this.step}getAction(){return this.action}compareTo(a){return null==
a?1:0===this.step-a.step?this.action-a.action:this.step-a.step}isBefore(a){return 0>this.compareTo(a)}isAfter(a){return 0<this.compareTo(a)}isSame(a){return null==a?!1:this.step===a.step&&this.action===a.action}isSameStep(a){return null==a?!1:this.step===a.step}toString(){return"("+this.step+","+this.action+")"}};var ma={};Object.defineProperty(ma,"__esModule",{value:!0});ma.jl=class{constructor(a){this.j=a;this.Mj=new Hb.Qr(this,a)}getPathPosition(a,b){return new za.Be(a,b)}Sm(a){let b=0;for(const c of this.getSteps().items()){a(this.getPathPosition(b,
0),c,null);let d=1;const g=this.Td(this.j.getEntityById(c)).getActions();for(const e of g)a(this.getPathPosition(b,d++),c,e.getId());b++}}getAllPathPositions(){let a=[];this.Sm((b)=>a.push(b));return a}getStepCount(){return this.getSteps().length()}getActionCount(a){this.Mj.checkStep(a);a=this.getSteps().getAt(a);return null==a?0:this.Td(this.j.getEntityById(a)).getActions().length()}getPathStepEntityId(a){return this.pn(a.getStep())}pn(a){return this.getSteps().getAt(a)}getTargetForStep(a){if(!this.Mj.hasStep(a))return null;
a=this.pn(a);a=this.j.getEntityById(a);return a.isDef(f.CetModel.ID.HAS_TARGET)?a.get(f.CetModel.ID.HAS_TARGET.TARGET):this.j.getPreziW().getOverview().getId()}getTargetForPathPosition(a){let b=a.getAction()-1;var c=this.getSteps().getAt(a.getStep());for(c=this.Td(this.j.getEntityById(c));0<=b;b--){const a=c.getActions().getAt(b);if(this.Sn(a))return a.getTarget();if(this.Tn(a))break}return this.getTargetForStep(a.getStep())}getPathCalculator(){return this.Mj}getSteps(){return this.Eg()}getClosestValidPathPosition(a,
b=null){const c=this.Eg();if(b){let d=Infinity,g=-1;for(let e=0;e<c.length();e++)if(this.getTargetForStep(e)===b){const b=Math.abs(e-a.getStep());b<d&&(d=b,g=e)}if(0<=g)return this.getPathPosition(g,0)}if(a.getStep()>c.length()-1)return this.getPathPosition(Math.max(c.length()-1,0),0);b=c.getAt(a.getStep());b=this.Td(this.j.getEntityById(b));return null!=b&&(b=b.getActions(),a.getAction()>b.length())?this.getPathPosition(a.getStep(),b.length()):a}getStartPoint(){const a=this.dn();return null!=a?a:
this.getPathPosition(0,0)}hasCustomStartPoint(){return null!=this.dn()}getPathPositionOfStepOrAction(a){let b=null;this.Sm((c,d,g)=>{if(d===a||g===a)b=c});return b}dn(){const a=this.Eg().items();for(let c=0;c<a.length;c++){var b=this.j.getEntityById(a[c]);b=this.Td(b);if(null!=b.getStartPointToken())return this.getPathPosition(c,0);b=b.getActions();for(let a=0;a<b.length();a++)if(null!=b.getAt(a).getStartPointToken())return this.getPathPosition(c,a+1)}return null}};ma.Mq=class extends ma.jl{Eg(){return k.i.pathKludge.getEditorPathComponent(this.j)}Td(a){return a.getWrapper(f.CetModel.ID.EDITOR_PATH_STEP.W)}Sn(a){return a.is(f.CetModel.ID.ZOOM_TO_OBJECT_EP)}Tn(a){return a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW_EP)}};
ma.ml=class extends ma.jl{Eg(){return this.j.getPreziW().getEntity().getComponent(f.CetModel.ID.PREZI.PATH)}Td(a){return a.getWrapper(f.CetModel.ID.PATH_STEP.W)}Sn(a){return a.is(f.CetModel.ID.ZOOM_TO_OBJECT)}Tn(a){return a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW)}getSoundForPathPosition(a){var b=this.getSteps().getAt(a.getStep());b=this.j.getEntityById(b);if(null==b)return[];b=b.getWrapper(f.CetModel.ID.PATH_STEP.W);b=0===a.getAction()?b.getPathSounds():b.getActions().getAt(a.getAction()-1).getPathSounds();
const c=(a,b)=>{const c=this.getAllPathPositions();let d;for(let b=0;b<c.length;b++)if(c[b].isSame(a)){d=b;break}return c[d+b.getPathLength()]},d=[];null!=b&&b.forEach((b)=>{d.push({audioBuffer:b.getEntity().get(k.i.Xm()),loop:b.getLoop(),startPosition:a,endPosition:c(a,b)})});return d}getPathStepPositionsForNavigation(){return this.getAllPathPositions().filter((a)=>{if(0===a.action)return!0;const b=this.getPathStepEntityId(a);a=this.j.lookup(b,f.CetModel.ID.PATH_STEP.W).getActions().getAt(a.action-
1);return a.is(f.CetModel.ID.ZOOM_TO_OBJECT)||a.is(f.CetModel.ID.ZOOM_TO_OVERVIEW)})}getPathStepPositionsWithAudio(){return this.getAllPathPositions().filter((a)=>0<this.getAllPathSoundsForPathPosition(a).length)}getAllPathSoundsForPathPosition(a){let b=[];const c=this.getAllPathPositions().filter((b)=>b.isBefore(a)).filter((a)=>null!==this.getSoundForPathPosition(a)).map((a)=>this.getSoundForPathPosition(a));for(let d=0;d<c.length;d++)if(0<c[d].length)for(let g=0;g<c[d].length;g++)(null==c[d][g].endPosition||
c[d][g].endPosition.isAfter(a))&&b.push(c[d][g]);b.push(...this.getSoundForPathPosition(a));return b}};var Ib={};Object.defineProperty(Ib,"__esModule",{value:!0});Ib.Rr=class{constructor(a,b,c,d,g,e,f,Ia){this.intent=a;this.getPath=b;this.Nv=Ia;this.Si=c;this.Ak=g;this.Ib=d;this.Bk=e;this.yj=f}getIntent(){return this.intent}getFromPos(){return this.Si}getFromTargetId(){return this.Ib}getToPos(){return this.Ak}getToTargetId(){return this.Bk}getNavigationMode(){return this.yj}getNavOptions(){return this.Nv}toString(){return"PathNavigationEvent: @"+
(null==this.Si?"()":this.Si.toString())+" #"+(null==this.Ib?"":this.Ib)+" ->  @"+(null==this.Ak?"()":this.Ak.toString())+" #"+(null==this.Bk?"":this.Bk)+"; mode: "+(null==this.yj?"":e.NavigationMode[this.yj])}};var eb={};Object.defineProperty(eb,"__esModule",{value:!0});eb.ll=class{constructor(a,b,c,d){this.lf=a;this.jv=b;this.mf=c;this.kv=d;this.gf=!0}setDirection(a,b){if(null!=a&&a.isSame(this.mf)||null!=b&&b===this.kv)this.gf=!0;else if(null!=a&&a.isSame(this.lf)||null!=b&&b===this.jv)this.gf=
!1;else throw Error("invalid direction");}wv(){return null!=this.lf&&null!=this.mf&&this.lf.isBefore(this.mf)}};var Jb={};Object.defineProperty(Jb,"__esModule",{value:!0});Jb.Tr=class{constructor(a){this.Wg=a;this.hj=!1;this.Oo=p.Bacon.newBus()}getCurrentPosition(){return this.yc}getPendingNavigationTargetPosition(){const a=this.yb;return null!=a?a.gf?a.mf:a.lf:null}initWithPosition(a){this.Wg.reset();let b=null==this.getCurrentPosition()||a.isSame(this.getCurrentPosition())?new za.Be(-1,-1):this.getCurrentPosition();
this.Ib=this.getPath().getTargetForStep(a.getStep());this.yb=new eb.ll(b,this.Ib,a,this.Ib);this.jump(a);this.uf(a)}getPathNavigationStream(){return this.Oo}getPath(){return this.path}setScene(a){this.j=a;this.path=new ma.ml(a);this.yb=null}getNavigationStrategy(){return this.Wg}setNavigationStrategy(a){this.Wg=a}setAsyncCallback(a){if(this.hj)throw Error("PathNavigator is already in async mode");this.hj=!0;a.onValue((a)=>{this.uf(a.getToPos());this.Ib=a.getToTargetId();this.yb=null})}isMoving(){return null!=
this.yb}getCurrentTargetId(){return this.Ib}go(a,b){const c=null!=b?e.NavigationMode.NEW_TRANSITION:null;return this.md(new za.Be(a.step,a.action),null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET,c,b)}jump(a){return this.md(a,null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET,e.NavigationMode.JUMP)}see(a){this.md(null,a,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET);return!0}next(a){return this.yn(e.NavigationIntent.next,a)}prev(a){return this.yn(e.NavigationIntent.prev,
a)}resume(a){let b=this.getCurrentPosition();if(null!=this.j&&null!=a&&null!=b&&a.getStep()===b.getStep()){var c=this.j.getEntityById(this.getPath().getPathStepEntityId(b)),d=c.getWrapper(f.CetModel.ID.PATH_STEP.W).getActions();a=d.getAt(b.getAction());d=d.getAt(b.getAction()-1);if(null==a||null==d)return null;c=c.getWrapper(f.CetModel.ID.FLY_TO_OBJECT.W);a.is(f.CetModel.ID.ZOOM_TO_OBJECT)&&d.is(f.CetModel.ID.ZOOM_TO_OBJECT)&&a.getTarget()===c.getTarget()&&this.uf(new za.Be(b.getStep(),b.getAction()+
1));return this.getCurrentPosition()}return this.md(null!=a?a:this.getCurrentPosition(),null,e.NavigationIntent.goto,e.NavigationChange.NEW_TARGET)}yn(a,b){return null==this.yb?(b=null==this.getCurrentPosition()?this.getPath().getPathCalculator().getFirst():this.getPath().getPathCalculator().offset(this.getCurrentPosition(),a===e.NavigationIntent.next?1:-1,b),this.md(b,null,a,e.NavigationChange.NEW_TARGET)):a===e.NavigationIntent.next===this.yb.wv()?this.md(this.yb.mf,null,a,this.yb.gf?e.NavigationChange.CONTINUE:
e.NavigationChange.TURN_BACK):this.md(this.yb.lf,null,a,this.yb.gf?e.NavigationChange.TURN_BACK:e.NavigationChange.CONTINUE)}md(a,b,c,d,g,e){if(null!=a){if(!this.getPath().getPathCalculator().has(a))return null;b=this.getPath().getTargetForStep(a.getStep())}let f=this.getCurrentPosition(),q=this.Ib;this.setTarget(a,b,d);d=null!=g?g:this.Wg.getNavigationMode(d);this.Oo.push(new Ib.Rr(c,()=>this.getPath(),f,q,a,b,d,e));return a}uf(a){this.yc=a;this.j.requestNoDomBatchUpdate((b)=>{b.getPrezi().set(k.i.getCurrentPathPositionKey(),
a)})}seekTo(a){this.uf(a)}setTarget(a,b,c){this.hj?c===e.NavigationChange.NEW_TARGET?this.yb=new eb.ll(this.getCurrentPosition(),this.Ib,a,b):this.yb.setDirection(a,b):(this.uf(a),this.Ib=b)}};var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.Ar=class{constructor(a){this.Ih=a;this.gh={};this.Lk={};this.Ih=a;this.Ih.beforeSync((a)=>this.Ps(a))}addOfflineOnlinePatch(a){this.Lk[a.oldOnlineAssetUrl]=a;this.Ih.requestSync()}Ps(a){if(0!==Object.keys(this.gh).length||0!==Object.keys(this.Lk).length)for(const b of m.DOM.collectMediaAsset(a)){for(;;){a=
b.getOfflineAssetId();a=this.gh[a];if(null==a)break;b.updateOfflineAssetId(a.Do);null!=a.No&&a.No(b)}a=b.getOnlineAssetUrl();a=this.Lk[a];null!=a&&(b.updateOnlineAssetId(a.newOnlineAssetId),b.updateOnlineAssetUrl(a.newOnlineAssetUrl))}}setNewAssetId(a){const b=this.createId();a.setOfflineAssetId(b);return b}createId(){return Math.random().toString(16)}addPatch(a,b){this.si(a,this.createId(),b,!0)}addPatchFromTransaction(a,b){this.si(a,this.createId(),b,!1)}addError(a,b){this.si(a,e.Cet.errorOfflineAssetId,
b,!0)}si(a,b,c,d){null==a||""===a?e.Cet.getEditorApiLogger().mediaPatcherAssetIdMissing():(a=this.getRecentAssetId(a),a===e.Cet.errorOfflineAssetId?e.Cet.getEditorApiLogger().mediaPatcherPatchingError():(this.gh[a]={Cy:a,Do:b,No:c},d&&this.Ih.requestSync()))}getRecentAssetId(a){for(;;){const b=this.gh[a];if(null==b)break;a=b.Do}return a}};var Lb={};Object.defineProperty(Lb,"__esModule",{value:!0});Lb.gr=class{constructor(a){this.name=a;this.reset()}reset(){this.Rc={Bb:[]};this.xc=[{Bb:[]}];this.Qb=
0;this.log("HistoryList reset")}isUndoable(){return 0<this.Rc.Bb.length||0<this.Qb}isRedoable(){return this.Qb<this.xc.length-1}undo(){if(!this.isUndoable())return!1;0<this.Rc.Bb.length&&this.push();const a=this.xc[this.Qb];this.log("HistoryList undo",a);for(let b=a.Bb.length-1;0<=b;b--)a.Bb[b].undo();this.Qb--;return!0}redo(){if(!this.isRedoable())return!1;this.Qb++;const a=this.xc[this.Qb];this.log("HistoryList redo",a);for(let b=0;b<a.Bb.length;b++)a.Bb[b].redo();return!0}rx(a){this.isRedoable()&&
(this.xc=this.xc.slice(0,this.Qb+1),this.Rc={Bb:[]});this.Rc.Bb.push(a)}push(){if(0!==this.Rc.Bb.length){if(this.isRedoable())throw Error("assert failed: history list is in invalid state");this.log("HistoryList push",this.Rc.Bb.map((a)=>a.message).join("; "));this.xc.push(this.Rc);this.Rc={Bb:[]};this.Qb++}}log(){}tsto(){let a="",b=0;for(;b<this.xc.length;)a+=" ",b===this.Qb&&(a+="("),a+=this.xc[b],b===this.Qb&&(a+=")"),a+=" ",b++;return a}};var fb={};Object.defineProperty(fb,"__esModule",{value:!0});
fb.ol=class extends U.mb{constructor(a){super();this.Dh=[];this.logger=t.LoggerModule.getLoggerManager().createLogger("SessionComponent");this.pa=a;this.Pb=p.Bacon.newBus();this.Wb=new Lb.gr("historylist");this.pa.Nj.merge(this.pa.getNetworkEventStream().filter((a)=>a.type===e.CetNetworkEventType.ResetUndoRedo).map(()=>!0)).onValue(()=>this.Wb.reset())}createChildComponent(){let a=new fb.ol(this.pa);a.Wb=this.Wb;a.Pb=this.Pb;a.version=this.version;a.Dh=this.Dh;return a}getSession(){return this.pa.ja}rf(){this.discardEvents();
this.pa.rf();this.Pb.push(e.EditKind.Local)}ik(a,b,c){this.discardEvents();return this.pa.ik(a,b,c).then((a)=>{this.Pb.push(e.EditKind.Local);return a})}Xl(a){if(!this.hasAnyUncommitedChange())return!1;this.Wb.rx({message:a.message,undo:()=>{this.getSession().undo();try{a.snapshotBefore.reset()}catch(b){t.LoggerModule.logException(this.logger,"commitChanges","snapshotBefore.reset",b)}},redo:()=>{this.getSession().redo();try{a.snapshotAfter.reset()}catch(b){t.LoggerModule.logException(this.logger,
"commitChanges","snapshotAfter.reset",b)}}});this.getSession().commit();this.Pb.push(e.EditKind.Local);return!0}isUndoable(){return this.Wb.isUndoable()}undo(){if(!this.Wb.undo())return!1;this.Pb.push(e.EditKind.Local);return!0}isRedoable(){return this.Wb.isRedoable()}redo(){if(!this.Wb.redo())return!1;this.Pb.push(e.EditKind.Local);return!0}discardEvents(){this.getSession().discardEvents()}sync(){this.Wb.push();let a=this.pa.sync();a.wasHardReseted&&this.Wb.reset();const b=a.ap||a.wasHardReseted||
a.wasAcknowledgeRequested&&a.Pj;!a.wasAcknowledgeRequested&&a.Pj&&this.Pb.push(e.EditKind.Local);b&&this.Pb.push(e.EditKind.Remote)}hasAnyUncommitedChange(){return this.getSession().hasAnyUncommitedChange()}getCetSessionEditStream(){return this.Pb}generateObjectId(){return this.getSession().generateObjectId()}useTestIdGenerator(a){this.getSession().setIdGenerator(k.i.createTestIdGenerator(a))}regenerateIDs(a){return m.DOM.regenerateIDsSeeded(a,this.getSession().getIdGenerator())}registerSnapshotCreator(a){this.Dh.push(a)}createSnapshot(){const a=
[];for(let b of this.Dh)try{a.push(b.createSnapshot().reset)}catch(c){t.LoggerModule.logException(this.logger,"createSnapshot","createSnapshot",c)}return{reset:()=>{for(let b of a)try{b()}catch(c){t.LoggerModule.logException(this.logger,"createSnapshot","callback",c)}}}}};var Mb={};Object.defineProperty(Mb,"__esModule",{value:!0});Mb.rr=class{constructor(a,b,c){this.cf=!1;this.name=a;this.keys=b;this.Rw=c;this.cf=-1!==b.indexOf(f.CetModel.getRemovedEntityCompKey())}getName(){return this.name}select(a){return this.Rw(a)}getTriggerKeys(){return this.keys}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return this.cf}};
var Nb={};Object.defineProperty(Nb,"__esModule",{value:!0});Nb.Kq=class{static hv(a){var b=["trackedCompMarker"];if(null==a)return!1;for(let c of b)if(null==a[c])return!1;return!0}};var Sa={};Object.defineProperty(Sa,"__esModule",{value:!0});Sa.ji=class extends U.mb{trackedCompMarker(){}};var ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.Jd=class extends U.mb{constructor(a){super();this.t=a}createChildComponent(){let a=new ra.Jd;a.t=this.t;a.version=this.version;return a}setValue(a,b=
!1,c=!1){if(b||!this.equalsValue(a))this.t=a,this.incrementVersion();this.ag=c}static Cm(a,b){return null==a||null==b?a===b:null!=a.equalsWithin?a.equalsWithin(b,Math.pow(2,-40)):null!=a.equals?a.equals(b):a===b}equalsValue(a){return ra.Jd.Cm(this.t,a)}equalsValueIncludingPdomInternal(a){return ra.Jd.Bm(this.t,a)}static Bm(a,b){return null==a||null==b?a===b:null!=a.equalsWithin?a.equalsWithin(b,Math.pow(2,-40)):null!=a.equals?a.equals(b):null!=a.compare?a.compare(b):a===b}getValue(){return this.t}};
var gb={};Object.defineProperty(gb,"__esModule",{value:!0});gb.tl=class extends Sa.ji{createChildComponent(){let a=new gb.tl;a.t=this.t;a.version=this.version;return a}setValue(a,b=!1,c=!1){if(b||!this.equalsValue(a))this.t=a,this.incrementVersion();this.ag=c}equalsValue(a){return ra.Jd.Cm(this.t,a)}equalsValueIncludingPdomInternal(a){return ra.Jd.Bm(this.t,a)}getValue(){return this.t}};var sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.Fd=class extends Sa.ji{constructor(a){super();this.qa=
null==a?f.CetModel.createUpdateableVArray():a.qa.createChildArray();this.qa.__COMPONENT__=this}items(){return this.qa.items()}get(a){return this.getAt(a)}getMaybePDOMId(){return null}createChildComponent(){let a=new sa.Fd(this);a.version=this.version;return a}iterator(){let a=0;return{hasNext:()=>a<this.qa.length(),next:()=>this.qa.get(a++)}}[Symbol.iterator](){return this.qa.items()[Symbol.iterator]()}forEach(a){for(let b=0,c=this.length();b<c;b++)a(this.getAt(b))}getAt(a){return this.qa.get(a)}isEmpty(){return 0===
this.qa.length()}insert(a,b){this.insert_Internal(a,b);this.qh(a,b,!1,null,null,!1)}insert_Internal(a,b){this.qa.insert(a,b);this.incrementVersion()}move(a,b){this.qa.move(a,b);this.incrementVersion()}length(){return this.qa.length()}add(a){this.insert(this.qa.length(),a);this.incrementVersion()}removeAt(a){let b=this.getAt(a);this.removeAt_Internal(a);this.rh(a,b,!1)}removeAt_Internal(a){this.qa.removeAt(a);this.incrementVersion()}getDiff(){return this.qa.getDiff()}setCurrentVersionAsOrigin_Internal(){this.qa.setCurrentVersionAsOrigin()}resetToOrigin(){this.qa.resetToOrigin()&&
this.incrementVersion()}isInherited(){return!0}rh(){}qh(){}resolveAfterPdomEventHandling(a,b,c){if(null!=this.U.getEntityList())for(let d of this.getDiff())switch(d.getKind()){case f.ObservableArrayEventKind.Insert:this.qh(d.getPos(),d.getItem(),a,b,c,!0);break;case f.ObservableArrayEventKind.Remove:this.rh(d.getPos(),d.getItem(),!0);break;default:throw Error(`Unsupported event kind '${f.ObservableArrayEventKind[d.getKind()]}'`);}this.setCurrentVersionAsOrigin_Internal()}dispose(){this.qa.resetOnDispose()}};
var Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});Ja.Sf=class extends sa.Fd{constructor(a,b){super(a);this.xb=b}createChildComponent(){let a=new Ja.Sf(this,this.xb);a.version=this.version;return a}qh(a,b,c,d,g){if(Aa.ze.Am(this.U)&&null!=b){a=(null!=d?d.getEntityList():this.U.getEntityList()).getEntityById(b);null==a&&null!=g&&(a=g.find((a)=>a.getId()===b));if(null==a){if(c)return;throw Error("cannot resolve reference to "+b);}c=a.getComponent(this.xb);g=null!=c?c.getValue():null;null==
g?a.set(this.xb,[this.U.getId()]):(-1===g.indexOf(this.U.getId())&&g.push(this.U.getId()),c.incrementVersion())}}rh(a,b){if(Ja.Sf.Dp(this.U,this,b)){a=this.U.getEntityList().getEntityById(b);b=a.getComponent(this.xb);var c=null!=b?b.getValue():null;if(null!=c){let d=c.indexOf(this.U.getId());0<=d&&(c.splice(d,1),0===c.length&&a.set(this.xb,null),b.incrementVersion())}}}static Am(a){return null!=a&&null!=a.getEntityList()&&a.getEntityList().getEntityById(a.getId())===a}static Dp(a,b,c){if(null==a.getEntityList().getEntityById(c))return!1;
const d=a.getEntityList().getEntityById(a.getId());if(d===a)return 0>b.items().indexOf(c);if(null==d)return!0;a=d.getUntypedComponent(k.i.getComponentKey(b));return!a||0>a.items().indexOf(c)?!0:!1}resetToOrigin(){var a=this.qa.getDiff();super.resetToOrigin();const b=this.items();for(let c of a)if(c.getKind()===f.ObservableArrayEventKind.Insert||c.getKind()===f.ObservableArrayEventKind.Remove)if(a=c.getItem(),0>b.indexOf(a)&&(a=this.U.getEntityList().getEntityById(a),null!=a)){let b=a.getComponent(this.xb),
c=null!=b?b.getValue():null;if(null!=c){let d=c.indexOf(this.U.getId());0<=d&&(c.splice(d,1),0===c.length&&a.set(this.xb,null),b.incrementVersion())}}}dispose(){if(null!=this.U&&null!=this.U.getEntityList()&&null==this.U.getEntityList().getEntityById(this.U.getId()))for(const a of this.qa.items()){const b=this.U.getEntityList().getEntityById(a);if(null!=b&&null!=b.get(this.xb)){const a=b.get(this.xb),d=b.get(this.xb).filter((a)=>a!==this.U.getId());d.length!==a.length&&b.set(this.xb,d)}}super.dispose()}};
var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.ze=class extends Ja.Sf{constructor(a,b){super(a,b)}createChildComponent(){let a=new Aa.ze(this,this.xb);a.version=this.version;return a}getValue(){return this.getAt(0)}equalsValue(a){return this.getAt(0)===a}equalsValueIncludingPdomInternal(a){return this.equalsValue(a)}setValue_Internal(a){1===this.length()&&this.equalsValue(a)||(1===this.length()&&this.removeAt_Internal(0),this.insert_Internal(0,a))}setValue(a,b,c=!1){if(c)throw Error("ignoreOnCommit is not supported for ref components");
if(b||1!==this.length()||!this.equalsValue(a))1===this.length()&&this.removeAt(0),this.insert(0,a)}};var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});Ka.Rf=class extends sa.Fd{constructor(a){super(a);this.ab={};if(null!=a)for(let b in a.ab)a.ab.hasOwnProperty(b)&&(this.ab[b]=a.ab[b])}createChildComponent(){let a=new Ka.Rf(this);for(let b in this.ab)this.ab.hasOwnProperty(b)&&(a.ab[b]=this.ab[b]);a.version=this.version;return a}rh(a,b,c){if(Aa.ze.Dp(this.U,this,b)){let a=this.U.getEntityList().getEntityById(b),
g=a.get(f.CetModel.ENTITY_OWNER_ID());if(null!=g&&g!==this.U.getId())throw Error(`entity is not a child of ${this.U.tsto()}`);a.set(f.CetModel.ENTITY_OWNER_ID(),null);c?a.Nc=!0:this.U.getEntityList().getScene().deleteEntitiesById([b])}for(delete this.ab[b];a<this.qa.length();a++)this.ab[this.getAt(a)]=a}qh(a,b,c,d,g,e){if(Aa.ze.Am(this.U)&&null!=b&&(b=this.U.getEntityList().getEntityById(b),null!=b||!c)){c=b.get(f.CetModel.ENTITY_OWNER_ID());if(null!=c&&c!==this.U.getId())throw Error("entity is already a child of "+
c);e&&(b.Nc=!1);b.set(f.CetModel.ENTITY_OWNER_ID(),this.U.getId());for(let b=a,c=this.qa.length();b<c;b++)a=this.getAt(b),this.ab[a]=b}}move(a,b){super.move(a,b);var c=b>=a?a:b;for(a=Math.floor(Math.min((b>=a?b:a)+1,this.qa.length()));c<a;c++)b=this.getAt(c),this.ab[b]=c}indexOf(a){let b=this.ab[a];null==b&&(b=-1);return-1!==b&&this.getAt(b)===a?b:-1}resetToOrigin(){super.resetToOrigin();for(let a=0,b=this.length();a<b;a++){let b=this.getAt(a);this.ab[b]=a}}};var Ta={};Object.defineProperty(Ta,"__esModule",
{value:!0});Ta.bi=class extends Ka.Rf{constructor(a){super(a)}createChildComponent(){let a=new Ta.bi(this);a.version=this.version;return a}getValue(){return this.getAt(0)}equalsValue(a){return 1===this.length()&&this.getValue()===a}equalsValueIncludingPdomInternal(a){return this.equalsValue(a)}setValue_Internal(a){1===this.length()&&this.equalsValue(a)||(1===this.length()&&this.removeAt_Internal(0),this.insert_Internal(0,a))}setValue(a,b){if(this.ag)throw Error("ignoreOnCommit is not supported for child components");
if(b||1!==this.length()||!this.equalsValue(a))1===this.length()&&this.removeAt(0),this.insert(0,a)}};var L={};Object.defineProperty(L,"__esModule",{value:!0});L.Qa=class{constructor(a,b){this.Th=new Map;this.fo=new Map;this.id=a;this.Vb=[];this.zc=!1;L.Qa.logger||(L.Qa.logger=t.LoggerModule.getLoggerManager().createLogger("ViewEntity"));null!=b&&(this.bh=b.getEntityById(a))}static iu(a,b){let c=a.getUntypedComponent(b);null!=c&&a.hasComponent(b,!0)||(c=(b.isTracked(),new Ta.bi(c)),a.setUntypedComponent(b,
c));return c}static tg(a,b){let c=a.getUntypedComponent(b);null!=c&&a.hasComponent(b,!0)||(c=new Ka.Rf(c),a.setUntypedComponent(b,c));return c}asMutableEntity(){return this}attachToEntityList(a){this.sb=a}getOwner(){const a=this.get(f.CetModel.ENTITY_OWNER_ID());return null==a?null:this.getEntityList().getEntityById(a)}getParentEntity(){return this.bh}getEntityList(){return this.sb}getId(){return this.id}setComponent(a,b){return this.setUntypedComponent(a,b)}getDef(){let a=this.get(f.CetModel.DEF());
return null==a?f.CetModel.nilDef():a}isDef(a){let b=this.get(f.CetModel.DEF());return null!=b&&b.isDef(a)}isLike(a){if(this.isDef(a))return!0;for(let b of a.getFields())if(!this.hasComponent(b))return!1;return!0}tsto(a=!0){const b=null!=this.getParentEntity()&&this.getParentEntity().getId()!==this.getId()?"(ghost)":"";return(a&&null!=this.sb?this.sb.getName()+"/":"")+this.getDef().getName()+"#"+this.getId()+b}tstoDeep(){const a=(a)=>a.split("\n").map((a)=>"    "+a).join("\n"),b=(a)=>"-> "+a+(null==
this.sb.getEntityById(a)?" broken!":""),c=(d)=>{if(null==d)return"null";const g=this.sb.getEntityById(d);if(null==g)return d+" broken!";let e=g.tsto();g.getDef().getFieldDescriptors().forEach((d)=>{var q="";try{if(g.hasComponent(d.fieldKey))if(d.kind===f.FieldDescriptorKind.ChildList||d.kind===f.FieldDescriptorKind.ScalarList||d.kind===f.FieldDescriptorKind.ReferenceList){var F=g.getComponent(d.fieldKey);for(const a of F.items())q=d.kind===f.FieldDescriptorKind.ReferenceList?q+b(a):d.kind===f.FieldDescriptorKind.ChildList?
q+c(a):q+a,q="\n"!==q[q.length-1]?q+"\n":q}else{const a=g.get(d.fieldKey);q=d.kind===f.FieldDescriptorKind.Reference?q+b(a):d.kind===f.FieldDescriptorKind.Child?q+c(a):q+a}else q+="null"}catch(Lc){q=""+Lc}F=e;d=d.fieldKey.getName();d=`\n  ${d}:`;q=0<=q.indexOf("\n")||30<q.length?`${d}\n${a(q)}`:`${d} ${q}`;e=F+q});return e};return c(this.getId())}tstoJson(a=!0){const b=(a)=>null==a?null:"-> "+a+(null==this.sb.getEntityById(a)?" broken!":""),c=(a)=>({ASSET_SOURCE_FILENAME:a.getAssetSourceFilename(),
HEIGHT:a.getHeight(),IMAGE_SCALE_X:a.getImageScaleX(),IMAGE_SCALE_Y:a.getImageScaleY(),IS_FLIPPED:a.getIsFlipped(),MASK:a.getMask(),OFFLINE_ASSET_ID:a.getOfflineAssetId(),ONLINE_ASSET_ID:a.getOnlineAssetId(),ONLINE_ASSET_URL:a.getOnlineAssetUrl(),PAGE_NUMBER:a.getPageNumber(),PDF_BOUNDS_LEFT:a.getPdfBoundsLeft(),PDF_BOUNDS_TOP:a.getPdfBoundsTop(),TRANSPARENT:a.getTransparent(),WIDTH:a.getWidth()}),d=(a,d)=>a.kind===f.FieldDescriptorKind.ReferenceList||a.kind===f.FieldDescriptorKind.Reference?b(d):
a.kind===f.FieldDescriptorKind.ChildList||a.kind===f.FieldDescriptorKind.Child?g(d):null==d?d:a.fieldKey===f.CetModel.ID.STYLE_DECLARATION.STYLE_SELECTOR?d.toString():a.fieldKey===f.CetModel.ID.Z_SLIDE.IMPORTED_ASSET?{ey:d.getImportJobId(),fy:c(d.getNoBackgroundPdfAsset()),gy:c(d.getOriginalPdfAsset()),ly:d.getSourcePageNumber()}:a.fieldKey===f.CetModel.ID.Z_TEXT.TEXT?{paragraphs:d.getParagraphs().map((a)=>{const b=a.getAllCharacterStyles().map((a)=>{let b=!1;const c={};a.isColorSet()&&(b=!0,c.color=
a.getColor().asHexString());a.isFontSizeSet()&&(b=!0,c.fontSize=a.getFontSize());a.isUnderlineSet()&&(b=!0,c.Gy=a.getUnderline());a.isFontFamilySet()&&(b=!0,c.fontFamily=a.getFontFamily());a.isFontWeightSet()&&(b=!0,c.fontWeight=a.getFontWeight());a.isFontStyleSet()&&(b=!0,c.fontStyle=a.getFontStyle());return b?c:null}).reduce((a,b,c)=>{null!=b&&(a[c]=b);return a},{});return{text:a.getText(),ry:a.getAlignment(),zy:a.getIndent(),listType:a.getListType(),ty:b}}),Jy:d.getWrapWidth()}:null!=d.getRGBData&&
null!=d.getAlpha?(a=d.getRGBData(),Object.assign(Object.assign({},a),{a:d.getAlpha()})):a.fieldKey===f.CetModel.ID.HAS_COLOR_FILTER.COLOR_FILTER?d.getObjectType()===m.ColorFilterType.NO_COLOR_FILTER?null:d.getObjectType()===m.ColorFilterType.SOLID_COLOR_BLEND?(a=d.getBlendColor().getRGBData(),Object.assign(Object.assign({},a),{a:d.getBlendAlpha()})):d:a.fieldKey===f.CetModel.ID.OVERVIEW.OVERVIEW_BOUNDS?null:d,g=(b)=>{if(null==b)return null;const c=this.sb.getEntityById(b);if(null==c)return b+" broken!";
const g={};a&&c.getId().startsWith("genid_")||(g.qy=c.getId());g.oy=c.getDef().getName();null!=this.getParentEntity()&&this.getParentEntity().getId()!==this.getId()&&(g.py=this.getParentEntity().getId());c.getDef().getFieldDescriptors().forEach((a)=>{let b;try{if(c.hasComponent(a.fieldKey))if(a.kind===f.FieldDescriptorKind.ChildList||a.kind===f.FieldDescriptorKind.ScalarList||a.kind===f.FieldDescriptorKind.ReferenceList){const g=c.getComponent(a.fieldKey);b=[];for(const c of g.items())b.push(d(a,
c))}else{const g=c.get(a.fieldKey);b=d(a,g)}else b=void 0}catch(Ob){b=Ob}g[a.fieldKey.getName()]=b});return g};return g(this.getId())}setUntypedComponent(a,b){let c=this.getUntypedComponent(a),d=this.hasComponent(a,!0);if(d&&c===b)return this;if(null!=c&&d)try{c.dispose()}catch(g){t.LoggerModule.logException(L.Qa.logger,`${this.tsto()}/${a.getName()}`,"setUntypedComponent/dispose",g)}null!=b?(this.Vb[a._compKeyId]=b,b._compkey_=a,a=this.sk(b,a),b.setOnEntity(this,a),0===b.getVersion()?b.incrementVersion():
b.setVersion(b.getVersion())):delete this.Vb[a._compKeyId];return this}sk(a,b){let c=null==this.get(l.f.Yh)?!1:this.get(l.f.Yh),d=this.isDef(f.CetModel.ID.EDITOR_PATH_STEP);return Nb.Kq.hv(a)&&(!c&&this.hasComponent(l.f.MODEL)||d)||b.isTracked()}hasComponent(a,b=!1){return null!=this.getUntypedComponent(a,b)}getUntypedComponent(a,b=!1){let c=this.Vb[a._compKeyId];if(b)return c;null==c&&null!=this.bh&&(c=this.bh.getUntypedComponent(a));return c}getComponent(a,b=!1){return this.getUntypedComponent(a,
b)}getComponentVersion(a,b){a=this.getComponent(a,b);return null==a?0:a.getVersion()}getMutableComponent(a){let b=this.getUntypedComponent(a,!0);if(null!=b)return b;b=this.getUntypedComponent(a,!1);if(null==b)return null;b=b.createChildComponent();this.setUntypedComponent(a,b);return b}getOwnComponentKeyIds(){return Object.keys(this.Vb)}Ye(a){return this.Vb[a]._compkey_}discardOwnComponent(a){if(null!=this.getUntypedComponent(a,!0)){delete this.Vb[a._compKeyId];let b=this.sk(this.getUntypedComponent(a),
a);this.Ei(a,f.ChangeType.RemoveComponent,b)}}Ei(a,b,c){if(null!=this.sb){var d=this.sb.getScene().getSceneHierarchy();const g=0<d.fe;d=0<d.Bj.length;if(a.isDom&&(g||d)&&(this.hasComponent(l.f.PENDING_INSERT)||this.hasComponent(l.f.MODEL))&&this.getDef().getFieldDescriptors().some((b)=>b.fieldKey===a))throw b=g?"PdomUpdateOutsideCommand":"PdomUpdateFromSystem",c=`Not allowed to modify a persisted entity's persisted field ${this.tsto()}/${a.getName()}`,L.Qa.logger.error({trigger:"machine",action:b,
object:"ViewEntity",payload:{message:c}}),Error(c);this.sb.entityChanged(this,a,b,c)}}componentChanged(a,b){this.Ei(a._compkey_,f.ChangeType.ModifyComponent,b)}dispose(a=!1){this.zc=!0;if(!a){for(const b of Object.keys(this.Vb))if(null!=b){a=this.Vb[b];try{a.dispose()}catch(c){t.LoggerModule.logException(L.Qa.logger,`${this.tsto()}/${k.i.getComponentKey(a).getName()}`,"dispose component",c)}}this.Ei(f.CetModel.getRemovedEntityCompKey(),f.ChangeType.RemoveEntity,!1)}}isDisposed(){return this.zc}getLastEntityVersion(a){return this.fo.get(a)}setLastEntityVersion(a,
b){this.fo.set(a,b)}get(a,b=!1){a=this.getComponent(a,b);return null==a?null:a.getValue()}set(a,b,c=!1){var d=this.getComponent(a);null!=d&&d.equalsValue(b)&&c===d.ignoreOnCommit()||(d=this.getMutableComponent(a),null==d&&(d=a.isTracked()?new gb.tl:new ra.Jd,this.setComponent(a,d)),d.setValue(b,!0,c));return this}forEach(a,b){a=this.getComponent(a);if(null!=a)for(const c of a.items())b(this.getEntityList().getEntityById(c))}forEachChild(a,b){this.forEach(a,b)}forEachRef(a,b){this.forEach(a,b)}getChildAt(a,
b){if(!this.hasComponent(a,!1))return null;a=this.getComponent(a,!1).getAt(b);return this.getEntityList().getEntityById(a)}getChild(a){if(!this.hasComponent(a,!1))return null;a=this.getComponent(a,!1);return this.getEntityList().getEntityById(a.getValue())}moveChild(a,b,c){L.Qa.tg(this,a).move(b,c);return this}insertChild(a,b,c){null==this.getEntityList().getEntityById(c.getId())&&this.getEntityList().addEntity(c);L.Qa.tg(this,a).insert(b,c.getId());return this}addChild(a,b){null==this.getEntityList().getEntityById(b.getId())&&
this.getEntityList().addEntity(b);L.Qa.tg(this,a).add(b.getId());return this}removeChildAt(a,b){L.Qa.tg(this,a).removeAt(b);return this}setChild(a,b){a=L.Qa.iu(this,a);let c=null==b?null:b.getId();null!=b&&null==this.sb.getEntityById(c)&&this.sb.addEntity(b);a.setValue(c);return this}getWrapperChecked(a){return this.getMutableWrapperChecked(a)}getMutableWrapperChecked(a){if(!this.isDef(a.getDef()))throw`cannot get '${a.getDef().getName()}' for '${this.getDef().getName()}' `;return this.getMutableWrapper(a)}getMutableWrapper(a){let b=
a.getDef(),c=this.Th.get(b);if(null==c){let a=this.get(f.CetModel.DEF());null!=a&&a.isDef(b)&&null!=a.W&&this.hasComponent(l.f.MODEL)&&(c=this.Th.get(a),null==c&&(c=a.W.create(this),this.Th.set(a,c)))}null==c&&(c=a.create(this));this.Th.set(b,c);return c}getWrapper(a){return this.getMutableWrapper(a)}bx(a){this.bh=a}createChild(a){a=new L.Qa(a);a.bx(this);return a}wx(){const a=this.id,b=[];for(let a of this.getOwnComponentKeyIds()){let c=this.Ye(a);const g=this.getUntypedComponent(c);c.isInherited()||
(b.push({key:c,jt:g}),g.setOnEntity(null,!1),delete this.Vb[a])}return 0<b.length?(c)=>{c=c.getEntityById(a);for(const {key:a,jt:g}of b)null!=c?(g.setOnEntity(c,c.sk(g,a)),c.Vb[a._compKeyId]=g):g.dispose()}:null}};var La={};Object.defineProperty(La,"__esModule",{value:!0});La.Nf=class{constructor(a,b,c,d){this.$j=!1;this.We=0;this.La=null;this.ub=new Map;this.entities=[];this.Mc=a;this.aa=c;this.name=d;this.La=b;this.La.$w(this);this.Ph=[];this.clear()}getName(){return this.name}getScene(){return this.Mc}lookup(a,
b){a=this.getEntityById(a);return null!=a&&a.isDef(b.getDef())?a.getMutableWrapper(b):null}getEntityById(a){let b=this.ub.get(a);null==b&&this.$j&&(b=this.Mc.zb.get(a));return b}getEntitiesById(a){let b=[];for(let c of a)null!=this.getEntityById(c)&&b.push(this.ub.get(c));return b}getMutableEntitiesById(a){let b=[];for(let c of a)null!=this.getEntityById(c)&&b.push(this.ub.get(c));return b}asArray(){return this.entities}forEach(a){for(let b of this.entities)a(b)}forEachMutable(a,b){var c;try{if(null!=
b){if(!this.La.pj(b))throw Error("Trying to pull changes for uninitialized entity change tracker: "+b.getName()+" list: "+this.getName());for(let c of this.La.bn(b))(null===c.getEntityList()||c.getEntityList()===this)&&b.select(c)&&a(c)}else for(let b of this.entities)a(b)}catch(d){t.LoggerModule.logException(this.Mc.logger,null!==(c=null===b||void 0===b?void 0:b.getName())&&void 0!==c?c:"","forEachMutable",d)}finally{null!=b&&this.La.Kk(b)}}forChangedEntities(a,b){this.forChangedMutableEntities(a,
b)}forChangedMutableEntities(a,b){let c=[];if(!this.La.pj(b))throw Error("Trying to pull changes for uninitialized entity change tracker: "+b.getName()+" list: "+this.getName());for(let a of this.La.bn(b))(null===a.getEntityList()||a.getEntityList()===this)&&b.select(a)&&c.push(a);try{0<c.length&&a(c)}catch(d){t.LoggerModule.logException(this.Mc.logger,b.getName(),"forEachColoredMutable",d)}finally{this.La.Kk(b)}}getNumberOfEntities(){return this.entities.length}setEntityById(a,b){let c=null==this.ub.get(a);
if(c)this.ub.set(a,b),this.entities.push(b);else{this.ub.get(a).dispose();this.ub.set(a,b);for(let c=0,g=this.entities.length;c<g;c++)if(this.entities[c].getId()===a){this.entities[c]=b;break}}b.attachToEntityList(this);b.hasComponent(f.CetModel.PENDING_INSERT())||this.entityChanged(b,f.CetModel.getNewEntityCompKey(),f.ChangeType.AddEntity,c)}removeAt(a,b){let c=this.entities[a];this.ub.delete(c.getId());if(null!=this.Mc&&b.rc){const a=c.isDef(f.CetModel.ID.Z_OBJECT)||c.isDef(f.CetModel.ID.EDITOR_PATH_STEP)||
c.isDef(f.CetModel.ID.PATH_ACTION)||c.isDef(f.CetModel.ID.GROUP)||c.isDef(f.CetModel.ID.TEMPLATE_INFO);this.Mc.entityChanged(c,null,f.ChangeType.RemoveEntity,a)}this.entityChanged(c,f.CetModel.getRemovedEntityCompKey(),f.ChangeType.RemoveEntity,!1);this.entities.splice(a,1);b.dispose&&c.dispose()}addEntity(a){if(null!=this.ub.get(a.getId()))throw Error(`entity with id '${a.getId()}' already exists`);this.setEntityById(a.getId(),a)}deleteEntityDontDisposeInternal(a){this.ng(a,{dispose:!1,rc:!0})}deleteEntity(a){return this.ng(this.ub.get(a),
{dispose:!0,rc:!0})}ng(a,b){if(null!=a){let c=this.entities.indexOf(a);if(0<=c)return this.removeAt(c,b),a}return null}createEntity(a){let b=new L.Qa(a,null);this.setEntityById(a,b);return b}clear(){for(let a of this.entities.map((a)=>a.getId()))this.ng(this.ub.get(a),{dispose:!0,rc:!0});this.ub=new Map;this.entities=[];this.Ph=[];this.La.clearPendingChanges()}update(a){if(null!=this.aa){var b=this.aa.getEntityList();b.We!==this.We&&(this.clear(),this.We=b.We);b.forEach((b)=>{b=b.getId();if(!a.has(b)){var c=
this.getEntityById(b);null!=c&&c.getParentEntity()===this.aa.getEntityById(b)||this.setEntityById(b,new L.Qa(b,this.aa))}});this.Ph.forEach((a)=>a(this));this.Ph=[];for(var c=0;c<this.entities.length;){let a=this.entities[c];null!=a.getParentEntity()&&null==b.getEntityById(a.getParentEntity().getId())?this.removeAt(c,{dispose:!0,rc:!0}):c++}}}rollback(){for(let a=this.entities.length-1;0<=a;a--){const b=this.entities[a];b.Nc&&(b.Nc=!1);(b.hasComponent(l.f.PENDING_INSERT)||b.getDef()===f.CetModel.nilDef())&&
this.removeAt(a,{dispose:!0,rc:!1})}}commit(){let a=null==this.aa?null:this.aa.getEntityList();var b=!1;let c=[];for(let a=0,b=this.entities.length;a<b;a++){var d=this.entities[a];this.mx(d)&&c.push(a);for(var g of d.getOwnComponentKeyIds()){var e=d.Ye(g);d.getUntypedComponent(e).ignoreOnCommit()&&d.discardOwnComponent(e)}}for(d=c.length-1;0<=d;){e=c[d];g=this.entities[e];let f=g.getParentEntity();null!=f?(f.Nc=g.Nc,this.removeAt(e,{dispose:!0,rc:!0})):(this.removeAt(e,{dispose:!1,rc:!0}),null!=a&&
(b=g.wx(),null!=b&&this.Ph.push(b),g.attachToEntityList(null),a.addEntity(g),b=!0));d--}return b}Bw(){let a=[];for(let b=0,d=this.entities.length;b<d;b++)this.entities[b].Nc&&a.push(b);let b=a.length-1;for(;0<=b;){let c=a[b],d=this.entities[c];this.removeAt(c,{dispose:!0,rc:!0});d.attachToEntityList(null);b--}}mx(a){return a.Nc?null!=this.aa:a.hasComponent(l.f.PENDING_INSERT)?a.getDef()===f.CetModel.nilDef()?!0:this.Cp(a):!1}Cp(a){if(null==a)return!1;if(a.getDef()===f.CetModel.ID.PREZI||a.Nc)return!0;
a=a.get(f.CetModel.ENTITY_OWNER_ID());return null==a?!1:this.Cp(this.getEntityById(a))}$o(a){if(null!=a.getParentEntity())throw Error("entity cannot have parent");if(null!=this.getEntityById(a.getId()))throw Error("entity with id already exists");a.getEntityList().ng(a,{dispose:!1,rc:!1});a.attachToEntityList(null);this.addEntity(a)}tsto(){return"entity count: "+this.entities.length}entityChanged(a,b,c,d){b.shouldTriggerSystems()&&this.La.entityChanged(a,b._compKeyId);null!=this.Mc&&this.Mc.entityChanged(a,
b,c,d)}getAt(a){return this.entities[a]}startNewTracking(a,b,c){a=new Mb.rr(a,b,c);this.Op(a);return a}Op(a){this.La.Kk(a)}stopTracking(a){this.La.remove(a)}contains(a){return null!=a&&this.getEntityById(a.getId())===a}cx(a){this.Vo=a}getPrezi(){if(null==this.aa)return this.getEntityById(this.Vo);var a=this.aa.getPrezi();if(null==a)return null;a=a.getId();let b=this.getEntityById(a);null==b&&(b=new L.Qa(a,this.aa),this.addEntity(b),this.Vo=a);return b}getPreziW(){const a=this.getPrezi();return null!=
a?a.getMutableWrapper(f.CetModel.ID.PREZI.W):null}};La.Nf.By=0;var hb={};Object.defineProperty(hb,"__esModule",{value:!0});hb.el=class{constructor(){this.Le=[];this.oe=[];this.Sb=new Map}$w(a){this.dw=a}clearPendingChanges(){for(const a of this.Sb.keys())this.Sb.set(a,[])}addChildMonitor(a){-1===this.Le.indexOf(a)&&this.Le.push(a)}removeChildMonitor(a){a=this.Le.indexOf(a);-1!==a&&this.Le.splice(a,1)}pj(a){return this.Sb.has(a)}remove(a){this.Sb.delete(a);for(const b in this.oe)if(this.oe.hasOwnProperty(b)){let c=
this.oe[b];for(let b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}}}bn(a){if(!this.pj(a))throw Error("tracker not known by monitor!");return this.pw(a)}Kk(a){if(!this.Sb.has(a)){var b=a.getTriggerKeys().map((a)=>a._compKeyId);for(let c of b)b=this.oe[c],null==b&&(b=[],this.oe[c]=b),b.push(a);this.Sb.set(a,[])}}entityIdChanged(a,b,c=!0){a=this.dw.getEntityById(a);null!=a&&this.entityChanged(a,b,c)}entityChanged(a,b,c=!0){this.xm(a,b,c);if(b===f.CetModel.getNewEntityCompKey()._compKeyId)for(b=
a,c=!0;null!=a;){for(let d of a.getOwnComponentKeyIds())this.xm(b,d,c);a=a.getParentEntity();c=!1}}xm(a,b,c=!0){var d=this.oe[b];if(null!=d)for(let b of d)if(d=b.getRequiredKeysForIndirectTrigger(),c||0===d.length)this.Sb.get(b).push(a);else for(let c of d)a.hasComponent(c,!0)&&this.Sb.get(b).push(a);for(let c of this.Le)c.entityIdChanged(a.getId(),b,!1)}pw(a){let b=this.Sb.get(a);const c=[];if(0===b.length)return c;for(let d of b)d.isDisposed()&&!a.isTrackingRemovedEntity()||d.__seen__||(c.push(d),
d.__seen__=!0);for(let a of b)a.__seen__=null;this.Sb.set(a,[]);return c}};var Pb={};Object.defineProperty(Pb,"__esModule",{value:!0});Pb.Vr=class{constructor(a){this.logger=t.LoggerModule.getLoggerManager().createLogger("PreziDiffer");this.ma=a;this.Yc=Math.pow(2,-40)}updatePrezi(a,b){var c=(a)=>a.getId();this.ma.getZObjectType()===e.MergeType.REPLACE?b.updateZObjects(a.getZObjects()):(this.ma.getZObjectType()===e.MergeType.REPLACE_DIFFED||this.ma.getZObjectType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&
this.qe(a.getZObjects(),b.getTypedZObjects(),c,this.ma.getZObjectStrategy(),(a,b)=>this.Qx(a,b));c=(a)=>a.getStyleSelector().toString();this.ma.getStyleType()===e.MergeType.REPLACE?b.getTypedDocumentStyle().updateStyleDeclarations(a.getDocumentStyle().getStyleDeclarations()):(this.ma.getStyleType()===e.MergeType.REPLACE_DIFFED||this.ma.getStyleType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.qe(a.getDocumentStyle().getStyleDeclarations(),b.getTypedDocumentStyle().getTypedStyleDeclarations(),c,this.ma.getStyleStrategy(),
(a,b)=>this.Mx(a,b));c=(a)=>a.getName();this.ma.getFontFamilyType()===e.MergeType.REPLACE?b.getTypedDocumentStyle().updateFontFamilies(a.getDocumentStyle().getFontFamilies()):(this.ma.getFontFamilyType()===e.MergeType.REPLACE_DIFFED||this.ma.getFontFamilyType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.qe(a.getDocumentStyle().getFontFamilies(),b.getTypedDocumentStyle().getTypedFontFamilies(),c,this.ma.getFontFamilyStrategy(),(a,b)=>this.updateFontFamily(a,b));c=(a)=>a.getName();this.ma.getFontClassType()===
e.MergeType.REPLACE?b.getTypedDocumentStyle().updateFontClasses(a.getDocumentStyle().getFontClasses()):(this.ma.getFontClassType()===e.MergeType.REPLACE_DIFFED||this.ma.getFontClassType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.qe(a.getDocumentStyle().getFontClasses(),b.getTypedDocumentStyle().getTypedFontClasses(),c,this.ma.getFontClassStrategy(),(a,b)=>this.updateFontClass(a,b));c=(a)=>a.getOnlineAssetUrl();a.getBackground().getLayerType()!==b.getBackground().getLayerType()&&b.getTypedBackground().updateLayerType(a.getBackground().getLayerType());
this.ma.getBackgroundType()===e.MergeType.REPLACE?b.getTypedBackground().updateLayers(a.getBackground().getLayers()):(this.ma.getBackgroundType()===e.MergeType.REPLACE_DIFFED||this.ma.getBackgroundType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.qe(a.getBackground().getLayers(),b.getTypedBackground().getTypedLayers(),c,this.ma.getBackgroundStrategy(),(a,b)=>this.Hx(a,b))}qe(a,b,c,d,e){for(var g={},f=0;f<a.length();){var h=a.get(f);null!=d&&d.shouldIgnoreSourceObject(h)||(g[c(a.get(f))]=!0);f++}for(f=
h=0;h<b.length();){var k=b.get(h);null!=d&&d.shouldRetainDestObject(k)?(h++,f=h):null!=g[c(k)]?h++:b.remove(h)}for(g=0;g<a.length();)if(h=a.get(g),null!=d&&d.shouldIgnoreSourceObject(h))g++;else{k=this.pu(b,c(h),c);if(-1===k)b.insert(f,h),null!=d&&d.handleNewObject(h),f++;else{let a=b.getTyped(k);if(k!==f){let c=a.freeze(),g=a.getPDOMId();b.remove(k);k<f&&f--;b.insert(f,c);a=b.getTyped(f);null!=d&&d.handleMovedObject(c,g,a.getPDOMId())}f++;null!=d&&d.handleUpdatedObject(a,h);e(h,a)}g++}}pu(a,b,c){let d=
0;for(;d<a.length();){if(c(a.get(d))===b)return d;d++}return-1}Qx(a,b){if(a.getObjectType()!==b.getObjectType())throw Error("Objects with the same id in source and target document must be of same object type!");this.$p(a,b);switch(a.getObjectType()){case m.ZObjectType.Z_TEXT:this.Rx(a,b);break;case m.ZObjectType.Z_CIRCLE:this.Jx(a,b);break;case m.ZObjectType.Z_IMAGE:this.Zp(a,b)}}$p(a,b){a.getLocalToWorld().equalsWithin(b.getLocalToWorld(),this.Yc)||b.updateLocalToWorld(a.getLocalToWorld())}Jx(a,
b){Math.abs(a.getRadius()-b.getRadius())>this.Yc&&b.updateRadius(a.getRadius())}Zp(a,b){a.getOnlineAssetUrl()!==b.getOnlineAssetUrl()&&b.updateOnlineAssetUrl(a.getOnlineAssetUrl());a.getOnlineAssetId()!==b.getOnlineAssetId()&&b.updateOnlineAssetId(a.getOnlineAssetId());a.getAssetSourceFilename()!==b.getAssetSourceFilename()&&b.updateAssetSourceFilename(a.getAssetSourceFilename());a.getOfflineAssetId()!==b.getOfflineAssetId()&&b.updateOfflineAssetId(a.getOfflineAssetId())}Rx(a,b){a.getText().equals(b.getText())||
b.updateText(a.getText())}Mx(a,b){this.logger.info({action:"update",object:"style_declartion",trigger:"machine",payload:{selector:a.getStyleSelector().toString()}});a=a.getStyleBlock();b=b.getTypedStyleBlock();!a.hasAlpha()||b.hasAlpha()&&a.getAlpha()===b.getAlpha()||b.updateAlpha(a.getAlpha());!a.hasAlpha()&&b.hasAlpha()&&b.clearAlpha();!a.hasAttachPadding()||b.hasAttachPadding()&&a.getAttachPadding()===b.getAttachPadding()||b.updateAttachPadding(a.getAttachPadding());!a.hasAttachPadding()&&b.hasAttachPadding()&&
b.clearAttachPadding();!a.hasBackgroundAlpha()||b.hasBackgroundAlpha()&&a.getBackgroundAlpha()===b.getBackgroundAlpha()||b.updateBackgroundAlpha(a.getBackgroundAlpha());!a.hasBackgroundAlpha()&&b.hasBackgroundAlpha()&&b.clearBackgroundAlpha();!a.hasBackgroundColor()||b.hasBackgroundColor()&&a.getBackgroundColor().equals(b.getBackgroundColor())||b.updateBackgroundColor(a.getBackgroundColor());!a.hasBackgroundColor()&&b.hasBackgroundColor()&&b.clearBackgroundColor();!a.hasBackgroundPadding()||b.hasBackgroundPadding()&&
a.getBackgroundPadding()===b.getBackgroundPadding()||b.updateBackgroundPadding(a.getBackgroundPadding());!a.hasBackgroundPadding()&&b.hasBackgroundPadding()&&b.clearBackgroundPadding();!a.hasBorderAlpha()||b.hasBorderAlpha()&&a.getBorderAlpha()===b.getBorderAlpha()||b.updateBorderAlpha(a.getBorderAlpha());!a.hasBorderAlpha()&&b.hasBorderAlpha()&&b.clearBorderAlpha();!a.hasBorderColor()||b.hasBorderColor()&&a.getBorderColor()===b.getBorderColor()||b.updateBorderColor(a.getBorderColor());!a.hasBorderColor()&&
b.hasBorderColor()&&b.clearBorderColor();!a.hasBorderThickness()||b.hasBorderThickness()&&a.getBorderThickness()===b.getBorderThickness()||b.updateBorderThickness(a.getBorderThickness());!a.hasBorderThickness()&&b.hasBorderThickness()&&b.clearBorderThickness();!a.hasColor()||b.hasColor()&&a.getColor().equals(b.getColor())||b.updateColor(a.getColor());!a.hasColor()&&b.hasColor()&&b.clearColor();!a.hasDisplayBackground()||b.hasDisplayBackground()&&a.getDisplayBackground()===b.getDisplayBackground()||
b.updateDisplayBackground(a.getDisplayBackground());!a.hasDisplayBackground()&&b.hasDisplayBackground()&&b.clearDisplayBackground();!a.hasFontClass()||b.hasFontClass()&&a.getFontClass()===b.getFontClass()||b.updateFontClass(a.getFontClass());!a.hasFontClass()&&b.hasFontClass()&&b.clearFontClass();!a.hasGradEndAlpha()||b.hasGradEndAlpha()&&a.getGradEndAlpha()===b.getGradEndAlpha()||b.updateGradEndAlpha(a.getGradEndAlpha());!a.hasGradEndAlpha()&&b.hasGradEndAlpha()&&b.clearGradEndAlpha();!a.hasGradEndColor()||
b.hasGradEndColor()&&a.getGradEndColor().equals(b.getGradEndColor())||b.updateGradEndColor(a.getGradEndColor());!a.hasGradEndColor()&&b.hasGradEndColor()&&b.clearGradEndColor();!a.hasGradStartAlpha()||b.hasGradStartAlpha()&&a.getGradStartAlpha()===b.getGradStartAlpha()||b.updateGradStartAlpha(a.getGradStartAlpha());!a.hasGradStartAlpha()&&b.hasGradStartAlpha()&&b.clearGradStartAlpha();!a.hasGradStartColor()||b.hasGradStartColor()&&a.getGradStartColor().equals(b.getGradStartColor())||b.updateGradStartColor(a.getGradStartColor());
!a.hasGradStartColor()&&b.hasGradStartColor()&&b.clearGradStartColor();!a.hasFillType()||b.hasFillType()&&a.getFillType()===b.getFillType()||b.updateFillType(a.getFillType());!a.hasFillType()&&b.hasFillType()&&b.clearFillType();!a.hasPadding()||b.hasPadding()&&a.getPadding()===b.getPadding()||b.updatePadding(a.getPadding());!a.hasPadding()&&b.hasPadding()&&b.clearPadding();!a.hasRadius()||b.hasRadius()&&a.getRadius()===b.getRadius()||b.updateRadius(a.getRadius());!a.hasRadius()&&b.hasRadius()&&b.clearRadius();
!a.hasThickness()||b.hasThickness()&&a.getThickness()===b.getThickness()||b.updateThickness(a.getThickness());!a.hasThickness()&&b.hasThickness()&&b.clearThickness()}Hx(a,b){this.logger.info({action:"update",object:"background_layer",trigger:"machine",payload:{url:a.getOnlineAssetUrl().toString()}});this.$p(a,b);this.Zp(a,b);Math.abs(a.getDepth()-b.getDepth())>this.Yc&&b.updateDepth(a.getDepth());Math.abs(a.getFadeScale()-b.getFadeScale())>this.Yc&&b.updateFadeScale(a.getFadeScale())}updateFontFamily(a,
b){this.logger.info({action:"update",object:"font_family",trigger:"machine",payload:{name:a.getName().toString()}});let c=(a)=>a.getFontSrc();this.ma.getFontFaceType()===e.MergeType.REPLACE?b.updateFontFaces(a.getFontFaces()):(this.ma.getFontFaceType()===e.MergeType.REPLACE_DIFFED||this.ma.getFontFaceType()===e.MergeType.REPLACE_DIFFED_CUSTOM)&&this.qe(a.getFontFaces(),b.getTypedFontFaces(),c,this.ma.getFontFaceStrategy(),(a,b)=>this.Ix(a,b))}Ix(a,b){this.logger.info({action:"update",object:"font_face",
trigger:"machine",payload:{font_src:a.getFontSrc().toString()}});a.getFontStyle()!==b.getFontStyle()&&b.updateFontStyle(a.getFontStyle());a.getFontWeight()!==b.getFontWeight()&&b.updateFontWeight(a.getFontWeight())}updateFontClass(a,b){this.logger.info({action:"update",object:"font_class",trigger:"machine",payload:{name:a.getName().toString()}});a.getFontStyle()!==b.getFontStyle()&&b.updateFontStyle(a.getFontStyle());a.getFontWeight()!==b.getFontWeight()&&b.updateFontWeight(a.getFontWeight());a.getFontFamily()!==
b.getFontFamily()&&b.updateFontFamily(a.getFontFamily())}};var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});var ca;(function(a){a[a.ci=0]="No";a[a.Zf=1]="Yes";a[a.ul=2]="Unknown"})(ca=Ba.pr||(Ba.pr={}));class Uc{constructor(){this.nd=ca.ci;this.version=0}getVersion(){return this.version}Bf(a,b,c){this.commit(a,b,M.Dd.we);b=b.getParentScene();b.Da.Bf(a,b,c)}getUncommitedChanges(a){let b=[];this.wn(a,b);return b}dj(a){this.nd===ca.ul&&(this.nd=this.wn(a,null)?ca.Zf:ca.ci);return this.nd===
ca.Zf}entityChanged(a,b,c,d){d===f.ChangeType.ModifyComponent?this.nd!==ca.Zf&&(a=a.getParentScene(),null!=a&&null!=a.getEntityById(b.getId())&&this.am(b,c)&&(this.nd=ca.Zf)):this.nd=ca.ul}am(a,b){return b.isInherited()&&a.getDef().hasField(b)}wn(a,b){var c=a.getParentScene();if(null==c)return!1;let d=!1;for(let g of c.getEntityList().asArray())if(c=a.getEntityById(g.getId()),null!=c)for(let a of c.getOwnComponentKeyIds()){let g=c.Ye(a);if(this.am(c,g))if(d=!0,null!=b)b.push(""+c.tsto()+", "+g.getName());
else return d}return d}undo(a){this.version++;a=a.getParentScene();return a.Da.undo(a)}rollback(a){a.getEntityList().rollback();a.getEntityList().forEachMutable((a)=>{if(e.Cet.hasPdomComponent(a))for(let b of a.getOwnComponentKeyIds()){let c=a.Ye(b),g=a.getUntypedComponent(c);if(g.ignoreOnCommit()||c.isInherited())a.discardOwnComponent(c),g.dispose()}})}commit(a,b){this.version++;let c=!1;a=b.getParentScene();null!=a&&a.getEntityList().forEachMutable((a)=>{let d=b.getEntityById(a.getId());if(null!=
d){let b={},e={};for(let a of d.getOwnComponentKeyIds()){let g=d.Ye(a),f=d.getUntypedComponent(g);f.ignoreOnCommit()?(d.discardOwnComponent(g),c=!0):g.isInherited()&&(b[a]=g,e[a]=f,d.discardOwnComponent(g),c=!0)}for(let c in b)b.hasOwnProperty(c)&&a.setUntypedComponent(b[c],e[c])}});this.nd=ca.ci;a=b.getEntityList().commit();return c||a}redo(a){this.version++;a=a.getParentScene();return a.Da.redo(a)}}Ba.ds=Uc;class Vc{constructor(){}getVersion(){return 0}Bf(){}getUncommitedChanges(){return[]}dj(){return!1}entityChanged(){}commit(a,
b){b.getEntityList().forEachMutable((a)=>{a.hasComponent(f.CetModel.PENDING_INSERT())&&(a.discardOwnComponent(f.CetModel.PENDING_INSERT()),b.getEntityList().entityChanged(a,f.CetModel.getNewEntityCompKey(),f.ChangeType.AddEntity,!0))});return!1}undo(){return!1}redo(){return!1}rollback(){}}Ba.Er=Vc;var Qb={};Object.defineProperty(Qb,"__esModule",{value:!0});Qb.es=class{constructor(a){this.Ie=-1;this.hb={};this.pc=[];this.od=!1;this.Cw=a.getEntityList().startNewTracking("tweener:"+a.getName(),[f.CetModel.getRemovedEntityCompKey()],
()=>!0)}Ew(a){this.pc=this.pc.filter((b)=>b.jc!==a.entity.getId()||b.Xp!==a.Oi.getId());const b=this.rm(a.entity,a.Oi,a.va,a.Zn);this.pc.push({Xp:b.getId(),jc:a.entity.getId(),Ek:b})}fadeIn(a,b,c,d){this.fade(a,b,0,1,c,d)}fadeOut(a,b,c,d){this.fade(a,b,1,0,c,d)}fade(a,b,c,d,e,f){b(c);c=new ya.Ge(String(x.Utils.nextSerialId()),(new Date).getTime(),{alpha:c},{alpha:d},e,[],(a)=>{b(a.alpha)});null!=f&&(c.onEnd=f);this.vi(a.getId(),c,!1)}Zi(a,b){let c=Number.POSITIVE_INFINITY;for(let d of a)d.sj(b)?c=
0:(a=d.startTime-b,a<c&&(c=a));return c}getNextFrameTime(){if(this.od)return 0;let a=(new Date).getTime(),b=0<=this.Ie?this.Ie:Number.POSITIVE_INFINITY;for(let c of Object.keys(this.hb)){let d=this.hb[c];null!=d&&(b=Math.min(b,this.Zi(d,a)))}return b===Number.POSITIVE_INFINITY?-1:b}needsFrameImmediately(){return 0===this.getNextFrameTime()}update(a){a.getEntityList().forChangedMutableEntities((b)=>{for(let c of b)b=c.getId(),null==a.getEntityById(b)&&delete this.hb[b]},this.Cw);var b=x.Utils.createLinkedList(),
c=(new Date).getTime();this.od=!1;for(var d of Object.keys(this.hb))for(var e=this.hb[d],f=0;f<e.length;){let a=e[f];a.Vn()?(null!=a.vb&&(a.vb(),a.vb=null),a.step(a.Wi()),b.add(a),e.splice(f,1)):(a.sj(c)&&(null!=a.vb&&(a.vb(),a.vb=null),a.step(c),this.od=!0),a.Qn(c)?(b.add(a),e.splice(f,1)):f++)}for(let a of b)if(null!=a.onEnd)a.onEnd();for(b=0;b<this.pc.length;b++)if(c=this.pc[b],d=this.hb[c.jc],null!=d)for(e=0;e<d.length;)if(f=d[e],f.getId()===c.Xp){c.Ek.Gw(f.Ds);d.splice(e,1);break}else e++;for(b=
0;b<this.pc.length;b++)c=this.pc[b],this.vi(c.jc,c.Ek,!1);this.pc=[]}reset(){this.hb={};this.od=!1;this.pc=[]}Gv(a,b){b=this.hb[b];return null!=b?null!=b.find((b)=>b.getId()===a):!1}un(a){a=this.hb[a.getId()];return null!=a?a.length:0}addEntityTween(a){const b=this.rm(a.entity,a.Oi,a.va,a.Zn);this.vi(a.entity.getId(),b,a.va.getTweenMode()===e.TweenMode.IMMEDIATE)}rm(a,b,c,d){const e=a.getEntityList();let f=a.getId(),F=b.getPropertyNames(),h=b.getStartValues(),k=b.getEndValues(),m={},l={};for(let a=
0,b=F.length;a<b;a++)m[F[a]]=h[a],l[F[a]]=k[a];let p=b.getOnCurrentValues(c,f),n=new ya.Ge(b.getId(),b.shouldUseUserStartTime()?Number.MAX_SAFE_INTEGER:(new Date).getTime()+b.getStartDelay(),m,l,b.getDuration(),b.getTweenedComponents(),(a)=>{p((b)=>a[b])},b.getEase());b.shouldUseUserStartTime()&&(this.Ie=0,setTimeout(()=>{n.Rs((new Date).getTime()+b.getStartDelay());this.Ie=-1},this.Ie));null!=b.getStartUpdate()&&(n.vb=()=>{b.getStartUpdate()(c)});n.onEnd=()=>{null!=b.getEndUpdate()&&b.getEndUpdate()(c);
if(d){const a=c.getEntityById(f);null!=a&&b.cleanupTweenedComponents(a)}};if(d){let c=b.getTweenedComponentsVersion(a);n.Vn=()=>{const a=e.getEntityById(f);return null==a||c!==b.getTweenedComponentsVersion(a)}}b.shouldFillBeforeStart()&&n.step(n.startTime-1);b.isRecurring()&&n.dx(b.flipBeforeRecurring(),b.getDelayBeforeRecurring(),b.getNumberOfRecurrings());return n}vi(a,b,c){if(c){if(null!=b.vb&&b.vb(),b.step(b.Wi()),null!=b.onEnd)b.onEnd()}else c=this.hb[a],null==c&&(c=[],this.hb[a]=c),c.push(b)}gp(a,
b=null,c=null){let d=this.hb[a.getId()];if(null!=d){var e=[];for(let a of d)if(this.af(b,a)&&(null==c||c===a.getId())){null!=a.vb&&(a.vb(),a.vb=null);a.step(a.Wi());if(null!=a.onEnd)a.onEnd();e.push(a)}b=d.filter((a)=>-1===e.indexOf(a));this.hb[a.getId()]=b}}af(a,b){if(null==a)return!0;for(let c of a)if(b.af(c))return!0;return!1}};var Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.Yf=class{constructor(a,b,c){this.j=a;this.ua=b;this.pd=c}Mg(a){return 0===a.duration&&0===a.delay}isVisible(a){a=
a.get(this.ua);return null!=a&&a.isEnabled&&0<a.alpha}getAlpha(a){return a.get(this.ua).alpha}hasVisibilityKey(a){return null!=a.get(this.ua)}discardVisibilitykey(a){a.discardOwnComponent(this.ua)}setVisibility(a,b,c){this.og(a,c,c,b,k.i.getAnimationData(e.AnimationType.INSTANT));a.set(this.pd,{visibility:{isEnabled:b,alpha:c},animation:{duration:0,delay:0}})}hide(a){let b=a.get(this.pd);if(null==b||b.visibility.isEnabled||!this.Mg(b.animation))this.og(a,1,0,!1,k.i.getAnimationData(e.AnimationType.INSTANT)),
a.set(this.pd,{visibility:{isEnabled:!1,alpha:0},animation:{duration:0,delay:0}})}show(a){let b=a.get(this.pd);null!=b&&b.visibility.isEnabled&&this.Mg(b.animation)||(this.og(a,0,1,!0,k.i.getAnimationData(e.AnimationType.INSTANT)),a.set(this.pd,{visibility:{isEnabled:!0,alpha:1},animation:{duration:0,delay:0}}))}fade(a,b,c,d){let e=a.get(this.pd);if(null==e||e.visibility.isEnabled!==b||this.Mg(c)&&!this.Mg(e.animation))this.og(a,b?0:1,b?1:0,b,c,d),a.set(this.pd,{visibility:{isEnabled:b,alpha:1},animation:c})}fadeOut(a,
b,c){this.fade(a,!1,b,c)}fadeIn(a,b,c){this.fade(a,!0,b,c)}blinking(a,b){a.set(this.ua,{isEnabled:!0,alpha:1});let c=null!=b.delayBeforeRecurring?b.delayBeforeRecurring:Ma.Yf.Dq,d=this.j.getTweener();d.removeTweens(a.getId(),[this.ua]);let e=k.i.createAlphaTween("blinking-"+this.ua.getName(),b.duration,1,0,this.ua);e.setStartDelay(b.delay);e.setFillBeforeStart(!0);e.setRecurring(!0,c);d.addTween(a.getId(),e)}removeVisibilityTweens(a){this.j.getTweener().removeTweens(a.getId(),[this.ua])}og(a,b,c,
d,e,f){let g=e.duration,q=null==e.delay?0:e.delay,h=this.j.getTweener();if(0===q&&0===g)h.removeTweens(a.getId(),[this.ua]),a.set(this.ua,{isEnabled:d,alpha:c}),null!=f&&f(this.j);else{h.removeTweens(a.getId(),[this.ua]);let F=h.getTweenedValue(a.getId(),this.ua);a.set(this.ua,{isEnabled:d,alpha:c});null==F||0===e.duration&&0===q||(b=F.alpha);1E-8<Math.abs(b-c)&&(c=k.i.createAlphaTween("alpha-"+this.ua.getName(),g,b,c,this.ua),c.setStartDelay(q),c.setFillBeforeStart(!0),null!=f&&c.setEndUpdate(f),
h.addTween(a.getId(),c))}}};Ma.Yf.Dq=450;var Rb={};Object.defineProperty(Rb,"__esModule",{value:!0});Rb.Qq=class{constructor(a,b,c){this.no={};this.Uc={};this.va=a;this.Yb=b;this.Ua=c}setAnimationScene(a){this.va=a}mw(a,b,c){let d=this.Yb.getEntityById(a);if(b.shouldDisableHittest()&&this.va.getTweenMode()!==e.TweenMode.IMMEDIATE){let e=d.get(k.i.getTemporaryEntityHittestDisabledKey());null==e&&(e=0);c||++e;d.set(k.i.getTemporaryEntityHittestDisabledKey(),e,!0);let f=b.getEndUpdate();b.setEndUpdate((b)=>
{null!=f&&f(b);b=this.Yb.getEntityById(a);if(null!=b){let a=b.get(k.i.getTemporaryEntityHittestDisabledKey())-1;b.set(k.i.getTemporaryEntityHittestDisabledKey(),a,!0)}})}return{entity:d,Oi:b,va:this.va,Zn:this.Yb!==this.va}}addTween(a,b,c=!1){var d=this.Yb.getEntityById(a);null!=d&&(d=this.Ua.Gv(b.getId(),d.getId()),a=this.mw(a,b,d&&c),d?c?this.Ua.Ew(a):(this.Ua.gp(a.entity,null,b.getId()),this.Ua.addEntityTween(a)):this.Ua.addEntityTween(a))}removeTweens(a,b){let c=this.Yb.getEntityById(a);null!=
c&&this.Ua.gp(c,b);if(null!=b&&(a=this.va.getEntityById(a),null!=a))for(let c of b)a.discardOwnComponent(c)}getTweenCount(a){a=this.Yb.getEntityById(a);return null!=a?this.Ua.un(a):0}getTweenedValue(a,b){a=this.va.getEntityById(a);return null!=a?a.get(b,!0):null}getTweenedComponent(a,b){a=this.va.getEntityById(a);return null!=a?a.getComponent(b,!0):null}createVisibilityAnimationHelper(a){let b=this.Ui(a);a=a+"-"+this.Yb.getName()+"-LastVisibilityKey";if(null!=this.Uc[b])return new Ma.Yf(this.Yb,this.Uc[b],
this.no[a]);let c=f.CetModel.createValueComponentKey(b,!1,!1),d=f.CetModel.createValueComponentKey(a,!1,!1);this.Uc[b]=c;this.no[a]=d;return new Ma.Yf(this.Yb,c,d)}Ui(a){return a+"-"+this.Yb.getName()+"-VisibilityKey"}getVisibilityKeys(){let a=[];for(let b in this.Uc)this.Uc.hasOwnProperty(b)&&a.push(this.Uc[b]);return a}hasVisibilityKey(a,b){b=this.Ui(b);a=this.va.getEntityById(a);b=this.Uc[b];return null!=a&&null!=b?a.hasComponent(b):!1}getVisibilityKey(a){a=this.Ui(a);return this.Uc[a]}getTweenMode(){return this.va.getTweenMode()}getNextFrameTime(){return this.Ua.getNextFrameTime()}needsFrameImmediately(){return this.Ua.needsFrameImmediately()}};
var M={};Object.defineProperty(M,"__esModule",{value:!0});var ta;(function(a){a[a.we=0]="Commit";a[a.ii=1]="Sync";a[a.Wf=2]="UntrackedCommitAndSync"})(ta=M.Dd||(M.Dd={}));var da;(function(a){a[a.None=0]="None";a[a.Uf=1]="System";a[a.Kf=2]="Cmd"})(da=M.qr||(M.qr={}));class Nc{constructor(a,b){this.Hw=a;this.changes=b}ln(){return"Uncommitted changes after sync, retry: "+this.Hw+", changes:\n"+this.changes.join("\n")}}M.ny=Nc;class Ua{constructor(a,b){this.delegate=a;this.onEnd=b}}M.Kf=Ua;class ia{constructor(a,
b=ia.Ot){this.intent=a;this.Rv=b;this.snapshotAfter=this.snapshotBefore=ia.jm;this.id=ia.rd++}static Ot(){}finish(a){this.Rv(a)}toString(){return`Transaction#${this.id}'${this.intent.name}'`}}ia.rd=0;ia.jm={reset:()=>{}};class Xc{constructor(a,b,c,d,g=!1){this.Ul=[];this.ea=null;this.Ig=!1;this.Re=null;this.$e=!1;this.Sh=[];this.zb=new Map;this.ie=[];this.Jc=da.None;this.Cf=!1;this.logger=t.LoggerModule.getLoggerManager().createLogger("UpdateableSceneImpl");this.lb=a;this.name=b;c=c||{updateList:[]};
this.ta={initList:c.initList||[],inflateList:c.inflateList||[],updateList:c.updateList||[],updateOnceList:c.updateOnceList||[],preRenderList:c.preRenderList||[],fixerList:c.fixerList||[],geometryUpdateList:null!=c.geometryUpdateList?c.geometryUpdateList:(c.updateList||[]).concat(c.updateOnceList||[])};this.aa=d;null!=this.aa&&this.aa.zw(this);g&&d.setAnimationScene(this);this.Qc=[];this.ek=p.Bacon.newBus();this.Yp=e.TweenMode.ANIMATION;null!=d?(d.onViewChange(()=>this.markViewChanged()),this.entities=
new La.Nf(this,this.$i(),this.aa,this.name+"-entitylist"),d.getImmediateChangeStream(null).onValue((a)=>{this.Qc=this.Qc.concat(a)})):this.entities=new La.Nf(this,this.$i(),null,this.name+"-entitylist");this.Ua=new Qb.es(this);this.mk(new Ba.ds);this.np();this.Kp()}tsto(){const a=(a)=>(null==a?[]:a).map((a)=>a.getName());return{name:this.getName(),ta:{initList:a(this.ta.initList),inflateList:a(this.ta.inflateList),updateList:a(this.ta.updateList),updateOnceList:a(this.ta.updateOnceList),preRenderList:a(this.ta.preRenderList),
fixerList:a(this.ta.fixerList)},children:this.Ul.map((a)=>a.tsto())}}getSceneHierarchy(){return this.lb}getRootScene(){return this.lb.getRootScene()}entityChanged(a,b,c,d){d&&this.Qc.push({kind:e.ChangeEventKind.Entity,selector:null,def:a.getDef(),type:c,entity:a,componentKey:b});this.Da.entityChanged(this,a,b,c)}getParentScene(){return this.aa}mk(a){this.Da=a}getUncommitedChanges(){return this.Da.getUncommitedChanges(this)}hasAnyUncommitedChange(){return this.Da.dj(this)}onViewChange(a){this.Sh.push(a);
return()=>{let b=this.Sh.indexOf(a);-1<b&&this.Sh.splice(b,1)}}markViewChanged(){for(let a of this.Sh)a()}getName(){return this.name}getEntityList(){return this.entities}getEntityById(a){return this.entities.getEntityById(a)}forEachEntities(a){this.getEntityList().forEach(a)}lookup(a,b){return this.entities.lookup(a,b)}runSystems(a){this.Ig=!0;let b=this.hasAnyUncommitedChange(),c=[];switch(a){case e.UpdatePhase.GEOMETRY:c=this.ta.geometryUpdateList;break;case e.UpdatePhase.DOCUMENT:c=[...this.ta.updateList,
...this.ta.updateOnceList];break;case e.UpdatePhase.UPDATE:c=this.ta.updateList;break;case e.UpdatePhase.UPDATE_ONCE:c=this.ta.updateOnceList;break;case e.UpdatePhase.FIXER:c=this.ta.fixerList;break;case e.UpdatePhase.PRE_RENDER:c=this.ta.preRenderList}for(let b of c||[])b.changesPdomComponents(a)||this.getSceneHierarchy().Bj.push(b),this.Gm(b,"update",()=>{b.update(this,a)}),b.changesPdomComponents(a)||this.getSceneHierarchy().Bj.pop();!b&&this.hasAnyUncommitedChange()&&this.Jc!==da.Kf&&(this.Jc=
da.Uf);this.Ig=!1}executeNoDomBatchUpdate(a){this.markViewChanged();this.Sc(e.UpdatePhase.UPDATE_ONCE,!1,[this.Eo(a)])}requestNoDomBatchUpdate(a,b){this.ie.push(this.Eo(a,b));this.markViewChanged()}Eo(a,b){return new Ua(()=>{try{this.getSceneHierarchy().fe++,a(this),this.getSceneHierarchy().fe--}catch(c){throw this.getSceneHierarchy().fe--,this.reset(!0),c;}},b)}rbuForTest(a,b){return this.Vj((b)=>{a(b,this)},b)}Vj(a,b){this.ie.push(new Ua(()=>{a(this,this.ea)},b));this.markViewChanged()}documentMerge(a,
b,c){this.Vj(()=>{this.Da.Bf(aa(a,"documentMerge"),this,(a)=>{(new Pb.Vr(c)).updatePrezi(b,a)});this.update()});this.update()}triggerSync(){this.rc_DONT_USE_THIS_METHOD_DISCUSS_WITH_API_TEAM(aa(this.ea,"triggerSync"))}requestCommitForTest(){return this.cp(aa(this.ea,"requestCommitForTest"))}rc_DONT_USE_THIS_METHOD_DISCUSS_WITH_API_TEAM(a){this.Tl(a.message);return this.cp(a)}cp(a){return new Promise((b)=>{this.ie.push(this.Yl(a,b));this.markViewChanged()})}Yl(a,b){if(this.Ig)throw Error("cannot requestCommit from a system");
return new Ua(()=>{this.Zl(a,ta.we);null!=this.va&&(this.updateEntitiesFromParentScene(),this.va.updateEntitiesFromParentScene())},b)}Zl(a,b){const c=this.Da.commit(a,this,b);null==this.aa||b===ta.we&&!c||(x.Utils.assert(0===this.aa.zb.size,"pendingRemoves on parent scene should be empty"),this.zb.forEach((a)=>a.attachToEntityList(this.aa.getEntityList())),this.aa.zb=new Map(this.zb),this.aa.pe(a,b),this.aa.zb.clear(),this.zb.forEach((a)=>a.attachToEntityList(this.getEntityList())));this.zb.clear();
this.Cf=this.Cf||this.Jc===da.Kf;this.Jc=da.None}pe(a,b){this.Zl(a,b);this.Hk()}Em(){this.commit(new ia({name:"commit for test",userIntentId:"",trigger:"machine"}))}commit(a){if(this.Ig)throw Error("cannot commit from a system");this.pe(aa(a,"commit"),ta.we)}update(a=e.UpdatePhase.UPDATE,b=!0){a===e.UpdatePhase.UPDATE&&this.Sc(e.UpdatePhase.UPDATE_ONCE,b);a===e.UpdatePhase.FIXER?this.Sc(e.UpdatePhase.FIXER,b):(null!=this.aa&&this.aa.update(a),a===e.UpdatePhase.TWEEN?this.Ua.update(this):(a===e.UpdatePhase.PRE_RENDER||
a===e.UpdatePhase.UPDATE_ONCE)&&this.runSystems(a))}Sc(a,b,c=null){null==c&&(c=this.ie);null!=this.aa&&this.aa.Sc(a,!1);let d=this.Da.getVersion();for(;;){this.Wo(b,c);this.runSystems(a);if(d!==this.Da.getVersion()||this.lb.Ts===this&&this.Jc===da.Uf)this.Jc===da.Uf&&this.Cf?this.pe(aa(this.ea,"system updates after command"),ta.ii):this.Jc!==da.Uf||this.Cf?this.pe(aa(this.ea,"command"),ta.ii):this.pe(aa(this.ea,"system updates without command"),ta.Wf),this.et(b);d=this.Da.getVersion();this.Cf=!1;
if(0===c.length)break}}et(a){for(let b=0;1E3>b;b++)if(0<this.ie.length&&this.Wo(a,this.ie),this.hasAnyUncommitedChange()){let a=new Nc(b+1,this.Da.getUncommitedChanges(this)),d={action:"cleanupUncommittedChangesAfterSync",object:"UpdateableSceneImpl",trigger:"machine",payload:{message:a.ln()}};if(999===b)throw a;0===b?this.logger.warn(d):this.logger.error(d);this.pe(aa(this.ea,"cleanupUncommittedChangesAfterSync"),ta.Wf)}}Sj(){null!=this.aa&&this.aa.Sj();this.ww()}ww(){var a={},b={};let c={},d=[];
for(let e=0;e<this.Qc.length;e++){let g=this.Qc[e],q=null==g.entity?null:g.entity.getId();if(null!=q)if(g.type===f.ChangeType.RemoveEntity){if(null!=this.entities.getEntityById(q)){a[q]=g;continue}}else if(g.type===f.ChangeType.AddEntity){if(null!=a[q]){b[q]=a[q];delete a[q];continue}}else if(g.type===f.ChangeType.ModifyComponent||g.type===f.ChangeType.RemoveComponent){let a=c[q];null==a&&(a={});a[g.componentKey.getName()]=g;c[q]=a;continue}d.push(g)}this.Qc=[];for(let b in a)a.hasOwnProperty(b)&&
d.push(a[b]);for(let c in b)b.hasOwnProperty(c)&&(a=b[c],a={kind:e.ChangeEventKind.Entity,type:f.ChangeType.ArrayPositionChange,entity:a.entity,selector:null,def:null==a.entity?null:a.entity.getDef(),componentKey:a.componentKey},d.push(a));for(var g in c)if(c.hasOwnProperty(g)){b=c[g];for(var q in b)b.hasOwnProperty(q)&&d.push(b[q])}g=[];for(let a in c)c.hasOwnProperty(a)&&(q=this.getEntityById(a),null!=q&&g.push(q));0<g.length&&d.push({kind:e.ChangeEventKind.EntitiesModified,type:f.ChangeType.ModifyEntity,
entity:null,entities:g,selector:null,def:null,componentKey:null});0<d.length&&this.ek.push(d)}Wo(a,b){let c=[];for(;;){for(this.Hk();0<b.length;){let a=b[0];b.shift();let e=this.hasAnyUncommitedChange();try{a.delegate()}catch(q){if(t.LoggerModule.logException(this.logger,this.name,"processPendingCommands",q),this.Rd)throw q;}!e&&this.hasAnyUncommitedChange()&&(this.Jc=da.Kf);null!=a.onEnd&&c.push(a.onEnd);this.Hk()}a&&this.Sj();this.qw(c);if(0===b.length)break}}Hk(){this.updateEntitiesFromParentScene();
this.runSystems(e.UpdatePhase.UPDATE)}qw(a){for(;0<a.length;){let b=a[0];a.shift();b()}}updateEntitiesFromParentScene(){this.entities.update(this.zb)}withPendingRemove(a,b){try{this.entities.$j=!0;const c=this.zb.get(a);null!=c&&b(c)}finally{this.entities.$j=!1}}reset(a=!0){this.Vl(a);for(const a of this.Cg())a.reset(this);this.np();this.Kp();this.$e=!1;this.updateEntitiesFromParentScene();this.runSystems(e.UpdatePhase.UPDATE);this.runSystems(e.UpdatePhase.UPDATE_ONCE);this.Ua.reset()}kill(){this.Vl(!0)}Vl(a){if(null!=
this.ea){const a=this.ea;this.ea=null;try{a.finish({reason:e.FinishEventKind.AbortTransaction})}catch(c){t.LoggerModule.logException(this.logger,"reset.abortTransaction","UpdateableSceneImpl",c)}}a&&this.entities.clear()}plugChangeStream(a){a.onValue((a)=>{this.Qc=this.Qc.concat(a)})}setIdleChangeStream(a){this.fj=a}getIdleChangeStream(a){if(null==this.fj)throw Error("Idle stream is not available for Scene: "+this.name);return null==a?this.fj:this.dm(this.fj,a)}getImmediateChangeStream(a){return null==
a?this.ek:this.dm(this.ek,a)}dm(a,b){return a.map((a)=>a.filter((a)=>a.kind===b)).filter((a)=>0<a.length)}deleteEntitiesById(a){for(var b=0;b<a.length;b++){const c=this.getEntityById(a[b]);null!=c&&c.getDef().getFieldDescriptors().forEach((b)=>{switch(b.kind){case f.FieldDescriptorKind.Child:var d=c.getUntypedComponent(b.fieldKey);null!=d&&a.push(d.getValue());break;case f.FieldDescriptorKind.ChildList:b=c.getUntypedComponent(b.fieldKey);if(null!=b)for(d of b.items())a.push(d);break;case f.FieldDescriptorKind.Reference:case f.FieldDescriptorKind.ReferenceList:case f.FieldDescriptorKind.ScalarList:case f.FieldDescriptorKind.Scalar:break;
default:throw x.Utils.assertNever(b.kind);}})}for(let c of a)b=this.getEntityList().deleteEntity(c),null!=b&&this.zb.set(c,b)}ld(){let a=this.getPrezi();return null==a?null:a.getMutableComponent(l.f.De)}executeRedo(a){this.execute(this.createIntent(Object.assign({name:"redo"},a)),()=>{this.Da.redo(this)&&null!=this.aa&&this.aa.Sc(e.UpdatePhase.UPDATE_ONCE,!1)})}Tl(a){this.hasAnyUncommitedChange()&&this.logger.error({action:"checkNoUncommittedChange",object:"UpdateableSceneImpl",trigger:"machine",
payload:{uncommitted:this.getUncommitedChanges().join("\n"),label:a}})}executeUndo(a){const b=this.createIntent(Object.assign({name:"undo"},a));this.execute(b,()=>{this.Tl(b.name);this.Da.undo(this)&&null!=this.aa&&this.aa.Sc(e.UpdatePhase.UPDATE_ONCE,!1)})}isUndoable(){return this.ld().isUndoable()}isRedoable(){return this.ld().isRedoable()}generateEntityId(){return this.ld().generateObjectId()}regenerateIDs(a){return this.ld().regenerateIDs(a)}useTestIdGenerator(a){this.ld().useTestIdGenerator(a)}getPrezi(){return this.entities.getPrezi()}getPreziW(){return this.getPrezi().getMutableWrapper(f.CetModel.ID.PREZI.W)}setPrezi(a){if(null!=
this.aa)throw Error("cannot set prezi entity on a child scene");if(a.getEntityList()!==this.entities)throw Error("entity is not in the entitylist");this.entities.cx(a.getId())}getPreziXml(){return m.DOM.saveXml(this.qn())}qn(){return this.getPrezi().getComponent(l.f.MODEL).getPdomObject()}getStyleDefinition(){return m.DOM.getStyleAsSource(this.qn().getDocumentStyle())}applyStyleDefinition(a,b){let c=m.DOM.parseStyleFromSource(b);this.Vj(()=>{this.Da.Bf(aa(a,"applyStyleDefinition"),this,(a)=>{a.updateDocumentStyle(c)});
this.update()})}setAnimationScene(a){this.va=a;null!=this.Re&&this.Re.setAnimationScene(this.va)}getAnimationScene(){return this.va}getTweener(){return this.aa.getAnimationScene()===this?this.aa.getTweener():null!=this.Ua?(null==this.Re&&(this.Re=new Rb.Qq(null!=this.va?this.va:this,this,this.Ua)),this.Re):null}getEntityTweenNumber(a){return this.Ua.un(a)}addEntityTween(a,b){let c=this.getTweener();null!=c&&c.addTween(a.getId(),b)}removeTweensOnEntity(a){let b=this.getTweener();null!=b&&b.removeTweens(a.getId())}setTweenMode(a){this.Yp=
a}getTweenMode(){return this.Yp}inflate(a,b,c){return this.jj(a,[b],this,c)[0]}inflateAll(a,b,c){return this.jj(a,b,this,c)}jj(a,b,c,d){null==d&&(d=()=>{});if(null!=this.aa){a=this.aa.jj(a,b,c,d);for(let b of a)this.entities.$o(b)}else a=this.Da.inflateAll(this,a,b,c);c===this&&d(a);this.mp(a);return a}dup(a){return this.qm(a,this)}qm(a,b){const c=this.aa;if(null!=c){a=c.qm(a,b);for(let b of a)this.entities.$o(b)}else a=this.Da.dup(this,a.map((a)=>a.asMutableEntity()),b);this.mp(a);return a}mp(a){for(let b of this.ta.inflateList)this.Gm(b,
"initializeEntities",()=>{b.initializeEntities(this,a)})}Gm(a,b,c){a=""+this.getName()+"/"+a.getName();try{c()}catch(d){t.LoggerModule.logException(this.logger,"scene",b,d,{system:a})}}Cg(){return(this.ta.initList||[]).concat(this.ta.inflateList||[]).concat(this.ta.updateList||[]).concat(this.ta.updateOnceList||[]).concat(this.ta.preRenderList||[]).concat(this.ta.fixerList||[])}np(){for(const a of this.Cg())a.init(this)}Kp(){for(const a of this.Cg())null!=a.getTriggerKeys&&this.entities.Op(a)}getMonitor(){return this.$i()}$i(){null==
this.La&&(this.La=new hb.el,null!=this.aa&&this.aa.getMonitor().addChildMonitor(this.La));return this.La}beginTransaction(a,b){return this.Ll(a,!0,b)}Ll(a,b,c){if(this.Rd)throw k.i.getEditorApiLogger().cannotStartTransactionBecauseAnOtherIsBeingExecuted(a.name,this.ea),new k.Xh(`Cannot start transaction with intent '${a.name}', because ${this.ea} is being executed.`);if(null!=this.ea)try{this.Ni(this.ea,{reason:e.FinishEventKind.BeginOtherTransaction},b,[])}catch(d){k.i.getEditorApiLogger().exceptionInTransactionEndWhenBeginOtherTransaction(d,
this.ea)}x.Utils.assert(null==this.ea,"transaction should be null");this.ea=new ia(a,c);c=this.ld();if(null!=c)try{this.ea.snapshotBefore=c.createSnapshot()}catch(d){t.LoggerModule.logException(this.logger,"UpdateableSceneImpl","snapshotBefore",d)}b&&this.logger.info({action:"beginTransaction",object:"UpdateableSceneImpl",trigger:a.trigger,payload:{transaction:this.ea.toString()}});return this.ea}endTransaction(a){this.Ni(a,{reason:e.FinishEventKind.EndTransaction},!0,[])}rollbackTransaction(a){if(this.ea!==
a)throw new k.If(`Cannot stop transaction ${a}, because an other transaction is in progress: ${this.ea}`);try{this.ea.finish({reason:e.FinishEventKind.RollbackTransaction})}catch(b){t.LoggerModule.logException(this.logger,"reset.abortTransaction","UpdateableSceneImpl",b)}this.ea=null;this.Da.rollback(this);this.zb.clear();this.updateEntitiesFromParentScene();this.runSystems(e.UpdatePhase.UPDATE);this.runSystems(e.UpdatePhase.UPDATE_ONCE)}Ni(a,b,c,d){if(this.ea!==a)throw new k.If(`Cannot stop transaction ${a}, because an other transaction is in progress: ${this.ea}`);
const g=Date.now();try{try{this.ea.finish(b)}catch(F){throw this.reset(!0),F;}const f=this.ld();if(null!=f)try{this.ea.snapshotAfter=f.createSnapshot()}catch(F){t.LoggerModule.logException(this.logger,"UpdateableSceneImpl","snapshotAfter",F)}try{const b=this.Yl(aa(this.ea),null);this.markViewChanged();this.Sc(e.UpdatePhase.UPDATE_ONCE,!1,[...d,b]);c&&this.logger.info({action:"endTransaction",object:"UpdateableSceneImpl",trigger:a.intent.trigger,payload:{intent:a.intent.name,transaction:a.toString(),
success:!0,elapsed_time_ms:Date.now()-g}})}catch(F){throw this.reset(!0),F;}}finally{this.ea=null}}isInTransaction(){return null!=this.ea}createIntent(a){null==a&&(a={});return{name:a.name,trigger:a.trigger||"machine",userIntentId:null==a.userIntentId?t.LoggerModule.getLoggerManager().generateUserIntentId():a.userIntentId}}execute(a,b){const c=Date.now();a=this.Ll(a,!1);this.Fm(a,b,!0);this.logger.info({action:"execute",object:"UpdateableSceneImpl",trigger:a.intent.trigger,payload:{intent:a.intent.name,
elapsed_time_ms:Date.now()-c}})}executeInTransaction(a,b){this.Fm(a,b,!1)}Fm(a,b,c){if(this.ea!==a)throw new k.ki("Transaction is not in progress");try{this.Rd=!0;const d=new Ua(()=>{b(this,this.ea)},null);this.markViewChanged();c?this.Ni(a,{reason:e.FinishEventKind.EndTransaction},!1,[d]):this.Sc(e.UpdatePhase.UPDATE_ONCE,!1,[d]);try{this.Sj()}catch(g){this.logger.error({action:"pushChanges",object:"UpdateableSceneImpl",trigger:"machine",payload:{message:g.ln()}})}}catch(d){throw this.reset(!0),
d;}finally{this.Rd=!1}}read(a){if(this.Rd)throw Error("can't read while an other command is executed");try{this.Rd=!0,this.getSceneHierarchy().fe++,a(this,new ia(this.createIntent({name:"read"}),()=>{}))}finally{this.getSceneHierarchy().fe--,this.Rd=!1}}zw(a){this.Ul.push(a)}}M.Xf=Xc;var ib={};Object.defineProperty(ib,"__esModule",{value:!0});ib.fl=class extends sa.Fd{constructor(a,b){super(a);this.Zj=b}createChildComponent(){let a=new ib.fl(this,this.Zj);a.version=this.version;return a}insert_Internal(a,
b){super.insert_Internal(a,b);this.Zj(this.U);this.incrementVersion()}removeAt_Internal(a){super.removeAt_Internal(a);this.Zj(this.U);this.incrementVersion()}};var Ca={};Object.defineProperty(Ca,"__esModule",{value:!0});Ca.Ce=class extends U.mb{constructor(a){super();this.Qo=a;null!=a&&(this.pdomId=a.getPDOMId())}createChildComponent(){return new Ca.Ce(this.Qo)}getPdomId(){return this.pdomId}getPdomObject(){return this.Qo}withPdomObject(a){return new Ca.Ce(a)}};var Sb={};Object.defineProperty(Sb,
"__esModule",{value:!0});Sb.Aq=class{constructor(){}createViewEntity(a){return new L.Qa(a)}createPdomComponent(a){return new Ca.Ce(a)}createVArrayComponent(){return new sa.Fd(null)}createChildComponent(){return new Ta.bi(null)}createChildrenComponent(){return new Ka.Rf(null)}createRefListComponent(a){return new Ja.Sf(null,a)}createRefComponent(a){return new Aa.ze(null,a)}createStyleClassesComponent(a){return new ib.fl(null,a)}};var Tb={};Object.defineProperty(Tb,"__esModule",{value:!0});Tb.Lr=class{constructor(a,
b){this.om=0;this.wf=!1;this.uh=0;this.pa=a;this.za=b;this.qc=new fb.ol(a);a.Nj.onValue(()=>{this.$e=!1;b.markViewChanged()});this.wp=p.Bacon.newBus();this.vd=f.CetModel.createPdomEventHandler(new Sb.Aq)}changesPdomComponents(){return!0}getDocument(){return this.pa.getPrezi()}Qu(){return this.vd.getStyleChangedEventStream().filter((a)=>a.componentKey!==f.CetModel.ID.STYLED.STYLE_CLASSES).map((a)=>[{kind:e.ChangeEventKind.StyleSheet,def:a.def,componentKey:a.componentKey,selector:a.selector,entity:null,
entities:null,type:f.ChangeType.ModifyComponent}])}getName(){return"PDOMObjectFactory"}getDocumentVersionInfoStream(){return this.vd.getDocumentVersionInfoStream()}ih(a){try{this.om++;const b=this.vd.handlePdomEvent(this.pa.getPrezi(),this.pa.ja,a);a.getEntityList().Bw();b&&this.Io(a)}catch(b){this.pa.Ln(b)}}Io(a){a=a.getPrezi();a.setComponent(l.f.De,this.qc);this.wp.push([{kind:e.ChangeEventKind.Document,def:null,componentKey:null,selector:null,entity:a,type:null}])}update(a){if(!this.$e){let b=
a.getEntityList();b.clear();b.We++;this.qc.discardEvents();this.vd.initFromDocument(this.pa.getPrezi(),a);this.$e=!0;this.Io(a)}this.wf&&(this.wf=!1,this.ih(a))}rf(){this.qc.rf();this.wf=!0;this.za.markViewChanged()}Px(a,b,c){return this.qc.ik(a,b,c).then((a)=>{this.wf=!0;this.za.markViewChanged();return a})}Bf(a,b,c){this.update(b);this.commit(a,b,M.Dd.we);c(this.pa.getPrezi());this.qc.Xl(a);this.ih(b)}undo(a){return this.qc.undo()?(this.ih(a),this.uh++,!0):!1}redo(a){return this.qc.redo()?(this.ih(a),
this.uh++,!0):!1}dj(){return!1}getUncommitedChanges(){return[]}entityChanged(){}rollback(){}commit(a,b,c){try{let d=()=>{this.vd.toPdom(b,b.getPrezi(),this.pa.getPrezi())};c===M.Dd.Wf?this.pa.ja.updateAndCommitWithoutHistoryTracking(d):d();this.qc.Xl(a)&&this.uh++;this.wf=!0;b.getEntityList().commit();c!==M.Dd.ii&&c!==M.Dd.Wf||this.qc.sync()}catch(d){this.pa.Ln(d)}return!0}getVersion(){return this.uh}init(){}reset(){this.$e=!1}getDocumentStamp(){return this.om}inflateAll(a,b,c,d){return this.vd.inflateAll(b,
c,this.pa.ja,a,d)}dup(a,b,c){return this.vd.dup(b,this.pa.ja,a,c)}};var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});Ub.us=class{constructor(a,b){this.Ic=a;this.iw=b;this.Ia=(a)=>this.av(a);a.addEventListener("touchstart",this.Ia);a.addEventListener("touchend",this.Ia);a.addEventListener("touchmove",this.Ia);a.addEventListener("mousedown",this.Ia);a.addEventListener("mousewheel",this.Ia);a.addEventListener("wheel",this.Ia);a.addEventListener("mousemove",this.Ia);a.addEventListener("mouseup",
this.Ia)}dispose(){this.Ic.removeEventListener("touchstart",this.Ia);this.Ic.removeEventListener("touchend",this.Ia);this.Ic.removeEventListener("touchmove",this.Ia);this.Ic.removeEventListener("mousedown",this.Ia);this.Ic.removeEventListener("mousewheel",this.Ia);this.Ic.removeEventListener("wheel",this.Ia);this.Ic.removeEventListener("mousemove",this.Ia);this.Ic.removeEventListener("mouseup",this.Ia)}av(a){a.preventDefault();switch(a.type){case "mouseup":case "touchend":case "doubletap":this.cv(a);
break;case "mousedown":case "touchstart":this.$u(a);break;case "mousemove":case "touchmove":this.bv()}}$u(a){a.stopPropagation()}cv(a){a.stopPropagation()}bv(){this.iw.Vv()}};var r={};Object.defineProperty(r,"__esModule",{value:!0});r.m=class{constructor(a){this.K=a;this.Sa=!1;this.Od=this.yc=0;this.Kg=this.oj=this.isVisible=this.Jg=this.Yn=!1}static resize(a){null!=r.m.da&&(r.m.da.setWidth(a.o.getWidth()-50),r.m.da.updateProgressBarWidth());null!=r.m.xa&&(r.m.xa.getElement().css("top",Math.floor((a.o.getHeight()-
r.m.xa.getElement().height())/2)+"px"),r.m.xa.getElement().css("left",Math.floor((a.o.getWidth()-r.m.xa.getElement().width())/2)+"px"))}static Hg(a){a.preventDefault();a.stopPropagation()}Zv(a){this.Up=a}Yv(a){this.seek=a}$v(a){this.Jh=a}setIsPlaying(a){this.Zd=a;this.Tc()}setIsMuted(a){this.Sa=a;this.Tc()}jk(a){this.Lh=a;this.Tc()}kk(){this.Yn=!0}setVideoType(a){this.videoType=a}pv(){r.m.Ad=this.K.o.createUIContainer("videoControls");this.qv();this.rv();r.m.resize(this.K)}qv(){r.m.da=this.K.video.getVideoControlUI();
this.K.o.insertUIElement(r.m.Ad,r.m.da.getElement());r.m.da.getElement().css("bottom","30px");r.m.da.getElement().css("left","25px")}rv(){r.m.xa=this.K.video.getPlayButtonUI();this.K.o.insertUIElement(r.m.Ad,r.m.xa.getElement())}propagateEvent(){this.K.video.propagateEvent({videoType:this.videoType,videoTotalDuration:this.Lh,eventType:this.Zd?T.VideoEventType.Play:T.VideoEventType.Pause,videoPlayPosition:this.yc})}Tc(){null!=r.m.da&&this.isVisible&&(r.m.da.getLength()!==this.Lh&&r.m.da.setLength(this.Lh),
r.m.da.getIsMuted()!==this.Sa&&r.m.da.setIsMuted(this.Sa),r.m.da.getPlaybackPosition()!==this.yc&&(2<Math.abs(r.m.da.getPlaybackPosition()-this.yc)&&this.propagateEvent(),r.m.da.animatePlaybackPosition(this.yc)),r.m.da.getBufferPosition()!==this.Od&&r.m.da.setBufferPosition(this.Od),r.m.da.getIsPlaying()!==this.Zd&&(this.propagateEvent(),null!=r.m.xa&&(this.Zd?r.m.xa.getElement().fadeOut(100):r.m.xa.getElement().show().fadeTo(100,.9)),r.m.da.setIsPlaying(this.Zd)));null!=r.m.xa&&r.m.xa.getIsHighlight()!==
this.Jg&&r.m.xa.setIsHighlight(this.Jg)}show(){null==window.document.getElementById("videoControls")&&this.pv();this.qk(!0);$(r.m.Ad).on("mousemove",()=>this.Ep());r.m.da.getElement().on("mouseup mousedown mousemove",r.m.Hg);r.m.da.getPlayButton().on("click",this.Jh);r.m.da.getVolumeButton().on("click",this.Up);r.m.da.getProgressBar().on("click",(a)=>this.Fn(a));r.m.da.getElement().on("mouseenter",()=>this.Cn());r.m.da.getElement().on("mouseleave",()=>this.Dn());r.m.xa.getElement().on("mouseenter",
()=>this.zn());r.m.xa.getElement().on("mouseleave",()=>this.An());r.m.xa.getElement().on("mouseup mousedown mousemove",r.m.Hg);r.m.xa.getPlayButton().on("click",this.Jh);this.Tc()}qk(a){this.isVisible=a}Cn(){this.oj=!0}Dn(){this.oj=!1}Ep(){null!=this.Gn&&this.Gn.stop();this.Gn=x.Utils.delay(()=>this.Zu(),3E3);this.isVisible&&!this.Kg&&(r.m.da.setPlaybackPosition(this.yc),r.m.da.setBufferPosition(this.Od),$(r.m.Ad).fadeIn(100),this.Kg=!0)}Zu(){this.Zd&&!this.oj&&($(r.m.Ad).fadeOut(400),this.Kg=!1)}zn(){this.Jg=
!0;this.Tc()}An(){this.Jg=!1;this.Tc()}Rh(a){null!=a&&(this.yc=a);this.Tc()}Fn(a){this.Yn&&(a=(a.pageX-r.m.da.getProgressBar().offset().left)/r.m.da.getProgressBar().width()*this.Lh,this.Od>a&&this.seek(a))}Gk(a){this.Od=null!=this.Od?a:0;this.Tc()}hide(){null!=r.m.Ad&&($(r.m.Ad).fadeOut(300),this.isVisible=this.Kg=!1,r.m.da.getElement().off("mouseup mousedown mousemove",r.m.Hg),r.m.da.getPlayButton().off("click",this.Jh),r.m.da.getVolumeButton().off("click",this.Up),r.m.da.getProgressBar().off("click",
(a)=>this.Fn(a)),r.m.da.getElement().off("mouseenter",()=>this.Cn()),r.m.da.getElement().off("mouseleave",()=>this.Dn()),r.m.xa.getElement().off("mouseenter",()=>this.zn()),r.m.xa.getElement().off("mouseleave",()=>this.An()),r.m.xa.getElement().off("mouseup mousedown mousemove",r.m.Hg),r.m.xa.getPlayButton().off("click",this.Jh))}};var B={};Object.defineProperty(B,"__esModule",{value:!0});var Vb;(function(a){a[a.hr=0]="INITIALIZING";a[a.Gd=1]="STOPPED";a[a.BUFFERING=2]="BUFFERING";a[a.PAUSED=3]="PAUSED";
a[a.PLAYING=4]="PLAYING"})(Vb=B.VideoState||(B.VideoState={}));class Y extends U.mb{constructor(a,b,c){super();a.getEntity().setComponent(l.f.VIDEO,this);this.jc=a.getId();this.onlineAssetId=a.getOnlineAssetId();this.onlineAssetUrl=a.getOnlineAssetUrl();this.offlineAssetId=a.getOfflineAssetId();this.status=Vb.hr;this.Sd=this.zc=this.Kb=!1;this.O=new r.m(b);this.O.$v(()=>this.gv());this.O.Yv((a)=>this.ev(a));this.O.Zv(()=>this.fv());this.K=b;this.za=c}init(){}static create(a,b,c,d){switch(a.getVideoType()){case "youtube":b=
new ea.vc(a,b,c);break;case "vimeo":b=new ua.Ld(a,b,c);break;case "video":b=new z.ba(a,b,c);break;default:t.LoggerModule.getLoggerManager().log("ZVideoPeer",t.Level.ERROR,{action:"unknown_video_type ",object:"video",trigger:"machine",payload:{video_type:a.getVideoType()}}),b=null}b.Uw(d);b.O.setVideoType(a.getVideoType());return b}dispose(){this.zc||(this.K.o.removeElement(this.sa),this.K.o.removeElement(this.sa+"_info"),this.zc=!0)}gv(){this.O.Zd?this.pauseVideo():this.playVideo()}fv(){this.O.Sa?
(this.O.setIsMuted(!1),this.setMute(!1)):(this.O.setIsMuted(!0),this.setMute(!0))}ev(a){this.seekTo(a)}Vv(){this.O.Ep()}onFocus(){this.Kb=!0;this.O.show();this.playVideo();this.fadeIn()}onLostFocus(){this.gw();this.Kb=!1;this.pauseVideo();this.O.hide();this.fadeOut()}gw(){this.Kb=!1;this.pauseVideo();this.O.hide();this.K.o.setElementAlpha(this.sa,0)}getStatusName(){return Vb[this.status]}fadeIn(){this.Sd=!0;this.K.Hc.fadeIn((a)=>{!this.zc&&this.Sd&&this.K.o.setElementAlpha(this.sa,a,!0)},Y.Sq)}fadeOut(){this.Sd=
!1;this.K.Hc.fadeOut((a)=>{this.zc||this.Sd||this.K.o.setElementAlpha(this.sa,a)},Y.Tq)}getCurrentTime(){throw Error("Not implemented");}td(){r.m.resize(this.K)}refresh(){!this.Sd||this.K.o.getWidth()===this.be&&this.K.o.getHeight()===this.ae||(this.be=this.K.o.getWidth(),this.ae=this.K.o.getHeight(),this.td())}playVideo(){throw Error("Not implemented");}pauseVideo(){throw Error("Not implemented");}setMute(){throw Error("Not implemented");}seekTo(){throw Error("Not implemented");}getWidth(){return this.width}setWidth(a){this.width=
a}getHeight(){return this.height}setHeight(a){this.height=a}get zf(){return this.U.getComponent(h.CetRendererModule.getDrawComponentKey())}nh(){this.zf.setupDefaultThumbnail(this.U,this.width,this.height);this.za.markViewChanged()}Ej(a){this.zf.setupImageThumbnail(this.U,a,this.width,this.height);this.za.markViewChanged()}wh(a){null!=this.Fb&&this.Fb.push(a)}Uw(a){this.Fb=a}}B.Eb=Y;Y.Sq=600;Y.Tq=300;Y.Mf=320;Y.Lf=240;Y.Hq=80;Y.Gq=66;Y.Fq=24;Y.Eq=32;var ea={wm:function(){return z.ba.prototype&&ua.Ld.prototype&&
ea.vc.prototype}};Object.defineProperty(ea,"__esModule",{value:!0});ea.vc=class extends B.Eb{constructor(a,b,c){super(a,b,c);this.Sa=!1;this.To=T.YoutubePlayerState.UNSTARTED;this.Oc=this.Nh=!1;this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZVideoYoutubePeer");this.setWidth(ea.vc.Mf);this.setHeight(ea.vc.Lf);c="https://yt.preziusercontent.com/"+a.getOnlineAssetId()+"/0.jpg";a=a.getId();b.bb.imageAssetFromUrl(c,a).then((a)=>{this.Ej(a)},()=>{this.nh()});this.sa="video_youtube_"+
a;this.Uh="youtube_"+a;this.hg=this.Qj=0}getCurrentTime(){try{return this.ga.getCurrentTime()}catch(a){return 0}}jd(){let a=this.K.o.createElement(this.sa);a.style.display="block";a.style.left="-9999px";a.style.position="absolute";a.style.background="black";let b=window.document.createElement("div");b.id=this.Uh;b.style.zIndex="100";b.style.position="relative";b.style.top="65px";b.style.left="60px";a.appendChild(b);this.mj()}onReady(){this.Oc=!0;this.status=B.VideoState.Gd;this.setMute(this.Sa);this.O.setIsMuted(this.Sa);
this.O.kk();this.Kb&&this.playVideo()}playVideo(){if(this.Kb)if(null==this.ga)this.jd();else{try{this.Oc&&(t.avro.Avro.createDefaultLogger().logNavigatePrezi({navigation_type:"START_VIDEO",action_index:-1,step_index:-1,total_step_number:-1}),this.ga.playVideo(),this.Nh=!0)}catch(a){this.logger.error({action:"play_error",object:"youtube_player",trigger:"machine",payload:{error:a.toString()}});return}this.status=B.VideoState.BUFFERING}}pauseVideo(){if(null!=this.ga){try{this.Oc&&this.ga.pauseVideo()}catch(a){this.logger.error({action:"pause_error",
object:"youtube_player",trigger:"machine",payload:{error:a.toString()}});return}this.O.setIsPlaying(!1,this.getCurrentTime());this.status=B.VideoState.PAUSED}}onStateChange(){let a=this.ga.getPlayerState();if(T.YoutubePlayerState.PLAYING===a){let a=this.ga.getDuration();this.O.jk(a);this.Qj=this.Ap(()=>this.ge(),400);this.hg=this.Ap(()=>this.jf(),600);this.status=B.VideoState.PLAYING;this.O.setIsPlaying(!0,this.getCurrentTime())}else T.YoutubePlayerState.ENDED===a?(this.ge(),this.Me(this.Qj),this.Me(this.hg),
this.O.setIsPlaying(!1,this.getCurrentTime()),this.ga.clearVideo(),window.focus()):T.YoutubePlayerState.PLAYING!==a&&(this.O.setIsPlaying(!1,this.getCurrentTime()),this.Me(this.Qj),this.Me(this.hg));a===T.YoutubePlayerState.UNSTARTED&&this.To===T.YoutubePlayerState.BUFFERING&&this.Nh&&(this.Kb&&!this.Sa&&(this.setMute(!0),this.ga.playVideo()),this.Nh=!1);if(a===T.YoutubePlayerState.PLAYING||a===T.YoutubePlayerState.PAUSED||a===T.YoutubePlayerState.ENDED)this.Nh=!1;this.To=a}setMute(a){try{!0===a?
(this.Sa=!0,this.Oc&&this.ga.mute()):(this.Sa=!1,this.Oc&&this.ga.unMute())}catch(b){this.logger.error({action:"mute_error",object:"youtube_player",trigger:"machine",payload:{error:b.toString()}})}}ge(){this.O.Rh(this.ga.getCurrentTime())}jf(){let a=this.ga.getDuration()*this.ga.getVideoLoadedFraction();this.O.Gk(a);.99<this.ga.getVideoLoadedFraction()&&this.Me(this.hg)}td(){super.td();$("#"+this.sa).width(this.be).height(this.ae);$("#"+this.Uh).width(this.be-120).height(this.ae-100)}onError(a){this.logger.error({action:"youtube_error",
object:"youtube_player",trigger:"machine",payload:{vy:a.data}});this.O.qk(!1)}seekTo(a){null!=this.ga&&(this.ga.seekTo(a,!0),this.O.Rh(a))}mj(){var a=this.K.o.getWidth();let b=this.K.o.getHeight();a={width:a,height:b,videoId:this.onlineAssetId,playerVars:{controls:this.K.video.getControlVisibility()?1:0,fs:0,modestbranding:1,showinfo:0,html5:1,iv_load_policy:3,rel:0},events:{onReady:(a)=>this.onReady(a),onStateChange:(a)=>this.onStateChange(a),onError:(a)=>this.onError(a)}};this.ga=this.K.video.initializeYoutubePlayer(this.Uh,
a);document.body.tabIndex=-1;$(document.body).focusout(()=>{setTimeout(()=>{document.activeElement.id===this.Uh&&$(document.body).focus()},0)})}Ap(a,b){return setInterval(a,b)}Me(a){0!==a&&clearInterval(a)}};ea.vc.Mf=320;ea.vc.Lf=240;var ua={wm:function(){return z.ba.prototype&&ua.Ld.prototype&&ea.vc.prototype}};Object.defineProperty(ua,"__esModule",{value:!0});ua.Ld=class extends B.Eb{constructor(a,b,c){super(a,b,c);c=a.getId();this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZVideoVimeoPeer");
this.setWidth(ua.Ld.Mf);this.setHeight(ua.Ld.Lf);this.sa="video_vimeo_"+c;this.Df="vimeo_"+c;a="//vimeo.com/api/v2/video/"+a.getOnlineAssetId()+".json";b=b.assetManager.createJSONFetcher(a).fetch();b.onValue((a)=>this.bw(a));b.onError(()=>this.cw())}bw(a){this.Pl=!0;let b=a[0].thumbnail_large;this.O.jk(a[0].duration);this.Zt(b)}Zt(a){this.K.bb.imageAssetFromUrl(a,this.jc).then((a)=>{this.Ej(a)},()=>{this.nh()})}cw(){this.Pl=!1;this.nh()}getCurrentTime(){return this.currentTime}jd(){this.Ff=this.K.o.createElement(this.sa);
this.Ff.style.left="-9999px";this.Ff.style.position="absolute";this.Ff.style.display="block";this.Ff.style.background="black";this.K.o.createIFrame(this.Df,"//player.vimeo.com/video/"+this.onlineAssetId+"?api=1&player_id="+this.Df+"&portrait=0&title=0",this.K.o.getWidth()-120,this.K.o.getHeight()-100,this.Ff);let a=window.document.getElementById(this.Df);a.style.zIndex="100";a.style.position="relative";a.style.top="65px";a.style.left="60px";this.mj()}onReady(){this.status=B.VideoState.Gd;this.currentTime=
0;this.ga.addEvent("play",()=>this.Gj());this.ga.addEvent("pause",()=>this.Fj());this.ga.addEvent("finish",()=>this.Cj());this.ga.addEvent("playProgress",(a)=>this.ge(a));this.ga.addEvent("loadProgress",(a)=>this.jf(a));this.O.setIsMuted(!1);this.O.kk();this.playVideo()}playVideo(){this.Pl||this.O.qk(!1);if(this.Kb)if(null==this.ga)this.jd();else try{this.ga.playVideo()}catch(a){this.logger.error({action:"play_error",object:"vimeo_player",trigger:"machine",payload:{error:a.toString()}})}}pauseVideo(){if(null!=
this.ga)try{this.ga.pauseVideo()}catch(a){this.logger.error({action:"pause_error",object:"vimeo_player",trigger:"machine",payload:{error:a.toString()}})}}seekTo(a){null!=this.ga&&this.ga.seekTo(a)}ge(a){this.currentTime=a=a.seconds;this.O.Rh(a)}jf(a){this.O.Gk(a.duration*a.percent);1===a.percent&&this.ga.removeEvent("loadProgress")}Cj(){this.O.setIsPlaying(!1,this.getCurrentTime())}td(){super.td();$("#"+this.sa).width(this.be).height(this.ae);$("#"+this.Df).width(this.be-120).height(this.ae-100)}Fj(){this.O.setIsPlaying(!1,
this.getCurrentTime());this.status=B.VideoState.PAUSED}setMute(a){try{!0===a?this.ga.setVolume(0):this.ga.setVolume(1)}catch(b){this.logger.error({action:"mute_error",object:"vimeo_player",trigger:"machine",payload:{error:b.toString()}})}}Gj(){this.O.setIsPlaying(!0,this.getCurrentTime());this.status=B.VideoState.BUFFERING}mj(){this.ga=this.K.video.initializeVimeoPlayer(this.Df,(a)=>this.onReady(a))}};var z={wm:function(){return z.ba.prototype&&ua.Ld.prototype&&ea.vc.prototype}};Object.defineProperty(z,
"__esModule",{value:!0});z.ba=class extends B.Eb{constructor(a,b,c){super(a,b,c);this.Ng=this.Sa=this.Oc=!1;this.th=this.sh=0;this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZVideoUriPeer");try{this.setWidth(z.ba.WIDTH),this.setHeight(z.ba.HEIGHT),this.sa="video_url_"+a.getId(),this.cq()}catch(d){this.logger.error({action:"cannot_create_video_peer",object:"uri_player",trigger:"machine",payload:{error:d.toString()}}),this.zf.setError()}}static sn(a,b){let c={width:z.ba.WIDTH,
height:z.ba.HEIGHT};a/b>z.ba.WIDTH/z.ba.HEIGHT?(c.width=z.ba.WIDTH,c.height=Math.round(z.ba.WIDTH/a*b)):(c.height=z.ba.HEIGHT,c.width=Math.round(z.ba.HEIGHT/b*a));return c}getCurrentTime(){try{return this.ia.getVideoTime()}catch(a){return 0}}jd(){try{null==this.ia&&(this.ia=this.K.o.createVideoPlayer(this.sa,this.jc,this.K.assetManager.getUrlRewriter().rewriteVideoUrl(this.onlineAssetUrl),this.K.o.getWidth(),this.K.o.getHeight(),null),this.ia.hookIntoRejectedPlay((a)=>{this.Xv(a)}),this.ia.bind("error",
(a,b,c)=>this.onError(a,b,c)),this.ia.bind("ready",()=>this.Wv()),this.ia.bind("resume",()=>this.Gj()),this.ia.bind("pause",()=>this.Fj()),this.ia.bind("finish",()=>this.Cj()),this.ia.bind("progress",(a,b,c)=>this.ge(a,c)),this.ia.bind("buffer",(a)=>this.jf(a)),new Ub.us(window.document.getElementById(this.sa),this))}catch(a){this.logger.error({action:"cannot_create_player_element",object:"uri_player",trigger:"machine",payload:{error:a.toString()}}),this.zf.setError()}}onError(a,b,c){this.logger.error({action:"flowplayer_error",
object:"uri_player",trigger:"machine",payload:{error:x.Utils.stringify(c)}});this.Sd&&this.wh(z.ba.rs);this.removeVideoPlayer()}Wv(){var a=this.ia.getVideoWidth();let b=this.ia.getVideoHeight();this.yp(a,b);this.status=B.VideoState.Gd;this.Oc=!0;this.setMute(this.Sa);a=this.ia.getSeekable();null!=a&&0<a&&this.O.kk();this.O.setIsMuted(this.Sa);this.O.jk(this.ia.getVideoDuration());0<this.lo?this.ia.seek(this.lo,()=>this.Ro()):this.Ro();this.za.markViewChanged()}Ro(){this.xh();this.Kb?this.playVideo():
this.pauseVideo()}yp(a,b){0===this.th&&0===this.sh&&(a=z.ba.sn(a,b),this.th=a.width,this.sh=a.height,this.setWidth(this.th),this.setHeight(this.sh))}Ej(){throw Error("Not used");}Uv(a){this.incrementVersion();this.zf.setupImageThumbnail(this.U,a,this.th,this.sh);this.zx()}Tv(a){this.K.bb.imageAssetFromImage(a,this.jc).then((b)=>{this.yp(a.width,a.height);this.Uv(b)},()=>{this.cq()})}zx(){this.jd();this.za.markViewChanged()}Jk(){this.K.Yx.Nx(this.sa,(a)=>this.Tv(a))}cq(){this.nh();this.za.markViewChanged()}playVideo(){null==
this.onlineAssetUrl&&(this.onlineAssetUrl=this.U.getWrapper(f.CetModel.ID.Z_VIDEO.W).getOnlineAssetUrl());if(this.Kb&&null!=this.onlineAssetUrl){this.Sw();this.jd();try{this.ia.getSplashState()&&this.ia.load(),t.avro.Avro.createDefaultLogger().logNavigatePrezi({navigation_type:"START_VIDEO",action_index:-1,step_index:-1,total_step_number:-1}),this.ia.resume()}catch(a){this.logger.error({action:"resume_error",object:"uri_player",trigger:"machine",payload:{error:a.toString()}})}}}Xv(a){a.name&&"NotAllowedError"===
a.name&&this.Kb&&!this.Sa&&(this.setMute(!0),this.O.setIsMuted(!0),this.ia.resume())}td(){super.td();$("#"+this.sa+" .flowplayer").width(this.be).height(this.ae)}pauseVideo(){if(null==this.onlineAssetUrl)this.onlineAssetUrl=this.U.getWrapper(f.CetModel.ID.Z_VIDEO.W).getOnlineAssetUrl();else{this.jd();try{this.ia.pause(),this.lo=this.getCurrentTime(),this.Jk()}catch(a){this.logger.error({action:"pause_error",object:"uri_player",trigger:"machine",payload:{error:a.toString()}})}}}setMute(a){try{this.Sa=
a,this.Oc&&this.ia.mute(a)}catch(b){this.logger.error({action:"mute_error",object:"uri_player",trigger:"machine",payload:{error:b.toString()}})}}seekTo(a){null!=this.ia&&this.ia.seek(a,null)}Gj(){this.status=B.VideoState.PLAYING;this.xh();this.O.setIsPlaying(!0,this.getCurrentTime())}Fj(){this.status=B.VideoState.PAUSED;this.O.setIsPlaying(!1,this.getCurrentTime())}Cj(){this.O.setIsPlaying(!1,this.getCurrentTime())}ge(a,b){this.O.Rh(b);this.Kb||this.pauseVideo()}jf(){null!=this.ia&&this.O.Gk(this.ia.getVideoBuffer())}removeVideoPlayer(){this.xh();
null!=this.ia&&(this.ia.unload(),this.K.o.removeVideoPlayer(this.sa),this.ia=null)}fadeOut(){this.xh();this.wh(z.ba.qs);super.fadeOut()}dispose(){if(!this.zc){try{this.removeVideoPlayer()}catch(a){this.logger.error({action:"cannot_dispose_video_peer",object:"uri_player",trigger:"machine",payload:{error:a.toString()}})}super.dispose()}}getId(){return this.jc}Sw(){!1===this.Ng&&(this.Ng=!0,this.wh(z.ba.VIDEO_LOADING_STARTED))}xh(){!0===this.Ng&&(this.Ng=!1,this.wh(z.ba.VIDEO_LOADING_FINISHED))}};z.ba.WIDTH=
480;z.ba.HEIGHT=270;z.ba.Pr=120;z.ba.Or=90;z.ba.Nr=36;z.ba.Mr=48;z.ba.VIDEO_LOADING_STARTED="videoLoadingStarted";z.ba.VIDEO_LOADING_FINISHED="videoLoadingFinished";z.ba.rs="videoLoadingError";z.ba.qs="videoFadeOut";var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});Wb.xs=class{constructor(a){this.Ka=null;this.queue=x.Utils.createLinkedList();this.o=a}Dw(a){null!=a&&(this.Ka=a,this.Ka.sa+="_thumbnail",this.Ka.objectId+="_thumbnail",a=this.o.createVideoPlayer(this.Ka.sa,this.Ka.objectId,this.Ka.Hy,
this.o.getWidth(),this.o.getHeight()),a.isHtml5()?(a.bind("error",(a,c,d)=>this.handleError(a,c,d)),a.bind("ready",()=>this.dv())):(this.Ka.Jo(),this.wg()))}Nx(a,b){a=this.qp(a);null!=a&&0<a.width&&0<a.height&&b(a)}dv(){let a=this.qp(this.Ka.sa);null!=a?this.Ka.Dy(a):this.Ka.Jo();this.wg()}qp(a){a=this.o.getVideoElement(a);let b=null;if(null!=a){let c=z.ba.sn(a.videoWidth,a.videoHeight);b=h.CetRendererModule.createCanvas(c.width,c.height);b.getContext("2d").drawImage(a,0,0,a.videoWidth,a.videoHeight,
0,0,c.width,c.height)}try{return b.toDataURL(),b}catch(c){return null}}handleError(){this.Ka.Jo();this.wg()}wg(){this.lg();this.tx()}lg(){null!=this.Ka&&this.o.removeVideoPlayer(this.Ka.sa)}tx(){this.queue.isEmpty()?this.Ka=null:this.Dw(this.queue.pop())}reset(){this.queue.clear();this.wg()}};var Da={};Object.defineProperty(Da,"__esModule",{value:!0});Da.ve=class{constructor(){null==Da.ve.Ed&&(Da.ve.Ed=t.LoggerModule.getLoggerManager().createLogger("BoundCalculationSystem"))}initializeEntities(a,
b){for(let c of b)this.select(c,a)&&h.CetRendererModule.updateBounds(c)}getName(){return"BoundsCalculationSystem"}select(a){return a.hasComponent(h.CetRendererModule.getDrawComponentKey())}getTriggerKeys(){return[...h.CetRendererModule.getBoundsComponentKeys(),l.f.Aa,h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.getInEditFontSizeComponentKey(),h.CetRendererModule.getHidePlaceHolderTextKey()]}process(a){for(let b of a)try{h.CetRendererModule.updateBounds(b)}catch(c){h.CetRendererModule.logMonitoringOncePerSession(Da.ve.Ed,
b.getId(),"invalid_local_bounds","transform",c),b.dispose()}}reset(){}changesPdomComponents(){return!1}getRequiredKeysForIndirectTrigger(){return[h.CetRendererModule.getLocalBoundsComponentKey()]}};var Xb={};Object.defineProperty(Xb,"__esModule",{value:!0});Xb.Pq=class{constructor(a){this.Cc=a}getName(){return this.Cc.getName()}update(a){this.j=a;a.getEntityList().forEachMutable((a)=>this.process(a),this);this.j=null}select(a){return this.Cc.select(a)}process(a){this.Cc.process(a,this.j)}getTriggerKeys(){return[f.CetModel.getNewEntityCompKey()]}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return!1}reset(){}initializeEntities(a,
b){e.Cet.isInflator(this.Cc)&&this.Cc.initializeEntities(a,b)}init(a){e.Cet.isSystemInit(this.Cc)&&this.Cc.init(a)}changesPdomComponents(){return this.Cc.changesPdomComponents()}};var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.tc=class{constructor(a){this.cf=!1;this.Ub=a;e.Cet.hasIndirectTriggerConfig(this.Ub)?this.Zo=this.Ub.getRequiredKeysForIndirectTrigger():this.Zo=[]}getName(){return this.Ub.getName()}update(a,b){if(null!=this.j&&this.j!==a)throw Error("EntityShaperSystem updates on different scene than original!");
this.j=a;a.getEntityList().forChangedMutableEntities((a)=>this.process(a,b),this)}process(a,b){this.Ub.process(a,this.j,b)}select(a){return this.Ub.select(a,this.j)}getTriggerKeys(){let a=this.Ub.getTriggerKeys();this.cf=-1!==a.indexOf(f.CetModel.getRemovedEntityCompKey());return a}getRequiredKeysForIndirectTrigger(){return this.Zo}isTrackingRemovedEntity(){return this.cf}reset(){}initializeEntities(a,b){this.Ub.initializeEntities(a,b.filter((a)=>this.select(a)))}init(a){this.j=a;e.Cet.isSystemInit(this.Ub)&&
this.Ub.init(a)}changesPdomComponents(a){return this.Ub.changesPdomComponents(a)}};var jb={};Object.defineProperty(jb,"__esModule",{value:!0});jb.al=class{constructor(a,b,c,d){this.bb=a;this.o=b;this.Md=d;this.Ko={componentKey:f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL,Nk:{}};this.Sp={componentKey:this.Md.getKey(),Nk:{}};this.lv=e.Cet.createImagePatcher(c);this.hw=e.Cet.createPdfPatcher(c);a=document.createElement("img");a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAYAAACLz2ctAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQ0SURBVHgB7d2PcdMwFMfxZyboCCkTNBPQMAHZIJ2g9BiAZAKSCQgbdIMGBoAyQTwCG5ins0pDLv+cWHq29P3c6VK41DTld3qSLcsiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIrJJKqqq705V7brW/onmdt86IovkkkUQKo4Rvoy5O2gaAPSm0jDWIpgcUK4FoIX9+U2oYawj8S0BsJTMM3EcLXRwNtHyWw4AGUetyHfnongQUvwdoDVoLe0hIcNCMxekBgLwIIUwQQpgggTBFAmCKAMEUAYYoAwhQBhCkCCFME0I5bZTKTetlT4S95DbVFW4vXBVwLtlHKgfV2XVo/GfpaMAG0cX1ssacP4S9tV2KIxQjpWZ6y0ti/ZyGJI4DxNQnVShJHCY6saUmz/v1RgpE0AhiZdmi3Dd57I4kjgPHdNnhv8JuCrDEGjM+dgB6eeBpmLcYYA6bHndd78gHbaeNEdPIIoI2BtrUG7evmOM+ND7V9lvoE9EAyQAnebSl1T/VBMseluPhKbSOpx2rZ9ET7MAaMb+omCH5PlDtBUATwf4vNrcn065VkcD3WEiX4VSk7doPy+xpmW4opwfGMdm1FRikOiwDWZodODFOKw6EEa+nVgF2f8kb9KK4UJ399dhMlOLxRg/dSiluWewBnTfZB1ve6TbwfBK3JuQSfXHq36Udy12lvJQOU4DDczLZJ6d1254+BC+UawEald5v/3plcbiGZz65zLMHurrRWJhMXluJn/TmG/jidnV1TgttVSjs914tzS3Gpbbzx57H/u+zkFsBp0eLTf/yxzulNx5s/h/96LBnKKYDLEM9A02M+6stjg2958Kdzto/DKZ4Qqm5YVweWwLfwGa/8v3HM/IRjzasOkcBymYRMisBPgKzq2y0P3cfxb9JxwrE6MylhEnK5RRHh8aNHFiyU0myMl82kJPUesJQIT3x8Ue1fOzjcNe47cqwbfyxT9ICXGcUKn7Nn7eBD0/D5YzEpaUNlZypGqteJxNFJR4NjmZDAUi3BZy80aIt+bHfaZyItqAwnJdyWeZ7rNk84W6sMt+xlDNjcLKXwOSlfKUmtBzQvvSHpr9LtlvVFIqIHPN2la/w6T7PgJjVJLd9KKYDJld5d9DO6XrDxaZ2uSiWAS9875CKZKyUpjAFLOfDQl1RV9ZWSnxL4/5Ax4HHT3MLn/db2SXqOG9NxED0gkkYAYYoAwhQBhCkCCFMEEKYIIEwRQJgigDBFAGGKAMIUAYQpAghTBBCmYgRwJeir4FuDxAjgd0FfBb8BKsaC1Kwf9tdj66Io3kpgwXtAv2GPu12yFPTFWtt7iSB4D7hJe8OJvtxLZs9b8/pwa8JK2w9t85i7igEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI6y8DFXvE/fvsgQAAAABJRU5ErkJggg==";
this.pm=this.bb.imageAssetFromImage(a,"placeholderImageAssetId")}getName(){return"ImageInitSystem"}Xt(a,b){for(let c of a)c.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)?this.St(c,b):(c.isDef(f.CetModel.ID.IMAGE)||c.isDef(f.CetModel.ID.SWF_GRAPHICS)||c.isDef(f.CetModel.ID.PDF))&&this.Wt(c.getId(),b)}process(a,b){this.Xt(a,b)}select(a,b){return null!=b.getEntityById(a.getId())&&null==a.getParentEntity()&&!a.isDisposed()&&(a.isDef(f.CetModel.ID.IMAGE)||a.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)||a.isDef(f.CetModel.ID.PDF)||
a.isDef(f.CetModel.ID.SWF_GRAPHICS))}getTriggerKeys(){return[this.Ko.componentKey,f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID,this.Sp.componentKey,f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID]}reset(){}changesPdomComponents(){return!1}St(a,b){const c=a.getId(),d=a.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID),g=(a)=>{b.requestNoDomBatchUpdate((b)=>{b=b.getEntityById(c);if(null!=b&&!b.isDisposed()&&b.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)===d){var g=
e.Cet.mutableDraw(b);g.kind!==h.DrawComponentKind.animatedImage||g.isErrorDraw()||a(b,g)}})};e.Cet.draw(a).kind===h.DrawComponentKind.animatedImage&&this.bb.animatedImageAssetFromMaid(a.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)).then((a)=>{g((b,c)=>{c.setAsset(a)})}).catch(()=>{g((a,b)=>{b.setError()})})}Bn(a,b){e.Cet.removeSpinner(a);b.setError()}Bi(a,b){a=a.getEntityById(b);if(null==a||a.isDisposed())return{entity:null,ff:null,Qe:null,bf:null};b=a.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W);
const c=e.Cet.errorOfflineAssetId===b.getOfflineAssetId(),d=e.Cet.mutableDraw(a);return d.kind!==h.DrawComponentKind.image&&d.kind!==h.DrawComponentKind.xvg?{entity:a,ff:b,Qe:null,bf:c}:{entity:a,ff:b,Qe:d,bf:c}}Wt(a,b){const {entity:c,ff:d,Qe:e,bf:f}=this.Bi(b,a);if(null!=e)if(f)this.Bn(c,e);else{e.incrementVersion();a=(a)=>{const b=(b)=>{var c,d;return null!==(d=null===(c=b.getEntity().getUntypedComponent(a.componentKey))||void 0===c?void 0:c.getVersion())&&void 0!==d?d:0},e=b(d),f=c.getLastEntityVersion(a.Nk);
c.setLastEntityVersion(a.Nk,e);return{Ql:e!==f,ao:(a)=>e===b(a)}};var h=a(this.Ko);h.Ql&&this.Gx(b,d,e,h);a=a(this.Sp);a.Ql&&this.Jk(b,d,e,a)}}Jk(a,b,c,d){const e=b.getEntity().getId();b=this.Md.getThumbnail(b);c.setThumbnailImageAsset(null);null!=b&&(c=b.thumbnail,Q.isActive("js-sad-thumbnail-for-test")&&(c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAM0lEQVQYlWNgQAX/0TBW8P//f1SMTTGGImyKUQRxsfGahlchzCN4FRKymmjPkBQ8BAMcAEawp1mqrGwMAAAAAElFTkSuQmCC"),Promise.all([this.bb.imageAssetFromImage(c,
e),this.pm]).catch(()=>null).then((b)=>a.requestNoDomBatchUpdate((a)=>{const {ff:c,Qe:f,bf:g}=this.Bi(a,e);if(null==c||null==f||g||!d.ao(c))null!=b&&h.CetRendererModule.freeAsset(b[0]);else if(null!=b){var [a,q]=b;f.setPlaceholderImageAsset(q);f.setThumbnailImageAsset(a)}})))}Tt(a){const b=a.get(f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL);return a.isDef(f.CetModel.ID.PDF)?this.bb.xvgAssetFromPdfUrl(b,a.get(f.CetModel.ID.PDF.PAGE_NUMBER),a.getId()):a.isDef(f.CetModel.ID.SWF_GRAPHICS)?this.bb.xvgAssetFromSwfUrl(b,
a.getId()):a.isDef(f.CetModel.ID.Z_IMAGE)?this.bb.imageAssetFromUrl(b,a.getId()):a.isDef(f.CetModel.ID.BACKGROUND_IMAGE)?this.bb.imageAssetFromUrl(b,a.getId()):x.Utils.fail("")}Gx(a,b,c,d){const f=b.getEntity(),q=f.getId();this.Md.registerIMediaAssetW(b);c.setAsset(null);null==b.getOnlineAssetUrl()?(f.get(e.Cet.getDisableSpinnerKey())||e.Cet.addSpinner(this.o,f),h.CetRendererModule.setLoaded(f,!0)):Promise.all([this.Tt(f),this.pm]).catch(()=>null).then((b)=>a.requestNoDomBatchUpdate((a)=>{const {entity:c,
ff:f,Qe:g,bf:F}=this.Bi(a,q);if(null==f||null==g||F||!d.ao(f))null!=b&&h.CetRendererModule.freeAsset(b[0]);else if(null==b)this.Bn(c,g);else{var [a,k]=b;e.Cet.removeSpinner(c);a.kind===h.AssetKind.Xvg&&g.kind===h.DrawComponentKind.xvg?g.setAsset(a):a.kind===h.AssetKind.Image&&g.kind===h.DrawComponentKind.image?g.setAsset(a):x.Utils.fail("assetkind mismatch");g.setPlaceholderImageAsset(k);h.CetRendererModule.setLoaded(c,!0);this.fw(f,a)}}))}fw(a,b){const c=a.getEntity(),d=c.isDef(f.CetModel.ID.IMAGE)?
c.getWrapper(f.CetModel.ID.IMAGE.W):c.isDef(f.CetModel.ID.PDF)?c.getWrapper(f.CetModel.ID.PDF.W):null;a=a.getOfflineAssetId();null==d||null==a||b.width===d.getWidth()&&b.height===d.getHeight()||(!isFinite(b.width)||0>=b.width||!isFinite(b.height)||0>=b.height?e.Cet.getEditorApiLogger().overrideSizeSkipped(c.getDef(),c.getId(),d.getWidth(),d.getHeight(),b.width,b.height):(e.Cet.getEditorApiLogger().overrideSize(c.getDef(),c.getId(),d.getWidth(),d.getHeight(),b.width,b.height),c.isDef(f.CetModel.ID.IMAGE)?
this.lv.patchSizeAndScale(a,b.width,b.height):this.hw.patchSizeAndScale(a,b.width,b.height)))}};var Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.nr=class{constructor(a){this.Gi=a}getName(){return"InvisibleFrameSystem"}process(a){a.setComponent(h.CetRendererModule.getDrawComponentKey(),this.Gi())}select(a){return a.getDef()===f.CetModel.ID.Z_INVISIBLE_FRAME?!a.getWrapper(f.CetModel.ID.Z_INVISIBLE_FRAME.W).getIsPage():!1}reset(){}changesPdomComponents(){return!1}};var Zb={};Object.defineProperty(Zb,
"__esModule",{value:!0});Zb.Ir=class{constructor(a){this.camera=a;this.io=-1;this.Wn=f.CetModel.createValueComponentKey("OverviewFrameSystem.isOnEdgeKey",!1,!1,!1)}getName(){return"OverviewFrameSystem"}process(a,b,c){let d=b.getPreziW().getMutableOverview();if(null!=d){var g=e.Cet.mutableDraw(d.getEntity());if(g.kind===h.DrawComponentKind.overviewFrame){const a=k.i.parseAspectRatio(b.getPreziW().getAspectRatio());g.setAspectRatio(a.width,a.height,a.letterBoxing)&&(h.CetRendererModule.updateBounds(d.getEntity()),
h.CetRendererModule.updateWorldProperties(d.getEntity()))}if(1!==a.length||a[0]!==d.getEntity()||d.getEntity().getComponentVersion(f.CetModel.ID.OVERVIEW.MINIMUM_SCALE)!==this.io){this.io=d.getEntity().getComponentVersion(f.CetModel.ID.OVERVIEW.MINIMUM_SCALE);switch(this.mn(b)){case m.OverviewBoundsType.AUTOMATIC_OVERVIEW_BOUNDS:a=this.Nl(b,!1);break;case m.OverviewBoundsType.FIXED_OVERVIEW_BOUNDS:this.tk(c)?a=this.Nl(b,!0):(a=d.getOverviewBounds().getBoundsInWorld(),a={documentWorldAABB:null,documentWithMinimumSizeAABB:a,
localToWorld:e.Cet.calcOverviewLocalToWorld(d.getEntity(),a)});break;case m.OverviewBoundsType.XCONSTRUCTOR:throw Error();default:throw Error();}this.kx(b,d.getEntity(),a);this.tk(c)&&f.CetModel.isSupportedDocumentGeneration(b.getPreziW(),f.DocumentGeneration.OverviewAndContentLayout)&&d.setOverviewBounds(m.DOM.createImmutableFixedOverviewBounds(a.documentWithMinimumSizeAABB))}}}Nl(a,b){const c=e.Cet.calcOverviewBoundsData(a,b),d=Math.pow(2,-30);for(let g of a.getPreziW().getMutableZObjects())a=g.getEntity().getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC),
null!=a&&a.isDef(f.CetModel.ID.PLANET_CHAPTER)||(a=e.Cet.getAxisAlignedWorldRectangle(g.getEntity(),b),null==a||this.Dv(a)||(a=null==c.documentWorldAABB?!1:Math.abs(c.documentWorldAABB.getLeft()-a.getLeft())<d||Math.abs(c.documentWorldAABB.getRight()-a.getRight())<d||Math.abs(c.documentWorldAABB.getTop()-a.getTop())<d||Math.abs(c.documentWorldAABB.getBottom()-a.getBottom())<d,g.getEntity().set(this.Wn,a)));this.ce=c.documentWorldAABB;return c}kx(a,b,c){var d=b.get(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD);
if(null==d||d.getScale()!==c.localToWorld.getScale()||d.getTranslation().x!==c.localToWorld.getTranslation().x||d.getTranslation().y!==c.localToWorld.getTranslation().y){d={getLocalToWorldInRenderedScene:(b)=>{b=a.getEntityById(b);return null!=b?h.CetRendererModule.getLocalToWorld(b):null}};const e=null!=this.camera?this.camera.getViewportTransform(d):null;k.i.setWorld(b,c.localToWorld);h.CetRendererModule.updateWorldProperties(b);null!=e&&this.camera.setViewportTransform(e,d)}}Dv(a){a=a.getData();
return isNaN(a.height)||isNaN(a.width)||isNaN(a.x)||isNaN(a.y)}select(a,b){if(a.isDef(f.CetModel.ID.PREZI)||a.isDef(f.CetModel.ID.OVERVIEW))return!0;const c=null!=this.ce?a.get(this.Wn):null;return null==c&&k.i.hasPdomComponent(a)&&a.isDef(f.CetModel.ID.Z_OBJECT)||!1===c?(a=e.Cet.getAxisAlignedWorldRectangle(a,this.mn(b)===m.OverviewBoundsType.FIXED_OVERVIEW_BOUNDS),null==a?!1:null==this.ce?!0:a.getLeft()<this.ce.getLeft()||a.getRight()>this.ce.getRight()||a.getTop()<this.ce.getTop()||a.getBottom()>
this.ce.getBottom()):c?!0:!1}getTriggerKeys(){return[h.CetRendererModule.getWorldGeometryComponentKey(),f.CetModel.ID.OVERVIEW.MINIMUM_SCALE,f.CetModel.getNewEntityCompKey(),f.CetModel.getRemovedEntityCompKey(),f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT,f.CetModel.ID.PREZI.ASPECT_RATIO]}tk(a){return a===e.UpdatePhase.GEOMETRY||a===e.UpdatePhase.DOCUMENT}changesPdomComponents(a){return this.tk(a)}mn(a){a=a.getPreziW().getOverview();return null==a?null:a.getOverviewBounds().getObjectType()}};var $b={};
Object.defineProperty($b,"__esModule",{value:!0});$b.Wr=class{constructor(a){this.xw=a}getName(){return"QuadtreeSystem"}process(a,b){this.xw.update(b.getPreziW(),b,a)}getVersion(a){return l.f.world(a).getVersion()}reset(){}select(a){return a.hasComponent(h.CetRendererModule.getZOrderComponentKey())}getTriggerKeys(){return[h.CetRendererModule.getWorldGeometryComponentKey(),f.CetModel.getRemovedEntityCompKey()]}changesPdomComponents(){return!1}};var ac={};Object.defineProperty(ac,"__esModule",{value:!0});
ac.Xr=class{constructor(a,b){this.channel=a;this.hp=b}getName(){return"WebGlInvalidatorSystem"}select(a){return a.isDef(f.CetModel.ID.BACKGROUND)||a.hasComponent(h.CetRendererModule.getDrawComponentKey())}getTriggerKeys(){return this.hp.getTriggerKeys()}process(a){for(let b of a)this.hp.invalidate(this.channel,b.getId())}reset(){}changesPdomComponents(){return!1}};var kb={};Object.defineProperty(kb,"__esModule",{value:!0});kb.hl=class extends U.mb{constructor(){super()}onFocus(){}onLostFocus(){}};
var bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.Dr=class extends U.mb{constructor(){super()}refresh(){}};var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.ms=class{process(a){for(let b of a)b.setComponent(l.f.xe,new kb.hl),b.setComponent(k.i.getLegacyOverlayComponentKey(),k.i.createOverlayComponent(new bc.Dr))}select(a){const b=a.getComponent(k.i.getLegacyOverlayComponentKey());return a.hasComponent(h.CetRendererModule.getZOrderComponentKey())&&null!=b&&b.getOverlay()instanceof
B.Eb}getTriggerKeys(){return[h.CetRendererModule.getDrawComponentKey()]}getName(){return"ThumbnailOnlyVideoSystem"}reset(){}changesPdomComponents(){return!1}};var lb={};Object.defineProperty(lb,"__esModule",{value:!0});lb.vl=class{constructor(){}getName(){return"WorldGeometrySystem"}initializeEntities(a,b){for(let c of b)null!=this.select(c,a)&&h.CetRendererModule.updateWorldProperties(c)}process(a,b){const c=[];for(let d of a)d.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?c.push(d):d.isDef(f.CetModel.ID.ABSOLUTE)?
(a=b.getEntityById(d.get(f.CetModel.ENTITY_OWNER_ID())),a=b.getEntityById(a.get(f.CetModel.ENTITY_OWNER_ID())),a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)&&c.push(a)):h.CetRendererModule.updateWorldProperties(d);for(let a of c)h.CetRendererModule.updateWorldProperties(a)}select(a){return!a.isDef(f.CetModel.ID.LOGO)&&!a.isDef(f.CetModel.ID.NEXT_LOGO_V1)}getTriggerKeys(){return[...f.CetModel.ID.TRANSFORMED.getFields(),f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD,h.CetRendererModule.getLocalBoundsComponentKey(),
f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT]}reset(){}changesPdomComponents(){return!1}getRequiredKeysForIndirectTrigger(){return[h.CetRendererModule.getWorldGeometryComponentKey()]}};var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.Ae=class extends Sa.ji{constructor(a,b){super();this.ph=b;null!=a&&(this.Hn(a.get(f.CetModel.ID.Z_TEXT.TEXT)),this.setVersion(a.getComponent(f.CetModel.ID.Z_TEXT.TEXT).getVersion()))}vf(a){null!=this.ed&&this.ed.detachedFromComponent();this.ed=null!=a?a.attachToComponent():
null}static create(a,b){return new Ea.Ae(a,b)}static createDefaultBaseStyle(){return Pa.LayoutModel.createCharacterStyleContainer(Pa.LayoutModel.createColor(0),"default",24,"normal","normal",0,0)}getShapedText(){var a=this.U.getComponent(f.CetModel.ID.Z_TEXT.TEXT).getVersion();if(super.getVersion()<a){this.setVersion(a);a=this.U.get(f.CetModel.ID.Z_TEXT.TEXT);let b=J.Ha.wo(a);this.U.get(f.CetModel.ID.Z_TEXT.TEXT)===this.ed.getText()&&a.equals(b)||this.Hn(b,!1)}return this.ed}zp(a,b){b=J.Ha.Iv(b);
this.vf(b);a.set(f.CetModel.ID.Z_TEXT.TEXT,b.getText());this.setVersion(a.getComponent(f.CetModel.ID.Z_TEXT.TEXT).getVersion())}dispose(){this.vf(null)}getVersion(){return Math.floor(Math.max(super.getVersion(),this.U.getComponent(f.CetModel.ID.Z_TEXT.TEXT).getVersion()))}isInherited(){return!0}setBaseStyle(a,b){this.ed.getBaseStyle().equals(b)||(a=this.ed.setBaseStyle(b),this.vf(a),this.incrementVersion())}Hn(a,b=!0){let c=a;b&&(c=J.Ha.wo(a));a=Ea.Ae.createDefaultBaseStyle();this.vf(this.ph.create(c,
a).setBaseStyle(a))}createChildComponent(){let a=new Ea.Ae(null,this.ph);a.vf(this.ed);a.setVersion(this.getVersion());return a}};var N={};Object.defineProperty(N,"__esModule",{value:!0});N.Yq=class{constructor(){}};N.mi=class{constructor(a,b){this.fontsLoadedStateHolder=a;this.ho=-1;this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZTextInitSystem");this.za=b}getName(){return"ZTextInitSystem"}getZTextFixer(a){return new N.dd(a,this.fontsLoadedStateHolder)}initializeEntities(a,
b){for(let c of b)if(c.isDef(f.CetModel.ID.Z_TEXT)){this.update(a);break}}update(a){this.Vt(a);let b=this.Hu(a),c=b!==a.getPrezi().getLastEntityVersion(this.fontsLoadedStateHolder.Nm),d=!1;this.ho!==this.fontsLoadedStateHolder.getVersion()&&(d=!0,this.ho=this.fontsLoadedStateHolder.getVersion());this.Pt(a)&&(d=!0);c&&(d=!0);if(d){var e=this.getZTextFixer(a);a.getEntityList().forEachMutable((a)=>{e.fix(a)&&(h.CetRendererModule.setLoaded(a,!0),this.za.markViewChanged())});a.getPrezi().setLastEntityVersion(this.fontsLoadedStateHolder.Nm,
b)}}Vt(a){let b=this.Ju(a),c=a.getPrezi().getLastEntityVersion(this);if(b!==c)this.fontsLoadedStateHolder.Ut(a).onValue(()=>{this.za.markViewChanged()});a.getPrezi().setLastEntityVersion(this,b)}Ju(a){let b=0;a=a.getPreziW().getDocumentStyle();for(let c of a.getFontFamilies())for(let a of c.getFontFaces())b+=f.CetModel.ID.FONT_FACE.getVersion(a.getEntity());return b}Hu(a){let b=0;a=a.getPreziW().getDocumentStyle();for(let c of a.getFontClasses())b+=f.CetModel.ID.FONT_CLASS.getVersion(c.getEntity());
return b}select(a){return a.isDef(f.CetModel.ID.Z_TEXT)}getTriggerKeys(){return[...f.CetModel.ID.HAS_FONT.getFields(),k.i.getShapedTextKey(),f.CetModel.ID.Z_TEXT.TEXT]}getRequiredKeysForIndirectTrigger(){return[]}isTrackingRemovedEntity(){return!1}Pt(a){let b=!1;a.getEntityList().forEachMutable(()=>{b=!0},this);return b}init(){}reset(){}changesPdomComponents(){return!1}};N.dd=class{constructor(a,b){this.zo=a;this.fontsLoadedStateHolder=b;this.Ag={};this.ht();null==N.dd.logger&&(N.dd.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.ZTextInitSystem"))}tn(a){return a.hasComponent(l.f.Aa)?
f.CetModel.ID.HAS_FONT.getVersion(a)+a.getComponent(l.f.Aa).getVersion()+f.CetModel.ID.POSSIBLY_PLACEHOLDER.getVersion(a):null}Vs(a){let b=Ea.Ae.createDefaultBaseStyle();null==a||null==a.getFamily()?N.dd.to||(N.dd.logger.print("fallback to default font due to missing font family"),N.dd.to=!0):b=b.setFontFamily(a.getFamily()).setFontStyle(a.getStyle()).setFontWeight(a.getWeight());return b}ht(){this.Ag={};for(let b of this.zo.getPreziW().getDocumentStyle().getFontClasses()){let c=b.getFontFamily();
var a=b.getFontWeight();let d=b.getFontStyle();this.Ag[b.getName()]=$a.Layout.getFontFaceId("default",f.FontWeight.Normal,f.FontStyle.Normal);for(let e of this.zo.getPreziW().getDocumentStyle().getFontFamilies())if(c===e.getName()){a=k.i.selectBestMatchingFontFace({fontStyle:d,fontWeight:a},[...e.getFontFaces()].map((a)=>({fontWeight:a.getFontWeight(),fontStyle:a.getFontStyle()})));null!=a&&(this.Ag[b.getName()]=$a.Layout.getFontFaceId(c,a.fontWeight,a.fontStyle));break}}}Iu(a){return this.Ag[a.getWrapper(f.CetModel.ID.HAS_FONT.W).getFontClass()]}fix(a){if(!a.hasComponent(l.f.Aa)||
e.Cet.draw(a).isDisposed())return!1;var b=this.Iu(a);b=this.Vs(b);b=b.setColor(Pa.LayoutModel.createColor(a.get(f.CetModel.ID.HAS_COLOR.COLOR).getRGBInt()));const c=!a.getComponent(l.f.Aa).getShapedText().getBaseStyle().equals(b);if(!c&&this.tn(a)===a.getLastEntityVersion(this))return!1;if(!this.fontsLoadedStateHolder.Ms(b.getFontFamily()))return h.CetRendererModule.setLoaded(a,!1),!1;c&&a.getMutableComponent(l.f.Aa).setBaseStyle(a,b);h.CetRendererModule.setLoaded(a,!0);a.setLastEntityVersion(this,
this.tn(a));return!0}};N.dd.to=!1;N.Zq=class{constructor(a,b){this.assetManager=a;this.xu=b;this.Ve=this.version=0;this.Qm=p.Bacon.newBus();this.Rm=this.Qm.toProperty(!1);this.Rm.onValue(()=>{});this.Om=p.Bacon.newBus();this.Pm=this.Om.toProperty(null);this.Pm.onValue(()=>{});this.kc={};this.Nm=new N.Yq}getVersion(){return this.version}getFontLoadErrorPropery(){return this.Pm}Ms(a){if("default"===a)return!0;let b=!1;for(let c in this.kc)if(0===c.indexOf(a)&&(b=!0,!this.kc[c]))return!1;return b}addDownloadedFont(a){let b=
a.fontFamily;for(const c of Sc.getFontFaces(a))a=$a.Layout.getFontFaceId(b,c.weight,c.style),null==this.kc[a.getId()]&&(this.kc[a.getId()]=!0)}Gl(){return 0===this.Ve}Ut(a){const b=p.Bacon.newBus();this.version++;this.kc={};this.Ve=0;for(let b of a.getPreziW().getDocumentStyle().getFontFamilies()){let a=b.getName();for(let d of b.getFontFaces()){var c=d.getFontWeight();let b=d.getFontStyle();c=$a.Layout.getFontFaceId(a,c,b);null==this.kc[c.getId()]&&(this.kc[c.getId()]=!1,this.Ve++)}}const d=()=>
{b.end();this.Qm.push(!0)};0<this.Ve?(a=a.getPrezi().getComponent(l.f.MODEL).getPdomObject(),this.assetManager.createFontSetFetcher(a,this.xu).fetch().onValue((a)=>{this.version++;const c=a.fontFaceId.getId();!1===this.kc[c]&&(this.kc[c]=!0,b.push(c),this.Ve--);null!=a.error?(this.Om.push(a),this.Gl()&&setTimeout(()=>{d()},0)):this.Gl()&&d()})):setTimeout(()=>{d()},0);return b}};var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.ws=class{constructor(a,b,c){this.K=a;this.za=b;this.Fb=c}process(a){if(a.getComponent(h.CetRendererModule.getDrawComponentKey()).kind===
h.DrawComponentKind.videoThumbnail){let b=B.Eb.create(a.getMutableWrapper(f.CetModel.ID.Z_VIDEO.W),this.K,this.za,this.Fb);a.setComponent(l.f.xe,b);a.setComponent(k.i.getLegacyOverlayComponentKey(),k.i.createOverlayComponent(b,b))}}select(a){return a.isDef(f.CetModel.ID.Z_VIDEO)}getName(){return"VideoPlaybackSystem"}reset(){}changesPdomComponents(){return!1}};var mb={};Object.defineProperty(mb,"__esModule",{value:!0});mb.rl=class{constructor(a,b,c,d){this.fontsLoadedStateHolder=a;this.za=b;this.Na=
c;this.Fb=d}createVideoPlaybackSystem(){return this.createInitializerSystem(new dc.ws(this.Na,this.za,this.Fb))}createWorldGeometrySystem(){return this.createShaperInflatorSystem(new lb.vl)}createThumbnailOnlyVideoSystem(){return this.createShaperSystem(new cc.ms)}createQuadTreeSystem(a){return this.createShaperSystem(new $b.Wr(a))}createBoundCalculationSystem(){return this.createShaperInflatorSystem(new Da.ve)}createRenderingInvalidatorSystem(a,b){return this.createShaperSystem(new ac.Xr(a,b))}createOverviewFrameSystem(a){return this.createShaperSystem(new Zb.Ir(a))}createShaperSystem(a){return new fa.tc(a)}createShaperInflatorSystem(a){return new fa.tc(a)}createInitializerSystem(a){return new Xb.Pq(a)}createInvisibleFrameSystem(a){return new Yb.nr(a)}createImageInitSystem(a,
b,c,d){return this.createShaperSystem(new jb.al(a,b,c,d))}createZTextInitSystem(){null==this.kq&&(this.kq=new N.mi(this.fontsLoadedStateHolder,this.za));return this.kq}isInflator(a){return"initializeEntities"in a}Fv(a){return"update"in a}mapToPhases(a){let b=[],c=[];for(let d of a)this.isInflator(d)&&b.push(d),this.Fv(d)&&c.push(d);return{initList:[],inflateList:b,updateList:c,updateOnceList:[],preRenderList:[],fixerList:[]}}};var Va={};Object.defineProperty(Va,"__esModule",{value:!0});Va.fi=class{constructor(a,
b,c,d,e){this.lb=a;this.yu=b;this.za=c;this.Na=d;this.Fb=e}getSceneHierarchy(){return this.lb}createRootScene(a,b){return this.lb.createRootScene(a,b)}createChildScene(a,b,c,d=!0){a=this.lb.createChildScene(b,a,c);d||a.mk(new Ba.Er);a.updateEntitiesFromParentScene();return a}createAnimScene(a,b,c){a=this.lb.createAnimScene(b,a,c);a.updateEntitiesFromParentScene();return a}getSystemFactory(){return new mb.rl(this.yu,this.za,this.Na,this.Fb)}};var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});
Wa.gi=class{constructor(){this.fe=0;this.Bj=[];this.up=[]}getScenes(){return[...this.up]}createRootScene(a,b){if(null!=this.ak)throw Error("root scene is already set");return this.ak=this.ti(new M.Xf(this,a,b,null,!1))}createChildScene(a,b,c){this.Ci(a);return this.ti(new M.Xf(this,b,c,a,!1))}createAnimScene(a,b,c){this.Ci(a);return this.ti(new M.Xf(this,b,c,a,!0))}setAutoCommitScene(a){this.Ci(a);this.Ts=a}getRootScene(){return this.ak}Ci(a){if(a.getSceneHierarchy()!==this)throw Error("scene is not attached to the sceneHierarchy");
}ti(a){this.up.push(a);return a}};var ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.uq=class{constructor(){this.Oj=[];this.hc=p.Bacon.newBus()}trigger(a){this.oi=!0;this.Oj.push(a)}dispose(){this.ni=!0}isDisposed(){return this.ni}execute(){if(this.oi&&!this.ni){let a=this.Oj.slice();this.Oj=[];for(let b of a)this.hc.push(b);this.hc.end();this.ni=!0}}};var va={};Object.defineProperty(va,"__esModule",{value:!0});va.Cd=class{constructor(a,b,c){this.re=a;this.M=b;this.viewport=c}static Ne(a,
b,c,d){return{id:a,targetType:b,animationType:c,phase:d}}Ah(a){this.viewport=a}focusToOverview(a){a.setViewportTransform(this.nn());return p.Bacon.once(va.Cd.Ne(null,e.NavigationActionTargetType.ToOverview,e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}flyToOverview(a){return this.Fi(null,e.NavigationActionTargetType.ToOverview,e.NavigationActionAnimationType.Fly,(b)=>{a.Ue(this.nn(),b);a.sg()})}Mm(a,b,c,d=e.CameraNavigationType.FLY){const g=a.qf!==b.getId()?this.re:
this.M;let q=k.i.getTargetTransform(g,b.getId(),this.viewport);return this.Fi(b.getId(),e.NavigationActionTargetType.ToId,e.NavigationActionAnimationType.Fly,(e)=>{a.Ue(q,e,c,d);b.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)||a.sg()})}flyToRectangle(a,b,c,d,f,q){null==q&&(q=a.getMarginCorrectedViewport());q=a.getViewportMarginCorrectionTransform().invert().transformRectangle(q);let g=k.i.Fg(b,c,q);return this.Fi(f,e.NavigationActionTargetType.ToRectangle,e.NavigationActionAnimationType.Fly,(b)=>{a.Ue(g,
b,d);a.sg()})}su(a,b){b=this.re.getEntityById(b.getId());a.setViewportTransform(k.i.getTargetTransform(this.re,b.getId(),this.viewport));return p.Bacon.once(va.Cd.Ne(b.getId(),e.NavigationActionTargetType.ToId,e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}focusToRectangle(a,b,c){a.setViewportTransform(k.i.Fg(b,c,this.viewport));return p.Bacon.once(va.Cd.Ne(null,e.NavigationActionTargetType.ToRectangle,e.NavigationActionAnimationType.Focus,e.NavigationActionAnimationPhase.End))}snapToId(a,
b,c,d){return this.Mm(a,b,d,c).filter((a)=>a.phase===e.NavigationActionAnimationPhase.End||a.phase===e.NavigationActionAnimationPhase.Cancel).map((a)=>va.Cd.Ne(a.id,a.targetType,e.NavigationActionAnimationType.Snap,a.phase))}nn(){let a=this.re.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW);return k.i.getTargetTransform(this.re,a.getId(),this.viewport)}getWorldBounds(){return this.Vu(this.re.getEntityList())}Vu(a){let b=null;a.forEach((a)=>{a.hasComponent(h.CetRendererModule.getZOrderComponentKey())&&
(a=l.f.hq(a),b=null==b?a:b.union(a))});null==b&&(b=v.Geometry.rectangleFromData({x:0,y:0,width:.01,height:.01}));return b}Fi(a,b,c,d){let f=p.Bacon.newBus();d((d)=>{f.push(va.Cd.Ne(a,b,c,d?e.NavigationActionAnimationPhase.End:e.NavigationActionAnimationPhase.Cancel));f.end()});return f}};var A={};Object.defineProperty(A,"__esModule",{value:!0});A.fa=class{static toggleDebugFlag(a){return a===e.DebugFlag.RENDER_ZOOMED_OUT_TO_SHOW_SURROUNDINGS?(A.fa.oh=!A.fa.oh,A.fa.oh):a===e.DebugFlag.USE_PARTITION_RENDERER?
(A.fa.Mk=!A.fa.Mk,A.fa.Mk):a===e.DebugFlag.DRAW_PARTITION_BORDERS?(A.fa.Li=!A.fa.Li,A.fa.Li):a===e.DebugFlag.RENDER_PARTITIONS_ON_DEMAND?(A.fa.Xj=!A.fa.Xj,A.fa.Xj):a===e.DebugFlag.SHOW_OBJECT_IDS?(A.fa.showObjectIds=!A.fa.showObjectIds,A.fa.showObjectIds):a===e.DebugFlag.QUADTREE_BOUNDS?(A.fa.jh=!A.fa.jh,A.fa.jh):a===e.DebugFlag.CAMERA_AREA?(A.fa.zi=!A.fa.zi,A.fa.zi):!1}};A.fa.Li=!1;A.fa.Xj=!1;A.fa.oh=!1;A.fa.Mk=!0;A.fa.showObjectIds=!1;A.fa.jh=!1;A.fa.zi=!1;var fc={};Object.defineProperty(fc,"__esModule",
{value:!0});fc.Gr=class extends U.mb{constructor(a,b){super();this.Kj=a;this.data=b}refresh(a,b){this.Kj.refresh(a,b,this.Pn)}getOverlay(){return this.Kj}getData(){return this.data}dispose(){super.dispose();this.Kj.dispose()}setClickable(a){this.Pn=a}getClickable(){return this.Pn}};var O={};Object.defineProperty(O,"__esModule",{value:!0});O.Pa=class{static xy(){return O.Pa.hd}static aj(){const a=O.Pa.hd;return Object.keys(a).map((b)=>a[b])}static createOverlayComponentKey(a,b){if(O.Pa.hd[a])return O.Pa.hd[a];
b=f.CetModel.createComponentKey(a,!1,!1,b);return O.Pa.hd[a]=b}static createOverlayComponent(a,b){return new fc.Gr(a,b)}static getLegacyOverlayComponentKey(){null==O.Pa.hd.overlay&&O.Pa.createOverlayComponentKey("overlay",!1);return O.Pa.hd.overlay}};O.Pa.hd={};var gc={};Object.defineProperty(gc,"__esModule",{value:!0});gc.Hr=class{constructor(a){this.Qd={};this.j=a;this.kp()}kp(){this.Qd={};this.$g=O.Pa.aj();this.j.getEntityList().forEach((a)=>{this.$g.map((b)=>a.getComponent(b)).filter((a)=>null!=
a).length&&(this.Qd[a.getId()]=!0)});null!=this.Lj&&this.j.getEntityList().stopTracking(this.Lj);this.Lj=this.j.getEntityList().startNewTracking("Stage-OverlayTarcker",[f.CetModel.getNewEntityCompKey(),f.CetModel.getRemovedEntityCompKey()].concat(this.$g),()=>!0)}update(){if(null!=this.j){let a=O.Pa.aj();x.Utils.arrayEquals(a,this.$g)||this.kp();this.j.getEntityList().forChangedEntities((a)=>{for(let b of a){a=!1;if(null!=b)for(let c of this.$g)if(b.hasComponent(c)){a=!0;break}a?this.Qd[b.getId()]=
!0:delete this.Qd[b.getId()]}},this.Lj)}}Gu(){return Object.keys(this.Qd)}zu(a){let b=O.Pa.aj();const c=[];for(let d of this.Gu()){const e=this.j.getEntityById(d);if(null!=e){let c=b.map((a)=>e.getComponent(a)).filter((a)=>null!=a);0<c.length&&a(e,c)}else c.push(d)}for(let a of c)delete this.Qd[a]}};var wa={},Oc=this&&wa.wl||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{h(d.next(a))}catch(X){f(X)}}function q(a){try{h(d["throw"](a))}catch(X){f(X)}}
function h(a){a.done?c(a.value):e(a.value).then(g,q)}h((d=d.apply(a,b||[])).next())})};Object.defineProperty(wa,"__esModule",{value:!0});wa.Fe=class{constructor(a,b,c,d,g,q,h,k){this.yv=k;this.gg={source:null,live:!0,top:0,left:0,width:1600,height:900,texOffsetX:0,texOffsetY:0,texScaleX:1,texScaleY:1};this.Tw=x.Utils.createSequencer();this.so=!1;this.xk=e.StageTweenMode.ANIMATE_ONLY_CURRENT;this.marginTop=this.marginRight=this.marginBottom=this.marginLeft=0;this.Qh=null;this.nc=q;this.ob=p.Bacon.newBus();
this.camera=b;this.video=h;this.Rl=new Map;b.Yw(()=>this.Yu());this.Pc=c;this.Ww(a);this.xf={x:a.width/2,y:a.height/2};a=v.Geometry.rectangleFromData({x:-this.xf.x,y:-this.xf.y,width:a.width,height:a.height});this.camera.Ah(a);this.camera.nk(a);this.camera.hx(this);this.Hc=d;this.aspectRatio=e.Cet.parseAspectRatio(f.AspectRatio.Off);this.xi=f.AspectRatio.Off;this.Ra=g;this.ig=x.Utils.createLinkedList();this.tp=p.Bacon.newBus();this.sp=p.Bacon.newBus();this.vo=p.Bacon.newBus();this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.StageImpl");
if(null!=this.video)this.video.getVideoEventStream().onValue((a)=>{this.Wx=a.eventType})}registerScene(a,b){this.Rl.set(b,a)}updateBackgroundVideoParams(a){this.gg=Object.assign(Object.assign({},this.gg),a);this.markViewChanged()}getBackgroundVideoParams(){return this.gg}setScene(a,b){if(this.ee!==a||this.M!==b)this.qu(),null!=this.M&&this.M.setTweenMode(e.TweenMode.IMMEDIATE),this.xk===e.StageTweenMode.ANIMATE_ONLY_CURRENT?b.setTweenMode(e.TweenMode.ANIMATION):this.xk===e.StageTweenMode.NEVER_ANIMATE&&
b.setTweenMode(e.TweenMode.IMMEDIATE),null!=this.M&&(this.M.update(),this.M.update(e.UpdatePhase.PRE_RENDER)),this.ee=a,this.M=b,this.nc.setScene(b),this.Ik(),this.Bh(!0),null!=this.Qh&&(this.Qh(),this.Qh=null),this.Qh=b.onViewChange(()=>this.markViewChanged()),this.hitTest=this.Pc.getHitTest(),this.ic=new va.Cd(a,b,this.camera.getViewport()),b.update(),this.resizeStage(this.ka),this.Lo=new gc.Hr(this.M),this.markViewChanged(),this.sp.push(null)}setStageTweenMode(a){this.xk=a}qu(){if(null!=this.M){var a=
this.M.getTweener();null!=a&&this.M.getEntityList().forEachMutable((b)=>{a.removeTweens(b.getId())})}}getRenderedScene(){return this.M}getModelScene(){return this.ee}getPathNavigator(){return this.nc}Ww(a){let b=this.ka;this.ka=a;this.markViewChanged();null==b||b.width===this.ka.width&&b.height===this.ka.height||this.resizeStage(this.ka)}getHitTest(){return this.hitTest}resetForTest(){this.Ra.yh(null)}dispose(){this.Vd().forEachMutable((a)=>{a.dispose()})}forEachEntities(a){return this.Vd().forEach(a)}Vd(){return this.M.getEntityList()}getEntityById(a){return this.Vd().getEntityById(a)}resizeStage(a){this.ka=
a;this.xf={x:a.width/2,y:a.height/2};var b=this.camera.getStageArea().getData(),c=a.width;a=a.height;this.aq();this.camera.ru();this.Bh(!0);null!=this.Ra.lc()?this.camera.setViewportTransform(k.i.getTargetTransform(this.M,this.Ra.lc().getId(),this.camera.getViewport())):(b=Math.min(c/b.width,a/b.height),this.camera.setViewportTransform(this.camera.getViewportTransform().scaleAroundPoint({x:0,y:0},b)));this.markViewChanged()}Bh(a){let b,c,d,e;null!=this.M&&null!=this.M.getPrezi()&&this.M.getPrezi().get(k.i.getAspectRatioClipComponentKey())?
(b=Math.max(-this.ka.width/2+this.marginLeft,this.camera.getViewport().getTopLeft().x),c=Math.max(-this.ka.height/2+this.marginTop,this.camera.getViewport().getTopLeft().y),d=Math.min(this.ka.width/2-this.marginRight,this.camera.getViewport().getBottomRight().x),e=Math.min(this.ka.height/2-this.marginBottom,this.camera.getViewport().getBottomRight().y)):(b=-this.ka.width/2+this.marginLeft,c=-this.ka.height/2+this.marginTop,d=this.ka.width/2-this.marginRight,e=this.ka.height/2-this.marginBottom);this.camera.jx(v.Geometry.rectangleFromData({x:b,
y:c,width:Math.abs(d-b),height:Math.abs(e-c)}),a)}setMargins(a,b,c,d,e,f=!0){null!=this.M&&null!=this.M.getPrezi()&&this.M.getPrezi().set(k.i.getAspectRatioClipComponentKey(),e);this.marginTop=a;this.marginRight=b;this.marginBottom=c;this.marginLeft=d;this.vo.push({left:d,right:b,top:a,bottom:c});this.Bh(f);this.markViewChanged()}getMarginsProperty(){return this.vo.toProperty({left:this.marginLeft,right:this.marginRight,top:this.marginTop,bottom:this.marginBottom})}Zw(a){this.Zg=a}markViewChanged(){this.wj=
!0;null!=this.Zg&&this.Zg()}isInAnimation(){return this.camera.zj()||this.Aj()}update(){this.wj=!1;(()=>{this.camera.Ox();this.camera.Kx();this.camera.Sx()})();this.ee.update(e.UpdatePhase.UPDATE);this.ee.update(e.UpdatePhase.TWEEN);this.ee.update(e.UpdatePhase.PRE_RENDER);this.M.updateEntitiesFromParentScene();this.setAspectRatio(this.M.getPreziW().getAspectRatio());this.M.update(e.UpdatePhase.UPDATE_ONCE);this.Hc.update(this.M);this.M.update(e.UpdatePhase.TWEEN);this.M.update(e.UpdatePhase.PRE_RENDER)}drawFrame(){this.update();
this.draw();(this.camera.zj()||this.Aj())&&this.markViewChanged();this.vv();this.tp.push(this.M)}forceDraw(){this.markViewChanged();this.drawFrame()}xd(a){let b=new ec.uq;this.ig.push(b);a.onValue((a)=>{b.trigger(a);this.markViewChanged()});return b.hc}vv(){let a=this.ig.filter((a)=>a.oi);this.ig=this.ig.filter((a)=>!a.oi);for(let b of a)b.execute()}getScreenBounds(a){return a.getComponent(h.CetRendererModule.getWorldGeometryComponentKey()).getWorldBounds().transform(this.camera.getTargetTransform())}isEntityInCamera(a){return this.camera.getWorldArea().intersects(l.f.Zx(a))}isEntityContainedInCamera(a,
b=1){a=v.Geometry.obbFromRect(l.f.hq(a).getData());const c=(a.getWidth()/b-a.getWidth())/2;b=(a.getHeight()/b-a.getHeight())/2;a=a.inflateXY(c,b).union(this.camera.getWorldArea());return this.camera.getWorldArea().equalsWithin(a,Math.pow(2,-44))}Yu(){this.camera.Ke();this.$b(null);this.markViewChanged()}getStageArea(){return this.camera.getStageArea()}getCamera(){return this.camera}getAspectRatio(){return this.xi}setAspectRatio(a){if(a!==this.xi){let b=k.i.parseAspectRatio(a);if(b.width!==this.aspectRatio.width||
b.height!==this.aspectRatio.height||b.letterBoxing!==this.aspectRatio.letterBoxing)this.aspectRatio=b,this.aq();this.xi=a}}aq(){let a=v.Geometry.rectangleFromData({x:-this.xf.x,y:-this.xf.y,width:this.ka.width,height:this.ka.height});this.ix();this.camera.nk(a);null!=this.ic&&this.ic.Ah(this.camera.getViewport())}ix(){this.camera.Ah(this.$s());this.Bh(!0)}$s(){var a=this.ka.width,b=this.ka.height;this.aspectRatio.letterBoxing&&(b=this.aspectRatio.width/this.aspectRatio.height,a=Math.round(this.ka.height*
b),b=Math.round(this.ka.width/b),b<this.ka.height?a=this.ka.width:b=this.ka.height);return v.Geometry.rectangleFromData({x:-(a/2),y:-(b/2),width:a,height:b})}setBottomPadding(){}getBackgroundsInDepthOrder(){return h.CetRendererModule.getBackgroundsInDepthOrder(this.M.getPreziW())}draw(){if(this.yv){var a={showObjectIds:A.fa.showObjectIds,showQuadtreeBounds:A.fa.jh,showSurroundings:A.fa.oh,camera:this.camera,aspectRatioClip:this.M.getPrezi().get(l.f.Pk),backgroundVideo:this.gg,showBackground:!0,showDecoration:!0};
this.logger.time("draw_entities");var b=this.Rl.get(this.M);this.Pc.drawEntities(b,this.M.getPreziW(),this,a);this.so||(a=this.M.getName(),"playback"!==a&&"edit-animation"!==a)||(a="playback"===a?"playback":"edit",t.LoggerModule.createLogHelper().loadTimerEnd(this.logger,t.LoadEvent.FirstValidFrame,a,h.RendererKind[h.RendererKind.WebGl]),this.so=!0);this.yw(this.M.getEntityList())}}Aj(){return this.Hc.needsFrameImmediately()||this.M.getTweener().needsFrameImmediately()}getNextFrameTime(){let a=-1,
b=this.Hc.getNextFrameTime(),c=this.M.getTweener().getNextFrameTime();0<=b&&(a=b);0<=c&&(a=Math.min(c,0<=a?a:c));return a}yw(){this.Lo.update();this.Lo.zu((a,b)=>{b.forEach((b)=>b.refresh(this,a))})}fadeOutPeerById(a){var b=this.Vd().getEntityById(a);if(null!=b){let c=p.Bacon.newBus();this.Hc.lu(b,()=>{c.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.End});c.end()});this.markViewChanged();b=c;this.ob.push({id:a,
targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.Start})}else b=p.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeOut,phase:e.NavigationActionAnimationPhase.Cancel});return this.xd(b)}fadeInPeerById(a){var b=this.Vd().getEntityById(a);if(null!=b){let c=p.Bacon.newBus();e.Cet.updateVisibility(b).setEnabled(!0);this.Hc.ju(b,()=>{c.push({id:a,targetType:e.NavigationActionTargetType.ToId,
animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.End});c.end()});this.markViewChanged();b=c;this.ob.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.Start})}else b=p.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.FadeIn,phase:e.NavigationActionAnimationPhase.Cancel});return this.xd(b)}Ik(){this.Ra.setScene(this.ee);
this.Ra.Ik()}$b(a){this.Ra.yh(a)}getImageDataForTest(a,b){let c=this.camera.getStageArea().getData();return this.Pc.getImageDataForTest(a+c.width/2,b+c.height/2,1,1)}createCopiedCanvasForTest(){return Oc(this,void 0,void 0,function*(){const a=Math.floor(this.ka.width),b=Math.floor(this.ka.height),c=yield this.Pc.getImageDataForTest(0,0,a,b),d=h.CetRendererModule.createCanvas(a,b);d.getContext("2d").fillStyle="transparent";d.getContext("2d").fillRect(0,0,a,b);d.getContext("2d").putImageData(c,0,0);
return d})}createSnapshotCanvas(a,b,c,d,e,f){return!isFinite(b.width)||!isFinite(b.height)||0>=b.width||0>=b.height||b.width!==Math.floor(b.width)||b.height!==Math.floor(b.height)?Promise.reject("image size width and height should be a positive integer"):this.Tw.addNext(()=>Oc(this,void 0,void 0,function*(){null==this.Gp&&(this.Gp=this.Pc.createChannel("SnapShot"));var g=new ka.Vc(v.Geometry.rectangleFromData(Object.assign({x:-b.width/2,y:-b.height/2},b)));g.nk(g.getViewport());var q=g.getWorldArea();
q=v.Geometry.getFitTransform(a,q,!0);g.setViewportTransform(q);q={showObjectIds:!1,showQuadtreeBounds:!1,showSurroundings:!1,camera:g,aspectRatioClip:!1,backgroundVideo:null,showBackground:c,showDecoration:!1};this.forceDraw();var {canvas:h,wasCancelled:k}=yield this.Pc.getSnapshotImageData(Object.assign(Object.assign({},g.getStageArea().getData()),{x:0,y:0}),this.Gp,this.M.getPreziW(),this,d,e,q,f);e&&Q.isActive("js-for-test-slow-hq-snapshot")&&(yield x.Utils.sleep(1E4));!e&&Q.isActive("js-for-test-green-lq-snapshot")&&
(g=document.createElement("canvas"),g.id=h.id,g.width=h.width,g.height=h.height,q=g.getContext("2d"),q.fillStyle="#00ff00",q.fillRect(0,0,g.width,g.height),h=g);return{canvas:h,wasCancelled:k}}))}flyToId(a,b){let c=this.getEntityById(a);return null!=c?this.Ue(c,b):p.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Cancel})}flyToRectangle(a,b,c,d,f){this.ob.push({id:d,targetType:e.NavigationActionTargetType.ToRectangle,
animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});a=this.ic.flyToRectangle(this.camera,a,b,c,d,f);this.markViewChanged();return a}Ue(a,b){this.ob.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});a=this.getEntityById(a.getId());a!==this.Ra.lc()&&this.$b(null);this.Lm=a;let c=p.Bacon.newBus();b=this.ic.Mm(this.camera,this.Lm,b);b.onValue((b)=>
{a=this.getEntityById(a.getId());b.phase===e.NavigationActionAnimationPhase.End&&this.$b(a);this.markViewChanged()});this.xd(b).onValue((a)=>{c.push(a);c.end()});this.markViewChanged();return c}inverseFlight(a,b){let c=this.getEntityById(a);if(null!=c){this.ob.push({id:c.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});let d=p.Bacon.newBus();this.getCamera().invertCurrentTransition(b);this.getCamera().whenTransitionFinished((b)=>
{d.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:b?e.NavigationActionAnimationPhase.End:e.NavigationActionAnimationPhase.Cancel});d.end()});this.Lm=c;return d}return p.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Cancel})}getNavigationActions(){return this.ob}focusToOverview(a){var b=this.M.getPreziW().getOverview().getId();this.ob.push({id:b,
targetType:e.NavigationActionTargetType.ToOverview,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start});b=this.ic.focusToOverview(this.camera);this.$b(this.M.getPreziW().getOverview().getEntity());this.markViewChanged();return a?this.xd(b):b}flyToOverview(){var a=this.M.getPreziW().getOverview().getId();this.ob.push({id:a,targetType:e.NavigationActionTargetType.ToOverview,animationType:e.NavigationActionAnimationType.Fly,phase:e.NavigationActionAnimationPhase.Start});
a=this.ic.flyToOverview(this.camera);a.onValue((a)=>{a.phase===e.NavigationActionAnimationPhase.End&&this.$b(this.M.getPreziW().getOverview().getEntity())});this.$b(null);this.markViewChanged();return this.xd(a)}focusTo(a,b){this.ob.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start});let c=this.ic.su(this.camera,a);this.$b(a);this.markViewChanged();this.ob.push({id:a.getId(),targetType:e.NavigationActionTargetType.ToId,
animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.End});return b?this.xd(c):c}focusToRectangle(a,b,c){c&&this.$b(null);this.ob.push({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Start,withoutCurrentTopicUpdate:c});a=this.ic.focusToRectangle(this.camera,a,b);this.markViewChanged();return a}focusToId(a,b){let c=this.getEntityById(a);return null!=c?this.focusTo(c,
b):p.Bacon.once({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Focus,phase:e.NavigationActionAnimationPhase.Cancel})}getEntityIdInFocusStream(){return this.Ra.zm.map((a)=>null!=a?a.getId():null).skipDuplicates()}getEntityIdInFocus(){let a=this.Ra.lc();return null!=a?a.getId():null}getEntityIds(){let a=[];this.forEachEntities((b)=>{a.push(b.getId())});return a}getStageCamera(){return this.camera}getSceneUpdateStream(){return this.tp}getSceneReplacedStream(){return this.sp}getCurrentCameraNavigation(){return this.camera.getCurrentCameraNavigation()}snapToId(a,
b,c,d){this.ob.push({id:a,targetType:e.NavigationActionTargetType.ToId,animationType:e.NavigationActionAnimationType.Snap,phase:e.NavigationActionAnimationPhase.Start});let f=this.getEntityById(a);this.$b(null);let q=p.Bacon.newBus();a=this.ic.snapToId(this.camera,f,b,c);a.onValue((a)=>{f=this.getEntityById(f.getId());a.phase===e.NavigationActionAnimationPhase.End&&this.$b(f);this.markViewChanged();null!=d&&d(a.phase)});this.xd(a).onValue((a)=>{q.push(a);q.end()});this.markViewChanged();return q}slideTo(a){this.camera.slideTo(a);
this.markViewChanged();return p.Bacon.once({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Slide,phase:e.NavigationActionAnimationPhase.Start})}slideToRect(a,b){a=k.i.Fg(a,b,this.camera.getViewport()).scaleAroundPoint({x:0,y:0},1);this.camera.slideTo(a);this.markViewChanged();return p.Bacon.once({id:null,targetType:e.NavigationActionTargetType.ToRectangle,animationType:e.NavigationActionAnimationType.Slide,phase:e.NavigationActionAnimationPhase.Start})}getVideoEventStream(){return this.video.getVideoEventStream()}play(a){var b=
this.Ra.lc();null!=b&&(b=b.getComponent(l.f.VIDEO),null!=b&&(null!=a&&b.seekTo(a),b.playVideo()))}seekTo(a){var b=this.Ra.lc();null!=b&&(b=b.getComponent(l.f.VIDEO),null!=b&&b.seekTo(a))}pause(){var a=this.Ra.lc();null!=a&&(a=a.getComponent(l.f.VIDEO),null!=a&&a.pauseVideo())}getCurrentTime(){var a=this.Ra.lc();return null!=a&&(a=a.getComponent(l.f.VIDEO),null!=a)?a.getCurrentTime():0}setVideoControlVisibility(a){null!=this.video&&this.video.setControlVisibility(a)}resetVideos(){this.forEachEntities((a)=>
{a=a.getComponent(l.f.VIDEO);null!=a&&a.seekTo(0)})}toggleVideoPlay(){switch(this.Wx){case T.VideoEventType.Play:this.pause();break;case T.VideoEventType.Pause:this.play()}}getRenderer(){return this.Pc}getRenderingTextFactory(){return this.Pc.getRenderingTextFactory()}getLocalToWorldInRenderedScene(a){let b=this.getRenderedScene().getEntityById(a);if(null==this.getRenderedScene().getRootScene().getEntityById(a))return null;if(null!=b)try{return h.CetRendererModule.getLocalToWorld(b)}catch(c){}return null}};
wa.Fe.Jq=!1;wa.Fe.by=768;wa.Fe.dy=.9;var nb={};Object.defineProperty(nb,"__esModule",{value:!0});nb.FadingComponent=class extends U.mb{constructor(a,b){super();this.Pi=0;this.nj=a;this.Pi=b}createChildComponent(){let a=new nb.FadingComponent(this.nj,this.Pi);a.version=this.version;return a}getFadingId(){return this.Pi}setIsFadingFlag(a){this.nj=a}getIsFadingFlag(){return this.nj}};var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.jr=class{constructor(a,b,c){this.o=a;this.iv=b;this.gk=
c}refresh(a,b){null==this.Yd&&(this.Yd=this.o.createIconElement(b.getId(),this.iv,this.gk),this.o.setElementClickable(this.Yd.id,!1));this.o.positionElementToCenter(this.Yd.id,this.gk,this.gk);this.o.transform(this.Yd.id,v.Geometry.createFromTransform(l.f.transform(b).getLocalToWorld()))}dispose(){if(null!=this.Yd){let a=window.document.getElementById(this.Yd.id);a.parentElement.removeChild(a)}}};var ob={};Object.defineProperty(ob,"__esModule",{value:!0});ob.Vk=class{constructor(a){this.o=a}createVisibilityComponent(){return new xa.He}createNoFocusBehaviorComponent(){return new kb.hl}createFadingComponent(a,
b){return new nb.FadingComponent(a,b)}createWorldGeometryComponent(){return h.CetRendererModule.createWorldGeometryComponent()}createPdomComponent(a){return new Ca.Ce(a)}createMutableVarrayComponent(){return new sa.Fd(null)}setIconOverlay(a,b,c=24){b=new hc.jr(this.o,b,c);a.setComponent(k.i.getLegacyOverlayComponentKey(),k.i.createOverlayComponent(b))}};var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.Rq=class{constructor(a){this.assetManager=a}process(a){for(let b of a)if(b.get(f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID)!==
e.Cet.errorOfflineAssetId||e.Cet.draw(b).isErrorDraw()||(e.Cet.mutableDraw(b).setError(),e.Cet.removeSpinner(b)),e.Cet.draw(b).hasError()){a=null;try{a=e.Cet.draw(b).calculateGraphicsBounds(b)}catch(c){a=v.Geometry.rectangleFromData({x:0,y:0,width:100,height:100})}b.setComponent(h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.createErrorDrawComponent(a))}}select(a){return null!=e.Cet.draw(a)}getTriggerKeys(){return[h.CetRendererModule.getDrawComponentKey(),f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID]}getName(){return"ErrorDrawSystem"}reset(){}changesPdomComponents(){return!1}};
var jc={};Object.defineProperty(jc,"__esModule",{value:!0});jc.Fr=class{constructor(a){this.Mn=this.Un=!1;a.take(1).onValue(()=>{this.Mn=!0})}update(a){this.Mn&&!this.Un&&(h.CetRendererModule.collectStatistics(a.getEntityList().asArray()),this.Un=!0)}getName(){return"OnLoadedAssetsStatisticsSystem"}init(){}reset(){}changesPdomComponents(){return!1}};var ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.ys=class{getShapedText(a){return k.i.shapedText(a)}getSelectedRange(a){return a.get(l.f.Vf)}selectionRangeComponentVersion(a){a=
a.getComponent(l.f.Vf);return null==a?0:a.getVersion()}getShapedTextComponentVersion(a){return a.getComponent(l.f.Aa).getVersion()}getUrlsWithBounds(a){return J.Ha.Wu(k.i.shapedText(a))}hasCaret(a){return null!=a.get(l.f.sl)}};ha.Kd=class{constructor(a,b,c){this.K=a;this.logger=t.LoggerModule.getLoggerManager().createLogger("ZObjectInitSystem");this.lg();this.Fb=b;this.za=c;this.ay=new ha.ys}getName(){return"ZObjectInitSystem"}initializeEntities(a,b){let c=0;for(var d of a.getEntityList().asArray()){var e=
k.i.zOrder(d);null!=e&&e.getZIndex()>c&&(c=e.getZIndex())}d=[];e=[];for(let g of b)g.isDef(f.CetModel.ID.Z_OBJECT)&&this.Kn(g,++c,d,e),g.isDef(f.CetModel.ID.FLY_TO_OVERVIEW_EP)&&this.lj(g,a),g.isDef(f.CetModel.ID.OVERVIEW)&&this.Jn(a,g);this.Xo(d,e)}update(a){var b=a.getPrezi();this.uw(b);this.ow(b);this.nx(a)&&(b=a.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW),this.Jn(a,b))}nx(a){let b=a.getPrezi().getComponent(f.CetModel.ID.PREZI.OVERVIEW);if(null==b)return!1;a=k.i.pathKludge.getEditorPathComponent(a).getVersion();
if(b.getVersion()===this.jo&&this.ko===a)return!1;this.jo=b.getVersion();this.ko=a;return!0}Jn(a,b){if(null!=b){if(null==k.i.draw(b)){var c=h.CetRendererModule.createOverViewFrameDrawComponent();b.setComponent(h.CetRendererModule.getDrawComponentKey(),c);b.set(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD,v.Geometry.transform2dIdentity());const d=k.i.parseAspectRatio(a.getPreziW().getAspectRatio());c.setAspectRatio(d.width,d.height,d.letterBoxing)}null==k.i.visibility(b,!0)&&(c=new xa.He,c.setAlpha(0),
c.setEnabled(!1),b.setUntypedComponent(h.CetRendererModule.getVisibilityComponentKey(),c));a.getPreziW().getMutablePath().forEachMutable((b)=>{b=b.getEntity();b.hasComponent(f.CetModel.ID.HAS_TARGET.TARGET)||this.lj(b,a)});b=a.getPreziW();e.Cet.pathKludge.assertEditorPathV2(b);b.getMutableEditorPath().getMutableSteps().forEachMutable((b)=>{b=b.getEntity();b.hasComponent(f.CetModel.ID.HAS_TARGET.TARGET)||this.lj(b,a)})}}ow(a){a=a.getChild(f.CetModel.ID.PREZI.BACKGROUND);let b=a.getComponent(f.CetModel.ID.BACKGROUND.LAYERS);
b.getVersion()!==this.eo&&(this.eo=b.getVersion(),a.forEachChild(f.CetModel.ID.BACKGROUND.LAYERS,(a)=>{let b;a.hasComponent(h.CetRendererModule.getDrawComponentKey())||(b=a.isDef(f.CetModel.ID.BACKGROUND_IMAGE)?h.CetRendererModule.createImageDrawComponent():h.CetRendererModule.createXvgDrawComponent(),l.f.setGroupingComp(a,ha.Kd.gl).setComponent(h.CetRendererModule.getDrawComponentKey(),b))}))}uw(a){let b=a.getComponent(f.CetModel.ID.PREZI.Z_OBJECTS);if(b.getVersion()!==this.oo){this.oo=b.getVersion();
var c=0,d=[],e=[];a.forEachChild(f.CetModel.ID.PREZI.Z_OBJECTS,(a)=>{this.Kn(a,c,d,e);c++});this.Xo(d,e)}}Xo(a,b){for(let a of b)a.setComponent(l.f.GROUPING,this.qt(a));for(let b of a)this.Is(b)}lj(a,b){a.set(f.CetModel.ID.HAS_TARGET.TARGET,b.getPreziW().getOverview().getId())}Kn(a,b,c,d){null==l.f.visibility(a,!0)&&l.f.setVisibility(a,!0,1);a.isDef(f.CetModel.ID.Z_TEXT)&&!a.hasComponent(l.f.Aa)&&a.setComponent(l.f.Aa,Ea.Ae.create(a,this.K.ph));a.hasComponent(h.CetRendererModule.getDrawComponentKey())||
a.setComponent(h.CetRendererModule.getDrawComponentKey(),this.Gi(a));if(!a.hasComponent(h.CetRendererModule.getIsStackComponentKey())&&a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)){const b=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);null!=b&&b.isDef(f.CetModel.ID.STACK_CHAPTER)&&a.set(h.CetRendererModule.getIsStackComponentKey(),!0)}a.hasComponent(l.f.GROUPING)||(a.getDef()===f.CetModel.ID.Z_GROUP?c.push(a):d.push(a));c=k.i.zOrder(a);d=a.isDef(f.CetModel.ID.Z_ZOOM_AREA)?h.LayerType.StoryLayer:null!=
c?c.getZLayer():h.LayerType.PdomLayer;null!=c&&c.getZLayer()===d&&c.getZIndex()===b||a.setUntypedComponent(h.CetRendererModule.getZOrderComponentKey(),h.CetRendererModule.createZOrderComponent(b,d))}init(){}lg(){this.ko=this.jo=this.eo=this.oo=-1}reset(){this.lg()}Is(a){let b=[];var c=a.getComponent(l.f.MODEL).getPdomObject();for(c=c.getChildren().iterator();c.hasNext();){let a=c.next();b.push(a)}a.setComponent(l.f.GROUPING,S.cb.jw(b));for(let c of b)a.getEntityList().getEntityById(c).setComponent(l.f.GROUPING,
a.getDef()===f.CetModel.ID.Z_VIDEO?S.cb.kw(a):S.cb.lw(a))}qt(a){a=a.getDef();return a===f.CetModel.ID.Z_CIRCLE||a===f.CetModel.ID.Z_CIRCLE_FRAME||a===f.CetModel.ID.Z_RECTANGLE_FRAME||a===f.CetModel.ID.Z_SQUARE||a===f.CetModel.ID.Z_INVISIBLE_FRAME||a===f.CetModel.ID.Z_BRACKET_FRAME||a===f.CetModel.ID.Z_TRIANGLE?ha.Kd.nq:ha.Kd.gl}getChildIds(a){return l.f.grouping(a).getChildIds()}Gi(a){let b=a.getDef();if(b===f.CetModel.ID.Z_GROUP)return h.CetRendererModule.createZPersistentGroupDrawComponent((a)=>
this.getChildIds(a));if(b===f.CetModel.ID.Z_ARROW)return h.CetRendererModule.createZArrowDrawComponent();if(b===f.CetModel.ID.Z_BRACKET_FRAME)return h.CetRendererModule.createZBracketFrameDrawComponent();if(b===f.CetModel.ID.Z_CIRCLE)return h.CetRendererModule.createZCircleDrawComponent();if(b===f.CetModel.ID.Z_CIRCLE_FRAME)return h.CetRendererModule.createZCircleFrameDrawComponent();if(b===f.CetModel.ID.Z_IMAGE)return h.CetRendererModule.createImageDrawComponent();if(b===f.CetModel.ID.Z_INVISIBLE_FRAME)return h.CetRendererModule.createZInvisibleFrameDrawComponent();
if(b===f.CetModel.ID.Z_TOPIC_CONTAINER)return h.CetRendererModule.createZTopicContainerDrawComponent();if(b===f.CetModel.ID.Z_ZOOM_AREA)return h.CetRendererModule.createZZoomAreaDrawComponent();if(b===f.CetModel.ID.Z_LINE)return h.CetRendererModule.createZLineDrawComponent();if(b===f.CetModel.ID.Z_PLACEHOLDER)return h.CetRendererModule.createZPlaceHolderDrawComponent();if(b===f.CetModel.ID.Z_RECTANGLE_FRAME)return h.CetRendererModule.createZRectangleFrameDrawComponent();if(b===f.CetModel.ID.Z_SQUARE)return h.CetRendererModule.createZRectangleDrawComponent();
if(b===f.CetModel.ID.Z_PDF||b===f.CetModel.ID.Z_CHART_PDF||b===f.CetModel.ID.Z_SWF_GRAPHICS||b===f.CetModel.ID.Z_SLIDE)return h.CetRendererModule.createXvgDrawComponent();if(b===f.CetModel.ID.Z_TEXT)return h.CetRendererModule.createZTextDrawComponent(this.ay);if(b===f.CetModel.ID.Z_TRIANGLE)return h.CetRendererModule.createZTriangleDrawComponent();if(b===f.CetModel.ID.Z_VIDEO)switch(a.get(f.CetModel.ID.Z_VIDEO.VIDEO_TYPE)){case "video":return h.CetRendererModule.createVideoThumbnailDrawComponent(z.ba.WIDTH,
z.ba.HEIGHT,z.ba.Pr,z.ba.Or,z.ba.Nr,z.ba.Mr);default:return h.CetRendererModule.createVideoThumbnailDrawComponent(B.Eb.Mf,B.Eb.Lf,B.Eb.Hq,B.Eb.Gq,B.Eb.Fq,B.Eb.Eq)}return b===f.CetModel.ID.Z_MARKER||b===f.CetModel.ID.Z_PENCIL?h.CetRendererModule.createZMarkerPencilDrawComponent():b===f.CetModel.ID.Z_SHAPE?(a=a.getWrapper(f.CetModel.ID.Z_SHAPE.W),a.getShapeType()===f.ShapeType.Oval?h.CetRendererModule.createZOvalDrawComponent():a.getShapeType()===f.ShapeType.Rectangle?h.CetRendererModule.createZRectangleDrawComponent():
a.getShapeType()===f.ShapeType.Triangle?h.CetRendererModule.createZTriangleDrawComponent():h.CetRendererModule.createZRectangleDrawComponent()):b===f.CetModel.ID.Z_ANIMATED_IMAGE?h.CetRendererModule.createAnimatedImageDrawComponent():null}changesPdomComponents(){return!1}};ha.Kd.gl=new S.cb("NotGroup",null,null);ha.Kd.nq=new S.cb("AutoGroup",null,null);var kc={};Object.defineProperty(kc,"__esModule",{value:!0});kc.hs=class{constructor(a){this.Pp=a}getId(){return"SpeedMeasurementProcessor"}update(){if(this.Pp.isAutoplaySpeedTestInProgress())return 5E3;
this.Pp.processStatistics();return 5E3}reset(){}};var V={};Object.defineProperty(V,"__esModule",{value:!0});V.nb=class{constructor(a=!1,b=!1){this.tryRetainMainCanvas=a;this.highDPICanvas=b;this.size={width:640,height:480};this.Yj=p.Bacon.newBus();this.Im=p.Bacon.newBus();this.Fp=p.Bacon.mergeAll([this.getResizeStream(),this.Im]).toProperty(this.size);this.Fp.onValue(()=>{});this.Nt()}static Um(){return`prezi_cet.CetUIImpl.id${V.nb.rd++}`}Nt(){let a=window.document;this.Pd=a.createElement("div");
this.Pd.className="renderContainer";this.me(this.Pd,this.size);this.wc=a.createElement("div");this.wc.id=V.nb.Um();this.wc.className="playerLayer canvasContainer";this.me(this.wc,this.size);let b=a.createElement("canvas");b.id=V.nb.Um();this.setCanvas(b);this.Pe=a.createElement("div");this.Pe.className="domLayer playerLayer";this.me(this.Pe,this.size);this.Pd.appendChild(this.wc);this.Pd.appendChild(this.Pe)}getCetContainer(){return this.Pd}getDomLayer(){return this.Pe}getCanvasContainer(){return this.wc}getCanvas(){return this.canvas}setCanvas(a){null!=
this.canvas&&this.wc.removeChild(a);this.canvas=a;null!=this.canvas&&(this.Os(a),this.wc.appendChild(a))}Os(a){a.style.background="#000";a.style.top="0";a.style.left="0";a.style.position="absolute";a.style.zIndex="100";this.jp(a,this.getSize());this.Yj.push(this.size)}resize(a){this.size=a;this.me(this.Pd,a);this.me(this.wc,a);this.me(this.Pe,a);this.jp(this.canvas,a);this.Yj.push(a)}static gn(){return window.devicePixelRatio||1}jp(a,b){var c=b.width,d=b.height;this.tryRetainMainCanvas&&(c=b.width>
V.nb.Qf?b.width:V.nb.Qf,d=b.height>V.nb.Qf?b.height:V.nb.Qf);this.highDPICanvas?(a.width=c*V.nb.gn(),a.height=d*V.nb.gn(),a.style.width=c+"px",a.style.height=d+"px"):(a.width=c,a.height=d)}me(a,b){a.width=b.width;a.height=b.height;a.style.width=b.width+"px";a.style.height=b.height+"px"}setFakeSizeForIntegrationTest(a){this.Im.push(a)}getSize(){return this.size}getResizeStream(){return this.Yj.skipDuplicates((a,b)=>a.width===b.width&&a.height===b.height)}getSizeProperty(){return this.Fp}};V.nb.Qf=
2048;V.nb.rd=0;var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.ss=class{constructor(a){this.Rt=a}getName(){return"VideoInitSystem"}process(a){for(let b of a)null!=b.getMutableWrapper(f.CetModel.ID.Z_VIDEO.W).getOnlineAssetUrl()?e.Cet.removeSpinner(b):e.Cet.addSpinner(this.Rt,b)}select(a){return a.isDef(f.CetModel.ID.Z_VIDEO)&&"video"===a.get(f.CetModel.ID.Z_VIDEO.VIDEO_TYPE)}getTriggerKeys(){return[f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL]}changesPdomComponents(){return!1}};var mc=
{};Object.defineProperty(mc,"__esModule",{value:!0});mc.gs=class{constructor(a,b){this.assetManager=a;this.qx=b;this.logger=t.LoggerModule.getLoggerManager().createLogger("SoundInitSystem")}Yt(a,b){for(let c of a){const d=this.version(c,b);a=c.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W);const g=a.getOnlineAssetUrl();a=a.getOfflineAssetId();const q=c.getId(),h=(a)=>{b.requestNoDomBatchUpdate((c)=>{c=c.getEntityById(q);null==c||c.isDisposed()||this.version(c,b)!==d||(c.set(k.i.Xm(),a),this.qx(c.getOwner().getId()))})},
m=(a)=>{this.logger.error({object:"pathSoundDownloadError",action:"SoundInitSystem",trigger:"machine",payload:{message:a,sy:g}})};e.Cet.errorOfflineAssetId===a?m("Asset has errorOfflineAssetId"):null!=g&&(a=this.assetManager.createBinaryFetcher(g).fetch(),a.onValue((a)=>{try{x.AudioUtils.readAsAudioBuffer(a,(a)=>{h(a)},()=>{m("Error decoding audio")})}catch(Lc){m("Error caught")}}),a.onError(()=>m("Fetch error")))}}changesPdomComponents(){return!1}getName(){return"SoundInitSystem"}getTriggerKeys(){return[f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL,
f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID]}process(a,b){this.Yt(a,b)}select(a,b){return null!=b.getEntityById(a.getId())&&!a.isDisposed()&&a.isDef(f.CetModel.ID.PATH_SOUND)}version(a){return a.getComponentVersion(f.CetModel.ID.MEDIA_ASSET.ONLINE_ASSET_URL)+a.getComponentVersion(f.CetModel.ID.MEDIA_ASSET.OFFLINE_ASSET_ID)}};var pb={},Yc=this&&pb.wl||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{q(d.next(a))}catch(X){f(X)}}
function h(a){try{q(d["throw"](a))}catch(X){f(X)}}function q(a){a.done?c(a.value):e(a.value).then(g,h)}q((d=d.apply(a,b||[])).next())})};Object.defineProperty(pb,"__esModule",{value:!0});pb.zr=class{constructor(a){this.bb=a;this.Uj=0;this.xo=p.Bacon.newBus()}init(){}getMediaAssetInfoStatusProperty(){const a=this.xo.skipDuplicates().toProperty(!1);a.onValue(()=>{});return a}getName(){return"MasatInitSystem"}update(a){return Yc(this,void 0,void 0,function*(){const b=[],c=[];a.getEntityList().forEachMutable((a)=>
{const d=null==a?null:e.Cet.mutableDraw(a);if(!a.isDisposed()&&null!=d&&d.kind===h.DrawComponentKind.animatedImage&&!d.isErrorDraw()){const e=a.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID),g=this.bb.getCachedMediaAssetDimensions(e);null!=g?d.setAssetSize(g):(b.push(a.getId()),c.push(e))}},this);if(0<c.length){this.Uj++;this.Tj();try{const d=yield this.bb.queryMediaAssetDimensions([...c]);a.requestNoDomBatchUpdate((a)=>{for(let c of b){const b=a.getEntityById(c),g=null==b?null:e.Cet.mutableDraw(b);
null==b||b.isDisposed()||!d.has(b.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID))||null==g||g.kind!==h.DrawComponentKind.animatedImage||g.isErrorDraw()||g.setAssetSize(d.get(b.get(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)))}})}finally{this.Uj--,this.Tj()}}else this.Tj()})}select(a){return null==a.getParentEntity()&&!a.isDisposed()&&a.isDef(f.CetModel.ID.Z_ANIMATED_IMAGE)}getTriggerKeys(){return[f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID]}getVersion(a){return a.getComponentVersion(f.CetModel.ID.HAS_MEDIA_ASSET_ID.MEDIA_ASSET_ID)}reset(){}changesPdomComponents(){return!1}Tj(){this.xo.push(0===
this.Uj)}isTrackingRemovedEntity(){return!1}getRequiredKeysForIndirectTrigger(){return[]}};var qb={};Object.defineProperty(qb,"__esModule",{value:!0});qb.Sk=class{constructor(a,b,c,d,e,f,m){this.assetManager=b;this.Xx=e;var g=e();wa.Fe.Jq=!0;this.options=a;this.pb=new V.nb(a.tryRetainMainCanvas,a.highDPICanvas);this.options.speedMeasurementOptions.measureSpeed&&(this.N=h.CetRendererModule.createSpeedMeter(!Q.isActive("js-dev-no-speed-logging-to-console")),this.N.setSpeedMeasurementMode(this.options.speedMeasurementOptions.speedMeasurementMode),
this.Ip=new kc.hs(this.N.getStatisticsProcessor()));var q=new la.bd;e=new ka.Vc(v.Geometry.rectangleFromData({x:0,y:0,width:this.pb.getSize().width,height:this.pb.getSize().height}));var l=new Db.Xq(e);f=null==f?h.CetRendererModule.createRenderer(a.rendererKind,this.pb.getCanvas(),b,k.i.Pu(),a.isDesktop,()=>{var a,b;return null!==(b=null===(a=this.ra)||void 0===a?void 0:a.Nn())&&void 0!==b?b:!0},()=>{var a,b;return null!==(b=null===(a=this.ra)||void 0===a?void 0:a.xv())&&void 0!==b?b:!0}):f.getMainStage().getRenderer().createSubRenderer(m?
this.pb.getCanvas():null);this.ha=this.vt(f,q,l,e,g,m);m=new Qa.Zh(this.pb.getDomLayer(),this.ha.getCamera(),g);var n=new Wb.xs(m);this.Na={bb:f.getAssetManager(),assetManager:b,o:m,Hc:q,wy:l,video:g,Yx:n,ph:f.getRenderingTextFactory()};this.Je=p.Bacon.newBus();this.po=p.Bacon.newBus();this.Hp=p.Bacon.newBus();this.qo=this.po.toProperty("");this.qo.onValue(()=>{});this.vp=p.Bacon.newBus();this.oc=new Tb.Lr(d,this.ha);this.ca=new Kb.Ar(d);this.Md=new Ab.pq(this.ca);this.fontsLoadedStateHolder=new N.Zq(this.Na.assetManager,
this.getMainStage().getRenderer().getAssetManager());g=new N.mi(this.fontsLoadedStateHolder,this.ha);q=new ha.Kd(this.Na,this.Je,this.ha);l=new fa.tc(new Da.ve);m=new fa.tc(new lb.vl);this.lb=new Wa.gi;e=(new Va.fi(this.lb,this.fontsLoadedStateHolder,this.getMainStage(),this.Na,this.Je)).getSystemFactory().createOverviewFrameSystem(e);n=new pb.zr(f.getAssetManager());this.Jv=n.getMediaAssetInfoStatusProperty();a=[this.oc,q,n,a.headless?null:new fa.tc(new jb.al(f.getAssetManager(),this.Na.o,this.getMediaAssetPatcher(),
this.getAssetThumbnailAnnouncer())),a.headless?null:new fa.tc(new mc.gs(b,(a)=>{this.Hp.push({stepOrActionId:a,path:this.ha.getPathNavigator().getPath()})})),a.headless?null:new fa.tc(new lc.ss(this.Na.o)),g,a.headless?null:new fa.tc(new ic.Rq(this.Na.assetManager)),l,m,a.headless?null:new jc.Fr(this.Je.filter((a)=>"allAssetsLoaded"===a)),e].filter((a)=>null!=a);this.fb=this.lb.createRootScene("BaseModel",{inflateList:[q,g,l,m].concat(null!=c?c.inflateList||[]:[]),updateList:a.concat(null!=c?c.updateList||
[]:[])});this.Md.j=this.fb;this.fb.plugChangeStream(this.oc.Qu());this.fb.plugChangeStream(this.oc.wp);this.fb.mk(this.oc);d.Vw(this.fb);this.ha.markViewChanged()}createSubCetApplication(a,b,c,d){return new qb.Sk({headless:this.options.headless,speedMeasurementOptions:a.speedMeasurementOptions,rendererKind:this.options.rendererKind,isDesktop:this.options.isDesktop},this.assetManager,d,b,this.Xx,this,c)}vt(a,b,c,d,e,f){return new wa.Fe(this.pb.getSize(),d,a,b,c,new Jb.Tr(k.i.createFastForwardNavigationStrategy(d)),
e,f)}getCetUI(){return this.pb}setSpeedMeasurementMode(a){null!=this.N&&this.N.setSpeedMeasurementMode(a)}getSpeedMeasurementMode(){return this.N?this.N.getSpeedMeasurementMode():""}getSceneBuilder(){return new Va.fi(this.lb,this.fontsLoadedStateHolder,this.getMainStage(),this.Na,this.Je)}initializeLoop(a){this.ra=new y.na(this.pb,this.ha,this.fb,this.Na,a,this.Je,this.N);this.po.plug(this.ra.Hl);this.fb.setIdleChangeStream(this.createIdleStream(this.fb.getImmediateChangeStream(null)));a=this.fb.getPrezi().getComponent(l.f.De);
this.vp.plug(this.Qw(a.getCetSessionEditStream()));null!=this.Ip&&this.ra.addIdleWorker(this.Ip,2E3)}getDomLayerManager(){return this.Na.o}startLoop(){this.ha.Zw(()=>this.ra.Zg());this.ra.start()}getSceneHierarchy(){return this.lb}getBaseScene(){return this.fb}getSpeedMeter(){return this.N}getDocument(){return this.oc.getDocument()}updateWithTemplate(a){return this.updateWithIPrezi(a)}updateWithIPrezi(a){return this.oc.Px(this,a,()=>{null!=this.ra&&this.ra.Kl()}).then((a)=>{this.ha.Ra.yh(null);this.getBaseScene().update();
return a})}registerSnapshotCreator(a){this.fb.getPrezi().getComponent(l.f.De).registerSnapshotCreator(a)}resetToEmptyPrezi(){null!=this.ra&&this.ra.Kl();this.oc.rf();this.ha.Ra.yh(null);this.getBaseScene().update()}getAssetFetchingErrorObservable(){return this.Na.assetManager.getAssetFetchingErrorObservable()}getAssetLoadingProperty(){return this.qo}getFontsLoadedProperty(){return this.fontsLoadedStateHolder.Rm}getFontLoadErrorPropery(){return this.fontsLoadedStateHolder.getFontLoadErrorPropery()}getMediaAssetInfoStatusProperty(){return this.Jv}getSoundDownloadedObservable(){return this.Hp}kill(){this.getBaseScene().kill()}getMainStage(){return this.ha}getDocumentVersionInfoStream(){return this.oc.getDocumentVersionInfoStream()}getSceneRender(){return this.ha}createIdleStream(a){a=
this.ra.createIdleStream(a);this.ha.markViewChanged();return a}Qw(a){return this.ra.createUpdateStream(a)}getCetSessionEditStream(){return this.vp}createComponentFactory(){return new ob.Vk(this.Na.o)}getDocumentStamp(){return this.oc.getDocumentStamp()}isAnimFramePending(){return null!=this.ra?this.ra.isAnimFramePending():!1}getEndOfFrameStream(){return null!=this.ra?this.ra.getEndOfFrameStream():null}getAssetThumbnailAnnouncer(){return this.Md}getMediaAssetPatcher(){return this.ca}hasPendingTweens(){return this.ra.hasPendingTweens()}getAssetManager(){return this.assetManager}addIdleWorker(a,
b){if(null==this.ra)throw Error("Application not initialized");this.ra.addIdleWorker(a,b)}};var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.Lq=class{constructor(){this.logger=t.LoggerModule.getLoggerManager().createLogger("editorapi")}cannotStartTransactionBecauseAnOtherIsBeingExecuted(a,b){this.logger.error({action:"cannotStartTransactionBecauseAnOtherIsBeingExecuted",object:"transaction",trigger:"machine",payload:{message:`Cannot start transaction with intent '${a}', because ${b} is being executed.`}})}exceptionInTransactionEndWhenBeginOtherTransaction(a){t.LoggerModule.logException(this.logger,
"transaction","exceptionInTransactionEndWhenBeginOtherTransaction",a)}mediaPatcherAssetIdMissing(){this.logger.error({action:"mediaPatcherAssetIdMissing",object:"MediaAssetPatcher",trigger:"machine",payload:{message:"Cannot patch because old assetId is missing"}})}mediaPatcherPatchingError(){this.logger.error({object:"mediaPatcherPatchingError",action:"MediaAssetPatcher",trigger:"machine",payload:{message:"Cannot patch because old assetId is the error id"}})}overrideSize(a,b,c,d,e,h){this.logger.warn({object:a===
f.CetModel.ID.Z_IMAGE?"ImageInitSystem":"XvgInitSystem",action:"patchSize",trigger:"machine",payload:{message:"Override size",objectId:b,oldWidth:c,oldHeight:d,newWidth:e,newHeight:h}})}overrideSizeSkipped(a,b,c,d,e,h){this.logger.warn({object:a===f.CetModel.ID.Z_IMAGE?"ImageInitSystem":"XvgInitSystem",action:"patchSize",trigger:"machine",payload:{message:"Override size - skipped",objectId:b,oldWidth:c,oldHeight:d,newWidth:e,newHeight:h}})}};var oc={};Object.defineProperty(oc,"__esModule",{value:!0});
oc.Oq=class{constructor(a,b){this.j=a;this.parent=b}getParent(){return this.parent}getMutableParent(a){return a.getEntityById(this.parent.getId())}getType(){return null==k.i.grouping(this.parent)?null:k.i.grouping(this.parent).getGroupType()}getChildIds(){switch(this.getType()){case "PersistentGroup":return k.i.grouping(this.parent).getChildIds();default:return[]}}getMemberIds(){let a=this.getChildIds();a.unshift(this.parent.getId());return a}getChildren(){return this.getChildIds().map((a)=>this.j.getEntityById(a))}getMembers(){return this.getMemberIds().map((a)=>
this.j.getEntityById(a))}getMutableChildren(a){return this.getChildIds().map((b)=>a.getEntityById(b))}getMutableMembers(a){return this.getMemberIds().map((b)=>a.getEntityById(b))}};var pc={};Object.defineProperty(pc,"__esModule",{value:!0});pc.kr=class{constructor(a,b){this.data=a;this.id=b}getId(){return this.id}getData(){return this.data}};var qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.fr=class{constructor(a){this.j=a}getParentOrOverview(a){a=this.getParentId(a);null==a&&(a=this.j.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId());
return a}getDescendantEntitiesInZOrder(a){return e.Cet.sortInZOrder(this.j.getEntityList().getEntitiesById(a.concat(this.getDescendantEntities(a))))}getEntityDistance(a,b){let c=0,d=this.j.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId(),e=[a];for(;a!==b&&a!==d;)++c,a=this.j.getEntityById(a),a=this.getParentOrOverview(a),e.push(a);if(a===b)return c;c=0;for(a=e.indexOf(b);-1===a&&b!==d;)++c,b=this.j.getEntityById(b),b=this.getParentOrOverview(b),a=e.indexOf(b);return-1!==a?a+c:e.length-1+
c}getSmartStructureIdOfEntity(a){if(null!=a){a=this.j.getEntityById(a);if(null==a)return null;if(a.isDef(f.CetModel.ID.OVERVIEW))return this.j.getPreziW().getOverview().getSmartStructure().getId();a=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);return null==a?null:a.isDef(f.CetModel.ID.PLANET_CHAPTER)?a.getWrapper(f.CetModel.ID.PLANET_CHAPTER.W).getSmartStructure().getId():null}a=this.j.getPreziW().getOverview().getSmartStructure();return null!=a?a.getId():null}isChapterWithSmartStructure(a){a=
this.j.getEntityById(a);return null!=a&&a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic().is(f.CetModel.ID.PLANET_CHAPTER):!1}getDescendantEntities(a){var b=1<a.length;a=this.en(a);if(b){a.sort((a,b)=>{a=a.toLowerCase();b=b.toLowerCase();return a<b?-1:a>b?1:0});b=[];for(let c=0,d=a.length;c<d;c++)(0===c||0<c&&a[c]!==a[c-1])&&b.push(a[c]);a=b}return a}en(a){let b=[];for(let c of a)a=this.j.getEntityById(c),null!=a&&this.isZTopicContainer(c)&&(a=this.getChildrenIds(a),
0!==a.length&&(b=[...b,...a,...this.en(a)]));return b}isZTopicContainer(a){a=this.j.getEntityById(a);return null!=a?a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER):!1}getChildrenIds(a){var b=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic();if(null==b)return[];b=b.getEntity();if(b.isDef(f.CetModel.ID.HAS_TOPIC_CHILDREN)){let a=[];b.getWrapper(f.CetModel.ID.HAS_TOPIC_CHILDREN.W).getTopicChildren().forEach((b)=>{null!=b&&a.push(b.getChild())});return a}if(b.isDef(f.CetModel.ID.HAS_CHILDREN))return b.getWrapper(f.CetModel.ID.HAS_CHILDREN.W).getChildren().items();
throw Error("Invalid topic entity "+a.getId());}getParentId(a){if(null==a)return null;var b=a.get(f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT),c=null;null!=b&&0<b.length?(b=a.getEntityList().getEntityById(b[0]),null!=b&&(c=b.get(f.CetModel.ENTITY_OWNER_ID()))):(b=a.get(f.CetModel.ID.HAS_CHILDREN.CHILDREN_PARENT),null!=b&&0<b.length&&(c=b[0]));if(null!=c&&(c=a.getEntityList().getEntityById(c),null!=c)){c=c.get(f.CetModel.ENTITY_OWNER_ID());if(!a.getEntityList().getEntityById(c).isDef(f.CetModel.ID.Z_TOPIC_CONTAINER))throw Error(`Entity with id: ${c} is not a Z_TOPIC_CONTAINER`);
return c}return null}getSubTrees(a){return this.getDescendantEntities(a).concat(a)}getTopLevelEntities(){return x.Utils.Lambda().filter(this.j.getPreziW().getZObjects(),(a)=>null==this.getParentId(a.getEntity())).map((a)=>a.getId())}getChildrenIdsWithOverviewFallback(a){const b=this.j.getEntityById(a);return null==b?[]:this.j.getPrezi().getChild(f.CetModel.ID.PREZI.OVERVIEW).getId()===a?this.getTopLevelEntities():b.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?this.getChildrenIds(b):[]}getChildrenEntities(a){let b=
[];a.forEach((a)=>{b=[...b,...this.getChildrenIdsWithOverviewFallback(a)]});return b}getAncestorEntities(a){return null==this.j.getEntityById(a)?[]:this.Vm(a,[])}Vm(a,b){a=this.j.getEntityById(a);a=this.getParentOrOverview(a);if(null==a||0<=b.indexOf(a))return b;b.push(a);return this.Vm(a,b)}getLowestCommonAncestor(a,b=!1){if(0===a.length)return null;let c=this.getAncestorEntities(a[0]);b&&(c=[a[0]].concat(c));for(let d=1;d<a.length;++d){let e=this.getAncestorEntities(a[d]);b&&(e=[a[d]].concat(e));
c=this.Eu(c,e);if(0===c.length)break}return 0===c.length?null:c[0]}Eu(a,b){a=a.slice(0);a.reverse();b=b.slice(0);b.reverse();let c=0;for(;c<a.length&&c<b.length&&a[c]===b[c];)++c;if(0===c)return[];a=a.slice(0,c);a.reverse();return a}getDepthOfEntity(a){let b=0;if(a!==this.j.getPreziW().getOverview().getId())for(;null!=a;)b++,a=this.j.getEntityById(a),a=this.getParentId(a);return b}getChildParentDistance(a,b){let c=0;for(;a!==b;){if(null==a&&null!=b)throw Error(`Can't calculate distance between childId: ${a} and parentId: ${b}`);
++c;a=this.j.getEntityById(a);a=this.getParentId(a)}return c}getTopicLocalZoomBounds_killme(a){return h.CetRendererModule.calculateWorldZoomObb_killme(a).transform(l.f.transform(a).getLocalToWorld().invert()).getBounds()}getReachableEntities(a,b=e.VisualBackgroundReachLevel.ALL_VISUALS){let c=[];if(null==this.j.getEntityById(a))return c;c.push(a);const d=e.Cet.createTopicChildrenQuery(this.j),f=e.Cet.createHierarchyQuery(this.j),h=d.getChildrenIds(a,e.TopicChildBehavior.Content);c=c.concat(h);b>=
e.VisualBackgroundReachLevel.OWN_VISUAL&&(c=[...c,...d.getChildrenIds(a,e.TopicChildBehavior.Visual),...d.getChildrenIds(a,e.TopicChildBehavior.Surface),...d.getChildrenIds(a,e.TopicChildBehavior.Master)]);h.forEach((a)=>{c=[...c,...d.getChildrenIdsVisibleOutside(a)]});b>=e.VisualBackgroundReachLevel.ALL_VISUALS&&f.getAncestorEntities(a).forEach((a)=>{c=[...c,...d.getChildrenIdsVisibleBelow(a)]});b===e.VisualBackgroundReachLevel.ALL_VISUALS_AND_BACKGROUND&&this.j.getPreziW().getBackground().getLayers().forEach((a)=>
{a=a.getEntity();c.push(a.getId())});return c}};var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.rq=class{constructor(a,b){this.type=a;this.eb=b}getType(){return this.type}getAutoPlayer(){return this.eb}};var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.sq=class{constructor(a,b){this.enabled=!1;this.interval=-1;this.loop=!1;this.nc=a;b.onValue(()=>this.Sv());this.Dm=p.Bacon.newBus()}Sv(){this.enabled&&this.next()}next(){this.Bv()?this.loop?this.nm(()=>{this.tf(e.AutoPlayEventType.RESTART);
this.nc.go(this.nc.getPath().getPathPosition(0,0))}):this.stop():this.nm(()=>{this.tf(e.AutoPlayEventType.NEXT);this.nc.next()})}Bv(){return this.nc.getPath().getPathCalculator().isLast(this.nc.getCurrentPosition())}ct(){null!=this.zk&&(this.zk.stop(),this.zk=null)}nm(a){this.tf(e.AutoPlayEventType.WAIT);0>=this.interval?a():this.zk=x.Utils.delay(a,this.interval)}start(){this.enabled||(this.enabled=!0,this.tf(e.AutoPlayEventType.START),this.next())}stop(){this.enabled&&(this.ct(),this.enabled=!1,
this.tf(e.AutoPlayEventType.STOP))}toggle(){this.enabled?this.stop():this.start();return this.enabled}isEnabled(){return this.enabled}getInterval(){return this.interval}setInterval(a){this.interval=a}isLoop(){return this.loop}setLoop(a){this.loop=a}tf(a){this.Dm.push(new rc.rq(a,this))}getPathNavigator(){return this.nc}getEventStream(){return this.Dm}};var Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.ye=class{constructor(a){this.camera=a;this.tj=0}getNavigationMode(a){let b=this.getCurrentTime(),
c=this.Cv(b);this.tj=b;this.camera.isInTransition()||(a=e.NavigationChange.NEW_TARGET);switch(a){case e.NavigationChange.NEW_TARGET:a=c?e.NavigationMode.JUMP:e.NavigationMode.NEW_TRANSITION;break;case e.NavigationChange.CONTINUE:a=this.camera.isInAcceleratedTransition()||this.Ns()?e.NavigationMode.JUMP:e.NavigationMode.ACCELERATE;break;case e.NavigationChange.TURN_BACK:a=this.camera.isInAcceleratedTransition()?e.NavigationMode.JUMP:e.NavigationMode.INVERSE_ACCELERATE;break;default:throw Error("unkown NavigationIntent "+
a);}return a}getCurrentTime(){return(new Date).getTime()}reset(){this.tj=0}Cv(a){return a-this.tj<Fa.ye.Uq}Ns(){return this.camera.getRemainingTransitionTime()<Fa.ye.lq}};Fa.ye.Uq=300;Fa.ye.lq=600;var tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.mr=class{constructor(){}getNavigationMode(){return e.NavigationMode.JUMP}reset(){}};var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.Ee=class{constructor(a){this.o=a;this.vk="spinner"+Ga.Ee.rd++;this.Rn=this.visible=!1}static Ks(a,
b){b=new Ga.Ee(b);a.setComponent(k.i.wk,k.i.createOverlayComponent(b,b))}static Aw(a){for(;null!=a;){const b=a.getComponent(k.i.wk,!0);null!=b&&(b.dispose(),a.discardOwnComponent(k.i.wk));a=a.getParentEntity()}}refresh(a,b){null==this.ac&&this.Jt();this.setVisibility(b);this.visible?(this.o.positionElementToCenter(this.vk,36,36),a=b.get(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD),a=v.Geometry.createFromTransform(a),this.o.transformWithoutScale(this.vk,a),this.Rn?this.ac.style.display="block":this.ku()):
this.ac.style.display="none"}dispose(){null!=this.ac&&(null!=this.ac.parentElement&&this.ac.parentElement.removeChild(this.ac),this.ac=null)}Jt(){let a=this.o.createElement(this.vk),b=window.document.createElement("div");a.appendChild(b);a.style.width="36px";a.style.height="36px";a.style.padding="9px";a.style.border="1px solid rgba(255, 255, 255, .7)";a.style.borderRadius="4px";a.style.background="#152235";a.style.opacity="0.8";a.style.boxSizing="border-box";b.style.height="18px";b.style.width="18px";
b.style.animation="rotating 1s linear infinite";b.style["-webkit-animation"]="rotating 1s linear infinite";b.style["-moz-animation"]="rotating 1s linear infinite";b.style.background="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAfRJREFUOBGFlD9Pk1EUh/vS8kckjRKCMjE4KAkJJsrgxgcgMPIJcHDQRGDzGzi4+QGcXdwKqwsOhISBydCkA2EglIZAii3U53m9t7m2Ddzkec+95573955z72mzwoDR6XRe4l4C7VMYhjocwE6WZbvY/0aWrhCYYf0OFqAECoz0WH378AnBKjYfXSFEnuPZhEeQioyyViyikFzCOmK/sIUhH4g8wXyAMWjDDdxCJ4DJY40vBiax33j3GbaQZ8TCTF6AQTGbI+Y/4DcYNw9v4Q3ErIzfJavlLJT0Hkf8mkIV+E6AWXUHscZswQbEj+pb8eHBtgJ/sIfQJ4KvEIQ/M92D9BLWFJoFhRS5hkpvJvi6I+x9xTEBD8CyFy1jHBSJN1hjft/4ScAXqMM5nClkNop4Q45o/60GPxtk9jHdUkjVx6CAh2srXMBdo8jBe0bxnfwWqjjiGVniAkGxzD6xsOf5pI2aedjeUnprU6xfDRILPjv/IcRbs6duS9RaI8ADtiQ72s6egzJ+P2LpluCl2M32TzxXE2mi0cpL4AW/shqCFIql2g7SDNa55btvnJwg1FbRRvMKt+EK3DSz9PfmB401m7SjTxXB1+0d5/54y5jX4C3Gc4vZpesG+8eImF0+Bt4OgtPszoDCZmB2/m14XmbR1x5/Ab/LqfQjXlacAAAAAElFTkSuQmCC)";
a.style.display="none";this.ac=a}ku(){let a=$(this.ac);a.delay(500);a.fadeIn(500);this.Rn=!0}setVisibility(a){let b=this.isVisible(a);b!==this.visible&&(this.visible=b);a=k.i.visibility(a).getAlpha();this.ac.style.opacity=.8>a?String(a):"0.8"}isVisible(a){return null!=k.i.visibility(a)&&k.i.visibility(a).isVisible()&&!a.get(h.CetRendererModule.getHideDomComponentKey())}};Ga.Ee.rd=0;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.qq=class{constructor(a){this.ca=a}createAssetId(){return this.ca.createId()}patchUrl(a,
b,c,d,e,f){this.ca.addPatch(a,(a)=>{a.updateAudioType(e);a.updateMediaLength(f);a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}};var Xa={};Object.defineProperty(Xa,"__esModule",{value:!0});Xa.di=class{static ij(a){a=a.getEntity();const b=new Set(f.CetModel.ID.STYLE_BLOCK.getFields());for(const c of a.getDef().getFieldDescriptors())if(c.kind===f.FieldDescriptorKind.Scalar&&!b.has(c.fieldKey)){const b=a.getUntypedComponent(c.fieldKey);null!=b&&b.incrementVersion()}}};
var vc={};Object.defineProperty(vc,"__esModule",{value:!0});vc.xq=class{constructor(a){this.ca=a}createAssetId(){return this.ca.createId()}patchBack(a){Xa.di.ij(a)}patchUrl(a,b,c,d,e){this.ca.addPatch(a,(a)=>{a.updateChartId(e);a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.ca.addError(a,(a)=>{a.updateChartId("");a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null);a.updateAssetSourceFilename(null)})}};var Na={};Object.defineProperty(Na,"__esModule",
{value:!0});Na.Of=class{constructor(a){this.ca=a}canPatch(a){return null!=a.getOfflineAssetId()&&""!==a.getOfflineAssetId()}createAssetId(){return this.ca.createId()}patchBack(a){Xa.di.ij(a)}patchSizeAndScale(a,b,c){this.ca.addPatch(a,(a)=>{if(null==this.rn().safeCastToLogo(a)){var d=a.getWidth(),e=a.getHeight(),f=b,k=c,m=d,l=e,n=a.getMask();null!=n&&(m=n.getWidth(),l=n.getHeight(),a.updateMask(h.CetRendererModule.tranformMaskRectangle(n,{width:d,height:e},{width:b,height:c})),f=a.getMask().getWidth(),
k=a.getMask().getHeight());a.updateLocalToWorld(this.getLocalToWorld(a,m,l,f,k));a.updateWidth(b);a.updateHeight(c)}})}rn(){null==Na.Of.lp&&(Na.Of.lp=m.DOM.RuntimeTypeInfo());return Na.Of.lp}getLocalToWorld(a,b,c,d,e){b=null!=this.rn().safeCastToZImage(a)?Math.max(b,c)/Math.max(d,e):Math.max(b/d,c/e);a=a.getLocalToWorld();return a.scaleAroundPoint(a.getTranslation(),b)}patchUrl(a,b,c,d){this.ca.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.ca.addError(a,
(a)=>{a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null)})}};var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.Sr=class{constructor(a){this.ca=a}createAssetId(){return this.ca.createId()}patchBack(a){Xa.di.ij(a)}patchSizeAndScale(a,b,c){this.ca.addPatch(a,(a)=>{var d=a.getWidth()/b,e=a.getHeight()/c;d=Math.min(d,e);a.updateWidth(b);a.updateHeight(c);e=a.getLocalToWorld();a.updateLocalToWorld(e.scaleAroundPoint(e.getTranslation(),d));a.getDomType()===m.DomType.Z_SLIDE&&(d=a.getImportedAsset(),
null!=d&&a.updateImportedAsset(m.DOM.createImmutableImportedPdfAsset(d.getImportJobId(),this.Mo(d.getNoBackgroundPdfAsset(),a.getOnlineAssetUrl(),b,c),this.Mo(d.getOriginalPdfAsset(),a.getOnlineAssetUrl(),b,c),d.getSourcePageNumber())))})}Mo(a,b,c,d){return m.DOM.createImmutablePdfAsset(a.getAssetSourceFilename(),a.getOnlineAssetUrl()===b?d:a.getHeight(),a.getImageScaleX(),a.getImageScaleY(),a.getIsFlipped(),a.getMask(),a.getOfflineAssetId(),a.getOnlineAssetId(),a.getOnlineAssetUrl(),a.getPageNumber(),
a.getPdfBoundsLeft(),a.getPdfBoundsTop(),a.getTransparent(),a.getOnlineAssetUrl()===b?c:a.getWidth())}patchUrl(a,b,c,d,e){this.ca.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b);a.updatePageNumber(e)})}error(a){this.ca.addError(a,(a)=>{a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null)})}};var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.vs=class{constructor(a){this.ca=a}createAssetId(){return this.ca.createId()}patchUrl(a,b,c,
d){this.ca.addPatch(a,(a)=>{a.updateOnlineAssetUrl(d);a.updateOnlineAssetId(c);a.updateAssetSourceFilename(b)})}error(a){this.ca.addError(a,(a)=>{a.updateOnlineAssetUrl(null);a.updateOnlineAssetId(null)})}};var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.ai=class{constructor(){}getZObjectType(){return this.Vh}setZObjectType(a){this.Vh=a}getZObjectStrategy(){return this.$x}setZObjectStrategy(a){this.setZObjectType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.$x=a}getStyleType(){return this.Hh}setStyleType(a){this.Hh=
a}getStyleStrategy(){return this.yx}setStyleStrategy(a){this.setStyleType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.yx=a}getFontFamilyType(){return this.zg}setFontFamilyType(a){this.zg=a}getFontFamilyStrategy(){return this.wu}setFontFamilyStrategy(a){this.setFontFamilyType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.wu=a}getFontFaceType(){return this.yg}setFontFaceType(a){this.yg=a}getFontFaceStrategy(){return this.vu}setFontFaceStrategy(a){this.setFontFaceType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.vu=
a}getFontClassType(){return this.xg}setFontClassType(a){this.xg=a}getFontClassStrategy(){return this.uu}setFontClassStrategy(a){this.setFontClassType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.uu=a}getBackgroundType(){return this.fg}setBackgroundType(a){this.fg=a}getBackgroundStrategy(){return this.Us}setBackgroundStrategy(a){this.setBackgroundType(e.MergeType.REPLACE_DIFFED_CUSTOM);this.Us=a}};var yc={};Object.defineProperty(yc,"__esModule",{value:!0});class Zc{constructor(){this.ue={};this.Kh=[];this.contentChildren=
{};this.coverChildren={};this.visualChildren={};this.parents={}}getChildren(a,b){switch(a){case m.TopicChildBehaviourType.VISUAL:return this.visualChildren[b];case m.TopicChildBehaviourType.COVER:return this.coverChildren[b];default:return this.contentChildren[b]}}}yc.Ur=class{constructor(a){this.ud=a;this.Yc=Math.pow(2,-40);this.Zb=this.Hi(a)}withOtherPrezi(a){this.ud=a;this.Zb=this.Hi(a)}withRefPrezi(a){this.wd=a;this.mh=this.Hi(a)}Hi(a){const b=new Zc;for(a=a.getZObjects().iterator();a.hasNext();){const e=
a.next();b.ue[e.getId()]=e;if(this.isZTopicContainer(e)){var c=e.getTopic();if(this.Og(c)){b.coverChildren[e.getId()]=[];b.visualChildren[e.getId()]=[];var d=[];for(c=c.getChildren().iterator();c.hasNext();){const a=c.next();d.push(a);b.parents[a]=e.getId()}b.contentChildren[e.getId()]=d}else if(this.$n(c)||this.Xn(c))for(b.Kh.push(e.getId()),b.coverChildren[e.getId()]=[],b.visualChildren[e.getId()]=[],b.contentChildren[e.getId()]=[],d=c.getTopicChildren().iterator();d.hasNext();)c=d.next(),b.parents[c.getChild()]=
e.getId(),c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.VISUAL?b.visualChildren[e.getId()].push(c.getChild()):c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.COVER?b.coverChildren[e.getId()].push(c.getChild()):c.getBehaviour().getObjectType()===m.TopicChildBehaviourType.CONTENT&&b.contentChildren[e.getId()].push(c.getChild())}}return b}isZTopicContainer(a){return a.getObjectType()===m.ZObjectType.Z_TOPIC_CONTAINER}Og(a){return a.getObjectType()===m.TopicType.PAGE}Xn(a){return a.getObjectType()===
m.TopicType.PLANET_CHAPTER}$n(a){return a.getObjectType()===m.TopicType.STACK_CHAPTER}Ev(a){return a.getObjectType()===m.ZObjectType.Z_SHAPE}getDepth(a,b){let c=0;for(b=a.parents[b];null!=b;)c++,b=a.parents[b];return c}getBackgroundAssetDistance(){if(null==this.wd)throw"No reference Prezi defined!";return m.DOM.compareBackground(this.wd.getBackground(),this.ud.getBackground())?0:1}vn(a){return null!=a.getOnlineAssetUrl?null!=a.getOnlineAssetUrl()?a.getOnlineAssetUrl():a.getAssetSourceFilename():this.Ev(a)?
a.getShapeType():m.ZObjectType[a.getObjectType()]}Ec(a,b){var c=[];c[a]=0;c.fill(0);if(0===this.Zb.Kh.length)return c.slice(0);let d=c.slice(0),e=c.slice(0);for(const f of this.Zb.Kh)c=Math.min(a,this.getDepth(this.Zb,f)),e[c]+=1,d[c]+=b(f);return d.map((a,b)=>0<e[b]?a/e[b]:0)}getAvgTopicCoverStructureDistance(a){if(null==this.wd)throw"No reference Prezi defined!";return this.Ec(a,(a)=>this.Fu(a))}getAvgTopicVisualStructureDistance(a){if(null==this.wd)throw"No reference Prezi defined!";return this.Ec(a,
(a)=>this.Xu(a))}cn(a,b){const c=this.Zb.ue[a];let d=[];a=this.Zb.getChildren(b,a);for(var e of a)d.push(this.vn(this.Zb.ue[e]));d=d.sort();for(const f of this.mh.Kh)if(this.mh.ue[f].getTopic().getObjectType()===c.getTopic().getObjectType()){e=this.mh.getChildren(b,f);a=[];for(const b of e)a.push(this.vn(this.mh.ue[b]));a=a.sort();if(x.Utils.arrayEquals(a,d))return 0}return 1}Xu(a){if(null==this.wd)throw"No reference Prezi defined!";return this.cn(a,m.TopicChildBehaviourType.VISUAL)}Fu(a){return this.cn(a,
m.TopicChildBehaviourType.COVER)}getAvgCoverTypeCountsPerLevel(a){return this.Ym(a,m.TopicChildBehaviourType.COVER)}getAvgVisualTypeCountsPerLevel(a){return this.Ym(a,m.TopicChildBehaviourType.VISUAL)}Ym(a,b){const c={};c[m.ZObjectType.Z_SHAPE]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_SHAPE));c[m.ZObjectType.Z_IMAGE]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_IMAGE));c[m.ZObjectType.Z_PDF]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_PDF));c[m.ZObjectType.Z_TEXT]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_TEXT));
c[m.ZObjectType.Z_LINE]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_LINE));c[m.ZObjectType.Z_ARROW]=this.Ec(a,(a)=>this.Wd(a,b,m.ZObjectType.Z_ARROW));return c}Wd(a,b,c){a=this.Zb.getChildren(b,a);b=0;for(const d of a)this.Zb.ue[d].getObjectType()===c&&b++;return b}getBackgroundStyleDistance(){if(null==this.wd)throw"No reference Prezi defined!";const a=this.Jm(this.wd),b=this.Jm(this.ud);return null==a&&null==b?0:null!=a&&null==b||null==a&&null!=b?1:m.DOM.compareStyleDeclaration(a,b)?0:1}Jm(a){let b=
null;for(a=a.getDocumentStyle().getStyleDeclarations().iterator();a.hasNext();){const c=a.next();if("background"===c.getStyleSelector().toString()){b=c;break}}return b}collectBasicStats(){var a=this.ud.getZObjects();let b=a.length(),c=0,d=0,e=0,f=0,h=0,k=0,l=0,n=0,p=0,r=0,t=0,u=0,v=0,w=0,x=0,z=0,A=0,C=0,D=0;var E=a.iterator();for(a=[];E.hasNext();){var y=E.next(),B=y.getId();switch(y.getObjectType()){case m.ZObjectType.Z_ARROW:++f;break;case m.ZObjectType.Z_LINE:++e;break;case m.ZObjectType.Z_SHAPE:++d;
break;case m.ZObjectType.Z_GROUP:++c;break;case m.ZObjectType.Z_IMAGE:B=y;z+=Math.floor(B.getWidth()*B.getHeight());++h;break;case m.ZObjectType.Z_PDF:++k;break;case m.ZObjectType.Z_PLACEHOLDER:++t;break;case m.ZObjectType.Z_SWF_GRAPHICS:++l;break;case m.ZObjectType.Z_TEXT:B=y;B.getIsPlaceholder()?++v:(++u,x+=this.Ou(B));break;case m.ZObjectType.Z_VIDEO:++n;switch(y.getVideoType()){case "youtube":++p;break;case "vimeo":++r}break;case m.ZObjectType.Z_CHART_PDF:++D;break;case m.ZObjectType.Z_TOPIC_CONTAINER:y=
y.getTopic(),this.$n(y)?(a.push(B),++C):this.Xn(y)?(a.push(B),++A):this.Og(y)&&++w}}B=E=0;for(y=this.ud.getPath().iterator();y.hasNext();){const a=y.next();E+=a.getActions().length();null!=a.getSound()&&++B}return{num_objects:b,num_groups:c,num_shapes:d,num_lines:e,num_arrows:f,num_images:h,num_pdfs:k,num_swfs:l,num_videos:n,num_youtube_videos:p,num_vimeo_videos:r,num_placeholders:t,num_texts:u+v,num_real_texts:u,num_placeholder_texts:v,num_pages:w,num_characters:x,num_pixel_count:z,num_steps:this.ud.getPath().length(),
num_animations:E,num_audios:B,num_topics:C+A,num_planet_topics:A,num_stack_topics:C,num_charts:D,deepest_structure:this.Lu(a),aspect_ratio:this.ud.getAspectRatio()}}Ou(a){if(null==a||null==a.getText()||null==a.getText().getParagraphs())return 0;a=a.getText().getParagraphs();let b=0,c=0;for(;c<a.length;){let d=a[c++];null!=d&&(b+=d.getLength())}return b}Lu(a){return 0===a.length?0:Math.max(...a.map((a)=>this.getDepth(this.Zb,a)))}};var rb={};Object.defineProperty(rb,"__esModule",{value:!0});rb.kl=
class{constructor(a){this.Ug=a;this.logger=t.LoggerModule.getLoggerManager().createLogger("DOM")}static lx(a){a=new rb.kl(a);m.DOM.setLogger(a)}logError(a){this.logger.error({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}logWarn(a){this.logger.warn({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}logInfo(a){this.logger.info({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}logDebug(a){this.logger.debug({object:"PDOM",action:"PDOM",trigger:"machine",payload:a})}isErrorEnabled(){return this.Ug>=
t.Level.ERROR}isWarnEnabled(){return this.Ug>=t.Level.WARN}isInfoEnabled(){return this.Ug>=t.Level.INFO}isDebugEnabled(){return this.Ug>=t.Level.DEBUG}};var zc={};Object.defineProperty(zc,"__esModule",{value:!0});zc.vq=class{constructor(){this.ft=Q.isActive("js-coedit-multi");this.gt=Q.isActive("js-coedit-single-client-load-patches-save");this.Vx=Q.isActive("js-use-preprod-coedit-service");this.Tx=Q.isActive("js-use-local-coedit-service");this.Ux=Q.isActive("js-use-local-coedit-with-native-client");
this.reconnectSyncEnabled=Q.isActive("js-reconnect-sync-enabled")}};var w={};Object.defineProperty(w,"__esModule",{value:!0});w.L=class{static $a(a,b){return{type:a,preziId:b}}static Oe(a,b,c){return{type:a,preziId:b,errorMessage:c}}static st(a){return w.L.$a(e.CetNetworkEventType.InitialConnectionFailure,a)}static mt(a,b){return w.L.Oe(e.CetNetworkEventType.AccessDeniedError,a,b)}static xt(a,b){return w.L.Oe(e.CetNetworkEventType.MultiUserLockError,a,b)}static Mt(a,b){return w.L.Oe(e.CetNetworkEventType.TransportError,
a,b)}static ot(a){return w.L.$a(e.CetNetworkEventType.ConnectionLost,a)}static Ct(a){return w.L.$a(e.CetNetworkEventType.Reconnected,a)}static rt(a,b,c){return{type:e.CetNetworkEventType.HardResetedPreziIsAvailable,preziId:a,preziXml:b,sessionState:c}}static Gt(a){return w.L.$a(e.CetNetworkEventType.RoomInfoChanged,a)}static gm(a){return w.L.$a(e.CetNetworkEventType.RequestSync,a)}static Et(a){return w.L.$a(e.CetNetworkEventType.RemoteChangesAvailable,a)}static Ht(a){return w.L.$a(e.CetNetworkEventType.RoomKeyValueStoreChanged,
a)}static zt(a){return w.L.$a(e.CetNetworkEventType.PeerKeyValueStoreChanged,a)}static ut(a){return w.L.$a(e.CetNetworkEventType.KeyValueStoresReset,a)}static pt(a){return w.L.$a(e.CetNetworkEventType.Finished,a)}static tt(a){return w.L.Oe(e.CetNetworkEventType.InvalidDocumentStateError,a,"invalid document state")}static em(a,b){return w.L.Oe(e.CetNetworkEventType.IllegalStateError,a,b)}static It(a){return w.L.$a(e.CetNetworkEventType.SessionReady,a)}static yt(a){return w.L.$a(e.CetNetworkEventType.OfflineTimerTriggered,
a)}static Dt(a){return w.L.$a(e.CetNetworkEventType.ReconnectingFromFinished,a)}static Ft(a){return w.L.$a(e.CetNetworkEventType.ResetUndoRedo,a)}};var sb={};Object.defineProperty(sb,"__esModule",{value:!0});sb.Uk=class{constructor(a,b,c,d){this.Gb=a;this.nf=b;this.nw=c;this.qb=d;this.Ch=!0;this.Wj=[];this.yi=[];this.Fl=[];this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.CetSessionImpl");this.ef=p.Bacon.newBus();this.hf=p.Bacon.newBus();this.Rp=p.Bacon.newBus();null!=a&&this.ov();
this.Nj=p.Bacon.newBus()}setIPrezi(a){this.lk(m.DOM.createLocalSessionWithCorrection(a,()=>{}))}setSessionMode(a){this.Gb.xp(a)}getLoaderStream(){return this.ef}loadPrezi(a,b){this.Gb.loadPrezi(a,b)}getIPrezi(){return this.ja.getPrezi()}getPrezi(){return this.ja.getPrezi()}createPrezi(a,b,c,d,f,h){let g=p.Bacon.newBus();a=this.Gb.createPrezi(a,b,c,d,f,h);a.onValue((a)=>{a.result===D.SaveResult.Success?(g.push({success:!0,metadata:a.metadata}),this.lk(a.session),null!=this.jg&&this.jg.push(e.EditKind.Local)):
g.push({success:!1,metadata:a.metadata})});a.onError((a)=>{g.error(a)});return g}ov(){this.Gb.getLoaderStream().onValue((a)=>{switch(a.type){case H.PreziLoaderEventType.PdomSessionCreated:this.lk(a.payload);break;default:this.ef.push(a)}});this.Gb.getLoaderStream().onError((a)=>{this.ef.error(a)});this.Gb.getNetworkEventStream().onValue((a)=>{a.type===e.CetNetworkEventType.RemoteChangesAvailable&&(this.ep=!0);this.Ch||this.Wj.push(a)});this.hf.plug(this.Gb.getNetworkEventStream().filter((a)=>a.type!==
e.CetNetworkEventType.RemoteChangesAvailable||this.Ch))}getNetworkUserList(){return this.ja.getNetworkUserList().slice()}savePreziTitle(a){return this.Gb.savePreziTitle(a)}savePreziLogoType(a){return this.Gb.savePreziLogoType(a)}getPreziSaver(a,b,c){null==a&&(a=this.fb.getPrezi().getComponent(l.f.De).getCetSessionEditStream());this.jg=p.Bacon.newBus();this.jg.plug(a);return this.nw.create(this,this.jg,b,c)}getPreziLoader(){return this}getMetadataSaver(){return this}getPreziCreator(){return this}getNetworkEventStream(){return this.hf}Vw(a){this.fb=
a;a.getImmediateChangeStream(e.ChangeEventKind.Document).onValue(()=>{this.ef.push({type:H.PreziLoaderEventType.PreziLoaded,payload:this.ja.getPrezi()})})}ox(){this.ef.push({type:H.PreziLoaderEventType.CetSessionCreated})}lk(a){this.ja=a;this.nf.fixPrezi(a.getPrezi());this.sync();this.Nj.push(!0);this.ox()}requestSync(){this.hf.push(w.L.gm(this.ja.getNetworkSessionPreziOid()))}rf(){this.ja.updateAndCommitWithoutHistoryTracking(()=>{this.ja.updatePrezi(f.CetModel.EMPTY_PREZI())});this.sync()}ik(a,
b,c){return this.lt(a,b).then((a)=>{c(a);this.ja.updateAndCommitWithoutHistoryTracking(()=>{this.ja.updatePrezi(this.nf.fixIPrezi(a))});this.sync();return a})}lt(a,b){return new Promise((c)=>{const d=this.qb;if(null==d)c(b);else{const e=()=>{const a=f.CetModel.EMPTY_PREZI();c(a)};try{const f=m.DOM.createLocalSession(b,()=>{});d.convert(f,a).then(()=>{c(f.getPrezi())}).catch(e)}catch(q){e(q)}}})}sync(){var a=this.Jw();try{this.Rp.push(null)}catch(c){t.LoggerModule.logException(this.logger,"CetSessionImpl",
"sync",c)}if(this.Ch){var b=this.ep;this.ep=!1;const c=this.ja.sync();a={wasHardReseted:c.wasHardReseted,wasAcknowledgeRequested:c.wasAcknowledgeRequested,ap:b,Pj:a}}else b=this.ja.syncWithoutPull(),a={wasHardReseted:b.wasHardReseted,wasAcknowledgeRequested:b.wasAcknowledgeRequested,ap:!1,Pj:a};this.Iw();return a}getSyncTriggeredStream(){return this.Rp}Ln(a){t.LoggerModule.logException(this.logger,"CetSessionImpl","invalidDocumentState",a);this.hf.push(w.L.tt(this.ja.getNetworkSessionPreziOid()))}getPeerKeyValueStores(){return this.ja?
this.ja.getPeerKeyValueStores():null}getOwnKeyValueStore(){return null!=this.ja?this.ja.getOwnKeyValueStore():null}forwardRemoteEditingEvents(a){this.Ch=a;this.logger.info({action:"forwardRemoteEditingEvents",object:"CetSessionImpl",trigger:"machine",payload:{flag:a}});a&&(a=this.Wj,this.Wj=[],a.forEach((a)=>this.hf.push(a)))}getIMediaAssets(){return m.DOM.collectMediaAsset(this.getPrezi())}goOnline(){this.ja.goOnline()}Jw(){if(this.ja.hasAnyUncommitedChange())throw Error("cannot run sync hook if there are uncommitted changes");
if(0===this.yi.length)return!1;let a=!1;this.ja.updateAndCommitWithoutHistoryTracking(()=>{for(let a of this.yi)a(this.getPrezi());this.ja.hasAnyUncommitedChange()&&(a=!0)});return a}Iw(){for(let a of this.Fl)a(this.getPrezi())}beforeSync(a){this.yi.push(a)}afterSync(a){this.Fl.push(a)}};var Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});Ac.Bq=class{constructor(a,b,c,d,e,f,h){this.Hb=p.Bacon.newBus();this.ya=p.Bacon.newBus();this.Ca=p.Bacon.newBus();const g=f.createPrezi(a,b,c,d,e).onValue((a)=>
{if(a.result===D.SaveResult.Success){const {Co:b,Bo:c}=h(a.metadata.oid,(b)=>this.Hb.push({result:D.SaveResult.Success,session:b,metadata:a.metadata}),()=>this.Hb.push({result:D.SaveResult.Error,session:null,metadata:a.metadata}));this.ya.plug(b);this.Ca.plug(c)}else null!=this.Hb&&this.Hb.push(a)});this.gd=()=>{this.Hb.end();this.ya.end();this.Ca.end();g()}}Gc(){return this.ya}Fc(){return this.Ca}cancel(){null!=this.gd&&(this.gd(),this.gd=null)}};var tb={};Object.defineProperty(tb,"__esModule",{value:!0});
tb.Wk=class{constructor(a,b,c,d,e,f){this.Hb=p.Bacon.newBus();this.Hb.plug(this.fm(f)(a,b,c,d,e))}fm(a){return a.createPrezi.bind(a)}Gc(){return p.Bacon.never()}Fc(){return p.Bacon.never()}cancel(){null!=this.Hb&&(this.Hb.end(),this.Hb=null)}};var Bc={};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.Cq=class extends tb.Wk{constructor(a,b,c,d,e){super(a,b,c,d,null,e)}fm(a){return a.createPreziInLocalStore.bind(a)}};var ub={},$c=this&&ub.wl||function(a,b,c,d){function e(a){return a instanceof
c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,f){function g(a){try{k(d.next(a))}catch(X){f(X)}}function h(a){try{k(d["throw"](a))}catch(X){f(X)}}function k(a){a.done?c(a.value):e(a.value).then(g,h)}k((d=d.apply(a,b||[])).next())})};Object.defineProperty(ub,"__esModule",{value:!0});ub.ur=class{constructor(a,b,c){this.df=a;this.qb=b;this.Ja=c;this.Xb=new Cc;this.ya=new Cc;this.Ca=new Cc;a.Fc().onValue((a)=>{this.Ca.push(a)});a.Gc().onValue((a)=>{this.ya.push(a)});a.Ud().onValue((a)=>
{a.type===H.PreziLoaderEventType.PdomSessionCreated?this.kt(a.payload):this.Xb.push(a)})}Ud(){return this.Xb.hc}Gc(){return this.ya.hc}Fc(){return this.Ca.hc}cancel(){this.df.cancel()}pause(){this.Xb.pause();this.ya.pause();this.Ca.pause()}vw(){this.Xb.Rj();this.ya.Rj();this.Ca.Rj()}sf(){this.Xb.sf();this.ya.sf();this.Ca.sf()}kt(a){$c(this,void 0,void 0,function*(){this.Xb.push({type:H.PreziLoaderEventType.ConversionStarted});this.pause();this.Xb.push({type:H.PreziLoaderEventType.PdomSessionCreated,
payload:a});try{yield this.qb.convert(a,this.Ja)}catch(c){this.vw();var b=f.CetModel.EMPTY_PREZI();b=m.DOM.createLocalSession(b,()=>{});this.Xb.push({type:H.PreziLoaderEventType.PdomSessionCreated,payload:b});null!=c.type&&null!=c.errorMessage?this.Xb.push({type:H.PreziLoaderEventType.PreziConversionFailedError,payload:c}):this.Xb.push({type:H.PreziLoaderEventType.PreziConversionFailedError,payload:null})}this.sf()})}};class Cc{constructor(){this.hc=p.Bacon.newBus();this.paused=!1;this.ug=[]}pause(){this.paused=
!0}sf(){this.paused=!1;this.ug.forEach((a)=>this.hc.push(a));this.ug=[]}Rj(){this.ug=[]}push(a){this.paused?this.ug.push(a):this.hc.push(a)}}var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.wr=class{constructor(a,b,c){this.wa=p.Bacon.newBus();this.ya=p.Bacon.newBus();this.Ca=p.Bacon.newBus();b=a.loadPreziMetaData(b);this.wa.plug(b);let d=b.filter((a)=>a.type===H.PreziLoaderEventType.MetaDataLoaded).take(1).onValue(()=>{a.getPreziProvider().loadPreziXmlForCoeditInit((a)=>{const {Co:b,
Bo:d}=c(a,(a)=>this.wa.push({type:H.PreziLoaderEventType.PdomSessionCreated,payload:a}),()=>this.wa.push({type:H.PreziLoaderEventType.PdomSessionCreationError}));this.ya.plug(b);this.Ca.plug(d)},()=>{this.wa.push({type:H.PreziLoaderEventType.PdomSessionCreationError})})});this.gd=()=>{this.ya.end();this.Ca.end();this.wa.end();d()}}Ud(){return this.wa}Gc(){return this.ya}Fc(){return this.Ca}cancel(){null!=this.gd&&(this.gd(),this.gd=null)}};var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0});
Ec.xr=class{constructor(a,b){this.wa=p.Bacon.newBus();this.wa.plug(a.loadPrezi(b))}Ud(){return this.wa}Gc(){return p.Bacon.never()}Fc(){return p.Bacon.never()}cancel(){null!=this.wa&&(this.wa.end(),this.wa=null)}};var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.vr=class{constructor(a,b){this.wa=p.Bacon.newBus();a.Ud().onValue((c)=>{c.type===H.PreziLoaderEventType.PdomSessionCreated?(a.cancel(),this.wa.push({type:H.PreziLoaderEventType.PdomSessionCreated,payload:m.DOM.createLocalSessionWithCorrection(c.payload.getPrezi(),
()=>{})}),this.wa.push({type:H.PreziLoaderEventType.FeaturePreviewModeWithSaveDisabled,payload:b})):this.wa.push(c)})}Ud(){return this.wa}Gc(){return p.Bacon.never()}Fc(){return p.Bacon.never()}cancel(){null!=this.wa&&(this.wa.end(),this.wa=null)}};var Z={};Object.defineProperty(Z,"__esModule",{value:!0});var Pc=Q.FeatureSwitcher.getFeaturePreviewFlags,C;(function(a){a[a.bc=0]="CoeditMulti";a[a.Wc=1]="CoeditSingle";a[a.ad=2]="Fallback";a[a.FallbackLocalSave=3]="FallbackLocalSave";a[a.Xc=4]="Disabled"})(C=
Z.Pf||(Z.Pf={}));class Qc{constructor(a){this.at=a}onAcknowledgeResult(a,b,c){this.at(a,b,c)}}Z.cy=Qc;class ad{constructor(a,b,c){this.oid=a;this.Xg=b;this.errorMessage=c}}Z.Cr=ad;class bd{constructor(a,b,c,d,e){this.qb=e;this.Ca=p.Bacon.newBus();this.ya=p.Bacon.newBus();this.Tg=p.Bacon.newBus();this.gb=a;this.eh=b;this.In=c;this.Wl=d;this.xp(ab.CetSessionMode.Initial);this.sv();this.Qt();this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.CoeditPreziLoader")}getLoaderStream(){return this.Tg}getNetworkEventStream(){return this.ya}xp(a){switch(a){case ab.CetSessionMode.Initial:this.Ab=
this.Kc=this.In;break;case ab.CetSessionMode.FallbackReadOnly:this.Kc=C.ad;this.Ab=C.Xc;break;case ab.CetSessionMode.FallbackLocalSave:this.Kc=C.ad,this.Ab=C.FallbackLocalSave}}Qt(){this.Ca.filter((a)=>a.Xg===m.NetworkError.ACCESS_DENIED_NO_EDIT_RIGHTS||a.Xg===m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE).onValue(()=>{this.Ab=C.Xc})}sv(){let a=this.Ca.filter((a)=>this.Kc===C.bc||this.Kc===C.Wc||this.Ab===C.bc||this.Ab===C.Wc||a.Xg===m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE);this.ya.plug(a.map((a)=>
{switch(a.Xg){case m.NetworkError.SESSION_INIT_ERROR:case m.NetworkError.ESR_SESSION_CREATE_FAILED:case m.NetworkError.COEDIT_CONNECT_FAILED:return w.L.st(a.oid);case m.NetworkError.ACCESS_DENIED_NO_EDIT_RIGHTS:return w.L.mt(a.oid,a.errorMessage);case m.NetworkError.ACCESS_DENIED_SINGLE_CLIENT_MODE:return w.L.xt(a.oid,a.errorMessage);default:return w.L.Mt(a.oid,a.errorMessage)}}))}saveSession(a){switch(this.Ab){case C.bc:case C.Wc:let b=p.Bacon.newBus();a.acknowledgeOnNextSync(new Qc((c,d,e)=>{let f;
d=(a,b)=>({action:"acknowledgeOnNextSync",object:"CoeditPreziLoader",trigger:"machine",payload:{acknowledge_result:m.AcknowledgeResult[b],save_result:D.SaveResult[a]}});switch(c){case m.AcknowledgeResult.SUCCESS:case m.AcknowledgeResult.HARD_RESET:case m.AcknowledgeResult.SUCCESS_DIRTY:f={saveResult:D.SaveResult.Success,storageRevision:e};this.logger.info(d(f.saveResult,c));break;case m.AcknowledgeResult.TIMEOUT:f={saveResult:D.SaveResult.Error,storageRevision:null};this.logger.warn(d(f.saveResult,
c));break;case m.AcknowledgeResult.TIMEOUT_NO_SYNC_CALLED:f={saveResult:D.SaveResult.Error,storageRevision:null};this.logger.error(d(f.saveResult,c));break;default:f={saveResult:D.SaveResult.Error,storageRevision:null},this.logger.error(d(f.saveResult,c))}this.saveSessionToLocalStore(a).onValue(()=>{b.push(f)})}));this.ya.push(w.L.gm(a.getNetworkSessionPreziOid()));return b;case C.ad:return this.gb.saveSession(a);case C.FallbackLocalSave:return this.gb.saveSessionToLocalStore(a).map((a)=>({saveResult:a,
storageRevision:null}));case C.Xc:return p.Bacon.once({saveResult:D.SaveResult.Error,storageRevision:null});default:throw Error(`Unexpected LoadAndSaveMode ${this.Ab}`);}}savePreview(a){switch(this.Ab){case C.bc:case C.Wc:case C.ad:return this.gb.savePreview(a);case C.FallbackLocalSave:return this.gb.savePreviewToLocalStore(a);case C.Xc:return p.Bacon.once(D.SaveResult.Error);default:throw Error(`Unexpected LoadAndSaveMode ${this.Ab}`);}}savePreviewToLocalStore(a){return this.gb.savePreviewToLocalStore(a)}saveSessionToLocalStore(a){return this.gb.saveSessionToLocalStore(a)}savePreziTitle(a){a=
this.gb.savePreziTitle(a);this.bp(a);return a.finished}savePreziLogoType(a){a=this.gb.savePreziLogoType(a);this.bp(a);return a.finished}bp(a){this.Tg.push({type:H.PreziLoaderEventType.MetaDataUpdated,payload:a.metadata});a.finished.then((a)=>{this.Tg.push({type:H.PreziLoaderEventType.MetaDataUpdated,payload:a})})}loadPrezi(a,b){null!=this.df&&(this.df.cancel(),this.df=null);switch(this.Kc){case C.bc:case C.Wc:let c=this.Kc===C.bc?m.NetworkSessionMode.MULTI:m.NetworkSessionMode.LOAD_SAVE,d=new Dc.wr(this.gb,
b,(a,d,e)=>this.eh.createNetworkSession(b,a.preziXml,a.locallyStoredSessionState,c,this.Wl,d,e));this.So(this.iq(this.jq(d),a));break;case C.ad:this.So(this.iq(this.jq(new Ec.xr(this.gb,b)),a));break;case C.Xc:this.logger.info({action:"loadDisabled",object:"CoeditPreziLoader",trigger:"machine"});break;default:throw Error(`Unexpected load mode ${C[this.Kc]}`);}}So(a){this.Tg.plug(a.Ud());this.ya.plug(a.Gc());this.Ca.plug(a.Fc());this.df=a}iq(a,b){return null==this.qb?a:new ub.ur(a,this.qb,b)}createPrezi(a,
b,c,d,e,h){null!=this.Ji&&(this.Ji.cancel(),this.Ji=null);const g=p.Bacon.newBus(),k=(a)=>{this.ya.plug(a.Gc());this.Ca.plug(a.Fc());g.plug(a.Hb);this.Ji=a},l=(a)=>{switch(this.Ab){case C.bc:case C.Wc:{let d=this.Kc===C.bc?m.NetworkSessionMode.MULTI:m.NetworkSessionMode.LOAD_SAVE;a=new Ac.Bq(b,c,a,e,h,this.gb,(a,b,c)=>this.eh.createNetworkSession(a,null,null,d,this.Wl,b,c));k(a);break}case C.FallbackLocalSave:a=new Bc.Cq(b,c,a,e,this.gb);k(a);break;case C.ad:a=new tb.Wk(b,c,a,e,h,this.gb);k(a);break;
case C.Xc:g.plug(p.Bacon.later(0,{result:D.SaveResult.Error,session:null,metadata:null}));break;default:throw Error(`Unexpected LoadAndSaveMode ${this.Ab}`);}};if(null!=this.qb){const b=m.DOM.createLocalSession(d,()=>{});d=()=>{var a=f.CetModel.EMPTY_PREZI();a=m.DOM.createLocalSession(a,()=>{});this.Ab=C.Xc;l(a.getPrezi())};try{this.qb.convert(b,a).then(()=>{l(b.getPrezi())}).catch(d)}catch(Ob){d(Ob)}}else l(d);return g}jq(a){return 0<Pc().size?new Fc.vr(a,Pc()):a}}Z.zq=bd;var Za={};Object.defineProperty(Za,
"__esModule",{value:!0});Za.ei=class{constructor(a,b){this.eh=a;this.coeditExternalServiceProviders=b;this.logger=t.LoggerModule.getLoggerManager().createLogger("prezi_cet.PdomNetworkSessionFactory")}createNetworkSession(a,b,c,d,e,f,h){let g=!1,k=null;const l=p.Bacon.newBus(),q=p.Bacon.newBus();let n=(b,c)=>{try{return c()}catch(Wc){return b="Caught exception while tranforming PDOM event ("+m.NetworkEvent[b]+") to Cet event!\n"+x.Utils.stringify(Wc),this.logger.error({action:"networkEvent",object:"coeditpreziloader",
trigger:"machine",payload:{message:b}}),w.L.em(a,b)}};this.eh({offlineTimerInSeconds:e.offlineTimerInSeconds,keepReconnectingAfterOfflineTimerTriggered:e.keepReconnectingAfterOfflineTimerTriggered,networkSessionMode:d,locallySavedXml:b,locallySavedSessionState:c,oid:a,coeditExternalServiceProviders:this.coeditExternalServiceProviders,acknowledgeTimeout:Za.ei.Br,reconnectSyncEnabled:e.reconnectSyncEnabled,onNetworkEventCallback:(b)=>{switch(b){case m.NetworkEvent.CONNECTION_LOST:b=w.L.ot(a);break;
case m.NetworkEvent.RECONNECTED:b=w.L.Ct(a);break;case m.NetworkEvent.HARD_RESETED_PREZI_IS_AVAILABLE:b=n(b,()=>{const b=k.popHardResetedPreziInfo();return w.L.rt(a,m.DOM.saveXml(b.prezi),b.sessionState)});break;case m.NetworkEvent.ROOM_INFO_CHANGED:b=w.L.Gt(a);break;case m.NetworkEvent.REMOTE_CHANGES_AVAILABLE:b=w.L.Et(a);break;case m.NetworkEvent.ROOM_KEY_VALUE_STORE_CHANGED:b=w.L.Ht(a);break;case m.NetworkEvent.PEER_KEY_VALUE_STORE_CHANGED:b=w.L.zt(a);break;case m.NetworkEvent.KEY_VALUE_STORES_RESET:b=
w.L.ut(a);break;case m.NetworkEvent.ACKNOWLEDGE_HARD_RESET:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_SUCCESS:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_SUCCESS_DIRTY:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_TIMEOUT:b=null;break;case m.NetworkEvent.ACKNOWLEDGE_TIMEOUT_NO_SYNC_CALLED:b=null;break;case m.NetworkEvent.FINISHED:b=w.L.pt(a);break;case m.NetworkEvent.OFFLINE_TIMER_TRIGGERED:b=w.L.yt(a);break;case m.NetworkEvent.RECONNECTING_FROM_FINISHED:b=w.L.Dt(a);break;case m.NetworkEvent.RESET_UNDO_REDO:b=
w.L.Ft(a);break;default:b="unkown network event"+m.NetworkEvent[b],this.logger.error({action:"networkEvent",object:"coeditpreziloader",trigger:"machine",payload:{message:b}}),b=w.L.em(a,b)}null!=b&&l.push(b)},onNetworkErrorCallback:(b,c)=>{g||h();q.push(new Z.Cr(a,b,c))},onEventCallback:(()=>()=>{})(),onSessionReadyCallback:(b)=>{g=!0;k=b;try{f(b),l.push(w.L.It(a))}catch(Mc){throw window.console.error("Error in createNetworkSession's success handler:",Mc),Mc;}}});return{Co:l,Bo:q}}};Za.ei.Br=2;var vb=
{};Object.defineProperty(vb,"__esModule",{value:!0});vb.ql=class{constructor(a,b){this.rules={};this.state=a;this.Hj=b}v(a,b,c){null==this.rules[+a]&&(this.rules[+a]={});this.rules[+a][+b]=c;return this}step(a){let b=this.state;this.state=this.rules[+this.state][+a];this.state!==b&&this.Hj(this.state)}getState(){return this.state}};var Ha={};Object.defineProperty(Ha,"__esModule",{value:!0});var Gc;(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote"})(Gc=Ha.hi||(Ha.hi={}));class cd{constructor(a,
b,c,d){this.Uo=a;this.hh=b;this.pa=c;this.Bg=d;this.logger=t.LoggerModule.getLoggerManager().createLogger("SaverBase")}rp(a,b){const c=()=>({saveResult:D.SaveResult.Error,storageRevision:null});try{const d=this.saveXml(a);d.onValue((d)=>{if(d.saveResult!==D.SaveResult.Success)this.logSaveError("save error"),b(d);else{const e=this.savePreview(a);e.onValue((a)=>{a!==D.SaveResult.Success?b(c()):b(d)});e.onError((a)=>{this.logSaveError(a);b(c())})}});d.onError((a)=>{this.logSaveError(a);b(c())})}catch(d){this.logSaveError(d),
b(c())}}saveXml(a){null!=this.Bg&&this.Bg.forceCommitEvenIfBreaksUndoHistoryAndSceneConsistency();a=a===Gc.Local?this.hh.saveSessionToLocalStore(this.pa.ja).map((a)=>({saveResult:a,storageRevision:null})):this.hh.saveSession(this.pa.ja);null!=this.Bg&&this.Bg.updateEditSceneEvenIfNotActive();return a}savePreview(a){return null==this.Uo?p.Bacon.once(D.SaveResult.Success):p.Bacon.fromPromise(this.Uo.generatePreviewData()).flatMap(a===Gc.Local?(a)=>this.hh.savePreviewToLocalStore(a):(a)=>this.hh.savePreview(a)).mapError((a)=>
{this.ro(a);return D.SaveResult.Success}).map((a)=>{a!==D.SaveResult.Success&&this.ro(a);return D.SaveResult.Success})}logSaveError(a){this.logger.error({action:"save_error",object:"save_watchdog",trigger:"machine",payload:{message:a}})}ro(a){this.logger.warn({action:"preview_save_error",object:"save_watchdog",trigger:"machine",payload:{message:a}})}}Ha.js=cd;var na={};Object.defineProperty(na,"__esModule",{value:!0});var n;(function(a){a[a.la=0]="Saved";a[a.Ga=1]="DirtyLocal";a[a.Wa=2]="DirtyRemote";
a[a.ec=3]="SavingLocal";a[a.fc=4]="SavingRemote";a[a.Ba=5]="Terminated"})(n=na.bs||(na.bs={}));var E;(function(a){a[a.Ya=0]="NoError";a[a.Error=1]="Error"})(E=na.Zr||(na.Zr={}));var u;(function(a){a[a.Nb=0]="StartSave";a[a.Mb=1]="LocalEdit";a[a.cc=2]="RemoteEdit";a[a.la=3]="Saved";a[a.dc=4]="SaveError";a[a.gc=5]="Terminate"})(u=na.$r||(na.$r={}));class wb{constructor(a,b){this.Qp=a;this.pp=(new vb.ql(n.la,(a)=>this.tw(a))).v(n.la,u.Nb,n.la).v(n.la,u.Mb,n.Ga).v(n.la,u.cc,n.Wa).v(n.la,u.la,n.la).v(n.la,
u.dc,n.la).v(n.la,u.gc,n.Ba).v(n.ec,u.Nb,n.ec).v(n.ec,u.Mb,n.Ga).v(n.ec,u.cc,n.Wa).v(n.ec,u.la,n.la).v(n.ec,u.dc,n.Wa).v(n.ec,u.gc,n.Ba).v(n.fc,u.Nb,n.fc).v(n.fc,u.Mb,n.Ga).v(n.fc,u.cc,n.Wa).v(n.fc,u.la,n.la).v(n.fc,u.dc,n.Ga).v(n.fc,u.gc,n.Ba).v(n.Ga,u.Nb,n.fc).v(n.Ga,u.Mb,n.Ga).v(n.Ga,u.cc,n.Ga).v(n.Ga,u.la,n.Ga).v(n.Ga,u.dc,n.Ga).v(n.Ga,u.gc,n.Ba).v(n.Wa,u.Nb,n.ec).v(n.Wa,u.Mb,n.Ga).v(n.Wa,u.cc,n.Wa).v(n.Wa,u.la,n.Wa).v(n.Wa,u.dc,n.Wa).v(n.Wa,u.gc,n.Ba).v(n.Ba,u.Nb,n.Ba).v(n.Ba,u.Mb,n.Ba).v(n.Ba,
u.cc,n.Ba).v(n.Ba,u.la,n.Ba).v(n.Ba,u.dc,n.Ba).v(n.Ba,u.gc,n.Ba);this.Mw=(new vb.ql(E.Ya,(a)=>this.sw(a))).v(E.Ya,u.Nb,E.Ya).v(E.Ya,u.Mb,E.Ya).v(E.Ya,u.cc,E.Ya).v(E.Ya,u.la,E.Ya).v(E.Ya,u.dc,E.Error).v(E.Ya,u.gc,E.Ya).v(E.Error,u.Nb,E.Error).v(E.Error,u.Mb,E.Error).v(E.Error,u.cc,E.Error).v(E.Error,u.la,E.Ya).v(E.Error,u.dc,E.Error).v(E.Error,u.gc,E.Error);this.ne=p.Bacon.newBus();this.op=p.Bacon.newBus();this.ck=p.Bacon.newBus();this.Nw=this.ck.map((a)=>a.saveResult);this.Ow=p.Bacon.combineWith((a,
b)=>b===E.Error&&a!==D.SaveState.saving?D.SaveState.errorSaving:a,this.ne.toProperty(D.SaveState.saved),this.op.toProperty(E.Ya)).skipDuplicates();b.onValue((a)=>this.rw(a))}step(a){this.Mw.step(a);this.pp.step(a)}save(){if(this.pp.getState()===n.la)return p.Bacon.once(D.SaveResult.Success);{const a=this.Nw.take(1);this.step(u.Nb);return a}}forceSaveAndGetStorageProperties(){const a=this.ck.take(1);this.step(u.Mb);this.step(u.Nb);return a}getSaveStateStream(){return this.Ow}rw(a){switch(a){case e.EditKind.Local:this.step(u.Mb);
break;case e.EditKind.Remote:this.step(u.cc);break;default:throw Error("unkown EditKind "+a);}}sw(a){this.op.push(a)}tw(a){switch(a){case n.ec:this.ne.push(D.SaveState.saving);this.Qp.rp(Ha.hi.Local,(a)=>this.Yo(a));break;case n.fc:this.ne.push(D.SaveState.saving);this.Qp.rp(Ha.hi.Remote,(a)=>this.Yo(a));break;case n.la:this.ne.push(D.SaveState.saved);break;case n.Ga:case n.Wa:this.ne.push(D.SaveState.dirty);break;case n.Ba:this.ne.push(D.SaveState.errorExternalEdit)}}Yo(a){const b=a.saveResult;switch(b){case D.SaveResult.Success:this.step(u.la);
break;case D.SaveResult.Error:this.step(u.dc);p.Bacon.later(wb.mq,!0).onValue(()=>{this.save()});break;case D.SaveResult.ErrorExternalEdit:this.step(u.gc);break;default:throw Error("unknown saveResult: "+b);}this.ck.push(a)}}na.cs=wb;wb.ky=1E4;wb.mq=1E4;var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.Tk=class{constructor(a){this.Gb=a}create(a,b,c,d){return new na.cs(new Ha.js(c,this.Gb,a,d),b)}};var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0});Hc.wq=class{constructor(a,b,
c){this.nf=a;this.qb=b;this.fs=c}createCetSession(a,b,c){a=H.DataServiceModule.createPreziLoader(a,b);b=c.coeditExternalServiceProviders?c.coeditExternalServiceProviders:this.Du();c.reconnectSyncEnabled=this.fs.reconnectSyncEnabled;b=new Za.ei((a)=>{m.DOM.createNetworkSession(a)},b);c=new Z.zq(a,b,this.Ku(),c,this.qb);return new sb.Uk(c,this.nf,new xb.Tk(c),this.qb)}Du(){if(this.fs.Ux)return m.DOM.getLocalNativeCoeditExternalServiceProviders(18888,!1);if(this.fs.Tx){let a=x.Utils.createUrlUtils().parseQueryString(window.location.search);
return m.DOM.getLocalTestCoeditExternalServiceProviders(Number(a.esrPort)||18E3,Number(a.coeditPort)||8888)}return this.fs.Vx?m.DOM.getPreProdCoeditExternalServiceProviders():m.DOM.getProductionCoeditExternalServiceProviders()}Ku(){return this.fs.ft?Z.Pf.bc:this.fs.gt?Z.Pf.Wc:Z.Pf.ad}createCetSessionWithIPrezi(a){const b=this.createHeadlessCetSession();b.setIPrezi(a);return b}createHeadlessCetSession(){return new sb.Uk(null,this.nf,new xb.Tk(null),this.qb)}};var Ic={};Object.defineProperty(Ic,"__esModule",
{value:!0});Ic.yq=class{constructor(a,b){this.u=a({initialBehaviour:this.gq(b.startedInOffline,b.isPresenting)});this.Lv=this.wt(this.u);this.u.info("started")}tell(){return this.Lv}get currentBehaviourName(){return this.u.same().name}gq(a,b){return{name:"waitForActions",handler:(c)=>{switch(c.kind){case "ActionsWired":if(a)return this.u.info("wired-started-offline"),this.Gh({actions:c.actions,rb:!1,isPresenting:b,Ta:!1});this.u.info("wired-started-online");c.actions.setSwitchingUiStateToNoSyncInProgress();
return this.Lb({actions:c.actions,rb:!0,coeditFinishedAndWaitingForGoOnline:!1,Yg:!1,Fa:null,isPresenting:b,Ta:!1});case "EditorModeChanged":return this.gq(a,c.isPresenting);default:return this.ib(c.kind)}}}}Gh(a){return{name:"startedOffline",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.ib(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.u.info(b.kind,{wb:b.wb});if(!a.rb&&b.wb){if(a.isPresenting)return this.Gh(Object.assign(Object.assign({},a),{Ta:!0}));this.u.info("reloading");
a.actions.reloadEditor();return this.u.stopped()}return this.u.same();case "CoeditInitialConnectionFailure":return this.ib(b.kind);case "CoeditFinishedAndWaitingForGoOnline":return this.ib(b.kind);case "CoeditReconnected":return this.ib(b.kind);case "MediaAssetSyncSuccess":return this.ib(b.kind);case "MediaAssetSyncNonRetryableFailure":return this.ib(b.kind);case "MediaAssetSyncRetryableFailure":return this.ib(b.kind);case "CetSyncFinished":return this.u.same();case "ConnectionLost":return this.u.same();
case "EditorModeChanged":return a.Ta&&!b.isPresenting?(this.u.info("reloading"),a.actions.reloadEditor(),this.u.stopped()):this.Gh(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}Lb(a){return{name:"startedOnline",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.ib(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.u.info(b.kind,{wb:b.wb});const c=a.coeditFinishedAndWaitingForGoOnline&&!a.rb&&b.wb;this.u.info("sync-decision-inputs",
{coeditFinishedAndWaitingForGoOnline:a.coeditFinishedAndWaitingForGoOnline,currentDesktopOnline:a.rb,newDesktopOnline:b.wb,startSync:c});return c?(this.u.info("start-sync-desktop-is-back-online"),this.Mp(a)):this.Lb(Object.assign(Object.assign({},a),{rb:b.wb}));case "CoeditInitialConnectionFailure":return this.u.info(b.kind),this.Gh({actions:a.actions,rb:a.rb,isPresenting:a.isPresenting,Ta:!1});case "CoeditFinishedAndWaitingForGoOnline":return this.u.info(b.kind),a.rb?(this.u.info("start-sync-desktop-is-still-online"),
this.Mp(a)):this.Lb(Object.assign(Object.assign({},a),{coeditFinishedAndWaitingForGoOnline:!0}));case "CoeditReconnected":return this.u.info(b.kind),a.actions.setSwitchingUiStateToNoSyncInProgress(),this.Lb(Object.assign(Object.assign({},a),{Fa:null}));case "MediaAssetSyncSuccess":return this.u.info(b.kind,{onlineAssetUrl:b.kb}),a.actions.addMediaAssetPatch(this.Ii(b.kb,b.cg.onlineAssetId,b.cg.onlineAssetUrl)),this.u.same();case "MediaAssetSyncNonRetryableFailure":return this.u.warn(b.kind,{onlineAssetUrl:b.kb,
errorMessage:b.errorMessage}),this.En(b.kb,a.actions),this.u.same();case "MediaAssetSyncRetryableFailure":return this.u.warn(b.kind,{onlineAssetUrl:b.kb,errorMessage:b.errorMessage}),this.u.same();case "CetSyncFinished":return a.coeditFinishedAndWaitingForGoOnline?((b=this.cj(a.actions.getIMediaAssets()))?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress(),this.Lb(Object.assign(Object.assign({},a),{Yg:b}))):this.u.same();case "ConnectionLost":return this.Lb(Object.assign(Object.assign({},
a),{Fa:a.Fa||Date.now()}));case "EditorModeChanged":return a.Ta&&!b.isPresenting?(this.u.info("reloading"),a.actions.reloadEditor(),this.u.stopped()):this.Lb(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}yf(a){return{name:"syncingOfflineMedia",handler:(b)=>{switch(b.kind){case "ActionsWired":return this.ib(b.kind);case "DesktopNetworkOnlineStatusUpdate":this.u.info(b.kind,{wb:b.wb});if(b.wb)return this.u.same();var c=this.cj(a.actions.getIMediaAssets());
c?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress();a.actions.disableOnlineMediaInsert();return this.Lb({actions:a.actions,coeditFinishedAndWaitingForGoOnline:!0,rb:b.wb,Yg:c,Fa:a.Fa,isPresenting:a.isPresenting,Ta:a.Ta});case "CoeditInitialConnectionFailure":return this.ib(b.kind);case "CoeditFinishedAndWaitingForGoOnline":return this.ib(b.kind);case "CoeditReconnected":return this.ib(b.kind);case "MediaAssetSyncSuccess":this.u.info(b.kind,{onlineAssetUrl:b.kb});
a.actions.addMediaAssetPatch(this.Ii(b.kb,b.cg.onlineAssetId,b.cg.onlineAssetUrl));if(b=this.Yi(a.de))return this.u.info("sync-next-media",{onlineAssetUrl:b.getOnlineAssetUrl()}),a.actions.syncMediaAsset(this.ej(b)),this.yf(Object.assign(Object.assign({},a),{de:this.zh(a.de,b.getOnlineAssetUrl(),"RequestedSync")}));this.u.info("no-media-left");return this.u.same();case "MediaAssetSyncNonRetryableFailure":this.u.warn(b.kind,{onlineAssetUrl:b.kb,errorMessage:b.errorMessage});this.En(b.kb,a.actions);
b=this.zh(a.de,b.kb,"Failed");if(c=this.Yi(b))return this.u.info("sync-next-media",{onlineAssetUrl:c.getOnlineAssetUrl()}),a.actions.syncMediaAsset(this.ej(c)),this.pk(this.zh(b,c.getOnlineAssetUrl(),"RequestedSync"),a);this.u.info("no-media-left");return this.pk(b,a);case "MediaAssetSyncRetryableFailure":return this.u.warn(b.kind,{onlineAssetUrl:b.kb,errorMessage:b.errorMessage}),(b=this.cj(a.actions.getIMediaAssets()))?a.actions.setSwitchingUiStateToOfflineMediaInserted():a.actions.setSwitchingUiStateToNoSyncInProgress(),
a.actions.disableOnlineMediaInsert(),this.Lb({actions:a.actions,coeditFinishedAndWaitingForGoOnline:!0,rb:!0,Yg:b,Fa:a.Fa,isPresenting:a.isPresenting,Ta:a.Ta});case "CetSyncFinished":return b=this.Kv(a.de,a.actions.getIMediaAssets()),this.pk(b,a);case "ConnectionLost":return this.yf(Object.assign(Object.assign({},a),{Fa:a.Fa||Date.now()}));case "EditorModeChanged":return this.yf(Object.assign(Object.assign({},a),{isPresenting:b.isPresenting}));default:return x.Utils.assertNever(b)}}}}Mp(a){const {Pv:b,
Ov:c}=this.it(a.actions.getIMediaAssets());a.actions.enableOnlineMediaInsert();if(0===c){this.u.info("no-sync-go-online");var d=this.xn(a);return this.Lb(Object.assign(Object.assign({},a),{coeditFinishedAndWaitingForGoOnline:!1,rb:!0,Ta:d}))}d=this.Yi(b);if(!d)return this.Hm("Expected a next mediaAsset to sync!");this.u.info("start-syncing",{onlineAssetUrl:d.getOnlineAssetUrl()});a.actions.setSwitchingUiStateToSyncing(c,0);a.actions.syncMediaAsset(this.ej(d));return this.yf({actions:a.actions,de:this.zh(b,
d.getOnlineAssetUrl(),"RequestedSync"),Fa:a.Fa,isPresenting:a.isPresenting,Ta:a.Ta})}qj(a){return a.getMaybePDOMId()&&a.getOnlineAssetUrl()&&0===a.getOnlineAssetUrl().indexOf("//prezi-local/")}cj(a){return a.find(this.qj)&&!0}Mu(a){return Object.keys(a).reduce((b,c)=>{c=a[c];switch(c.yd){case "Deleted":return Object.assign(Object.assign({},b),{Za:b.Za+1,Tb:b.Tb+1});case "Failed":return Object.assign(Object.assign({},b),{Za:b.Za+1,Tb:b.Tb+1,vg:b.vg+1});case "Offline":return Object.assign(Object.assign({},
b),{Za:b.Za+1});case "Online":return Object.assign(Object.assign({},b),{Za:b.Za+1,Tb:b.Tb+1});case "RequestedSync":return Object.assign(Object.assign({},b),{Za:b.Za+1});default:x.Utils.assertNever(c.yd,"Invalid sync status")}},{Za:0,Tb:0,vg:0})}pk(a,b){const c=this.Mu(a);this.u.info("switching-ui-by-counts",{all:c.Za,done:c.Tb,mu:c.vg});if(c.Za===c.Tb)return this.u.info("all-done",{all:c.Za,done:c.Tb,mu:c.vg}),a=this.xn(b),b.actions.setSwitchingUiStateToNoSyncInProgress(),this.Lb({actions:b.actions,
coeditFinishedAndWaitingForGoOnline:!1,rb:!0,Yg:!1,Fa:b.Fa,isPresenting:b.isPresenting,Ta:a});b.actions.setSwitchingUiStateToSyncing(c.Za,c.Tb);return this.yf({actions:b.actions,de:a,Fa:b.Fa,isPresenting:b.isPresenting,Ta:b.Ta})}Yi(a){const b=Object.keys(a).find((b)=>"Offline"===a[b].yd);return b?a[b].mediaAsset:null}it(a){a=a.filter(this.qj).reduce((a,b)=>{a[b.getMaybePDOMId()]={yd:"Offline",mediaAsset:b};return a},{});const b=this.px(a);return{Pv:a,Ov:b}}Kv(a,b){const c=new Set(Object.keys(a));
b=b.filter((a)=>a.getMaybePDOMId());const d=new Set(b.map((a)=>a.getMaybePDOMId()));x.Utils.Lambda().filter(c,(a)=>!d.has(a)).map((b)=>a[b].yd="Deleted");b.map((b)=>{const c=a[b.getMaybePDOMId()],d=this.qj(b);c&&!d?c.yd="Online":!c&&d&&(a[b.getMaybePDOMId()]={yd:"Offline",mediaAsset:b})});return a}zh(a,b,c){return Object.keys(a).reduce((a,e)=>{e=a[e];e.mediaAsset.getOnlineAssetUrl()===b&&(e.yd=c);return a},a)}px(a){return Object.keys(a).length}ib(a){return this.Hm(`Received "${a}" message in "${this.u.same().name}" behaviour.`)}ej(a){return{onlineAssetId:a.getOnlineAssetId(),
onlineAssetUrl:a.getOnlineAssetUrl()}}xn(a){const b=Date.now()-a.Fa;if(a.Fa&&54E4<b){if(a.isPresenting)return!0;this.u.info("long-offline-reload");a.actions.reloadEditor();return!1}this.u.info("clean-coedit-go-online");a.actions.coeditGoOnline();return!1}Hm(a){this.u.error("fail-with-message",{Ay:a});return this.u.stopped()}wt(a){return{actionsWired(b){a.tell({kind:"ActionsWired",actions:b})},desktopNetworkOnlineStatusUpdate(b){a.tell({kind:"DesktopNetworkOnlineStatusUpdate",wb:b})},coeditInitialConnectionFailure(){a.tell({kind:"CoeditInitialConnectionFailure"})},
coeditFinishedAndWaitingForGoOnline(){a.tell({kind:"CoeditFinishedAndWaitingForGoOnline"})},coeditReconnected(){a.tell({kind:"CoeditReconnected"})},mediaAssetSyncSuccess(b,c){a.tell({kind:"MediaAssetSyncSuccess",kb:b,cg:c})},mediaAssetSyncNonRetryableFailure(b,c){a.tell({kind:"MediaAssetSyncNonRetryableFailure",kb:b,errorMessage:c})},mediaAssetSyncRetryableFailure(b,c){a.tell({kind:"MediaAssetSyncRetryableFailure",kb:b,errorMessage:c})},cetSyncFinished(b){a.tell({kind:"CetSyncFinished",yy:b})},connectionLost(){a.tell({kind:"ConnectionLost"})},
editorModeChanged(b){a.tell({kind:"EditorModeChanged",isPresenting:b})}}}Ii(a,b,c){return{oldOnlineAssetUrl:a,newOnlineAssetId:b,newOnlineAssetUrl:c}}En(a,b){b.addMediaAssetPatch(this.Ii(a,null,`${a}_unknown_asset_failure`))}};var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.cr=class{constructor(a,b,c){this.Fs=a;this.zl=c;this.Es=b}update(a){this.Fs(a)}getName(){return this.Es}init(){}reset(a){null!=this.zl&&this.zl(a)}changesPdomComponents(){return!1}};var oa={};Object.defineProperty(oa,
"__esModule",{value:!0});oa.Hf=class{constructor(){}fetch(){return p.Bacon.never()}};oa.Rk=class{constructor(){}createBinaryFetcher(){return new oa.Hf}createJSONFetcher(){return new oa.Hf}createImageFetcher(){return new oa.Hf}createFontSetFetcher(){return new oa.Hf}getAssetFetchingErrorObservable(){return p.Bacon.never()}getUrlRewriter(){return{rewriteVideoUrl(a){return a},rewriteUrl(a){return a}}}addImageDownloadTask(){return p.Bacon.never()}setUrgentIdLister(){}downloadInitialBatch(){}};var Oa=
{Fy:function(a){let b={};for(let c in a)b[c]="function"===typeof a[c]?function(){}:null;return b}};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.Jf=class{constructor(){}static createCetApplication(a,b){null==b&&(b=new oa.Rk);a=k.i.createCetApplication({headless:!1,speedMeasurementOptions:{measureSpeed:!1},rendererKind:h.RendererKind.Mock,isDesktop:!1},a,b,{updateList:[]});a.getBaseScene().update();return a}static Kt(a){let b=new mb.rl(null,null,null,null),c=a.createComponentFactory();return a.getSceneHierarchy().createChildScene(a.getBaseScene(),
"CetTestScene",{updateList:[b.createBoundCalculationSystem(),b.createWorldGeometrySystem(),Oa.Jf.visibility(c),b.createQuadTreeSystem(a.getMainStage().getRenderer().getQuadTreeUpdater())]})}static visibility(){return new Jc.cr((a)=>{a.getEntityList().forEachMutable((a)=>{k.i.hasZOrder(a)&&null==k.i.visibility(a,!0)&&k.i.setVisibility(a,!0,1)})},"CetHelperVisibilitySystem")}app(){return this.Ja}build(a){this.nt(k.i.cetSessionFactoryInternal(null).createCetSessionWithIPrezi(null!=this.Ob?m.DOM.loadXml(this.Ob):
f.CetModel.EMPTY_PREZI()),null==this.xl?new oa.Rk:this.xl,a);null!=a&&this.Ja.getCetUI().resize(a);return this}xml(a){this.Ob=a;return this}withStrategy(a){switch(a){case 0:this.Ob=m.DOM.saveXml(f.CetModel.EMPTY_PREZI());break;case 1:this.Ob='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2"><xFields>  <xField name="topicType">\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>  </xField></xFields><aspectRatio>  <aspectRatio value="16:9"/></aspectRatio><overview>  <overview>\t<xFields>\t  <xField name="usesChapters">\t\t<xBool value="true"/>\t  </xField>\t</xFields>\t<minimumScale>\t  <transform2D x="0" y="0" scale="2000" rotation="0"/>\t</minimumScale>\t<smartStructure>\t  <xConstructor name="chainSmartStructure" type="smartStructure">\t\t<xField name="chainLinks">\t\t  <xArray>\t\t\t<xRef value="2A0E77648806349B576D024EB4E19981"/>\t\t\t<xRef value="D0751634BAA946C09638E927774F1E12"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="children">\t\t  <xArray>\t\t\t<xRef value="r2d2"/>\t\t\t<xRef value="shmi"/>\t\t\t<xRef value="leia"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="id">\t\t  <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\t\t</xField>\t  </xConstructor>\t</smartStructure>  </overview></overview><path>  <array>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="r2d2"/>\t  </target>\t</flyToObject>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="shmi"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <sound>\t\t<sound>\t\t  <assetSourceFilename>\t\t\t<string value="hello.mp3"/>\t\t  </assetSourceFilename>\t\t  <mediaLength>\t\t\t<int value="10000"/>\t\t  </mediaLength>\t\t  <onlineAssetId>\t\t\t<string value="sound_1_online_id"/>\t\t  </onlineAssetId>\t\t  <onlineAssetUrl>\t\t\t<string value="http://example.com/sample.mp3"/>\t\t  </onlineAssetUrl>\t\t</sound>\t  </sound>\t  <target>\t\t<ref value="anakin"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <target>\t\t<ref value="luke"/>\t  </target>\t</flyToObject>\t<flyToObject>\t  <target>\t\t<ref value="ben"/>\t  </target>\t</flyToObject>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="leia"/>\t  </target>\t</flyToObject>\t<flyToOverview/>  </array></path><templateInfo>  <templateInfo>\t<baseId>\t  <string value="marketing_strategy_-_flow"/>\t</baseId>\t<themeId>\t  <string value="marketing_strategy_-_flow_default"/>\t</themeId>  </templateInfo></templateInfo><zObjects>  <array>\t<zLine>\t  <connectorHead>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="shmi"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorHead>\t  <connectorTail>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="r2d2"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorTail>\t  <id>\t\t<string value="2A0E77648806349B576D024EB4E19981"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="2700" y="0" scale="139.0430292598968" rotation="0"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="4.9456327985739685"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="chainLink"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<zLine>\t  <connectorHead>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="leia"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorHead>\t  <connectorTail>\t\t<connectorEnd>\t\t  <target>\t\t\t<ref value="shmi"/>\t\t  </target>\t\t</connectorEnd>\t  </connectorTail>\t  <id>\t\t<string value="D0751634BAA946C09638E927774F1E12"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8100" y="0" scale="139.0430292598968" rotation="0"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="4.945632798573976"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="chainLink"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="r2d2"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="0" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="573638EFAADD4695D9BA08BF1E703D96"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="F06AF3081FD109B9AE1F927BDAD451C6"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="573638EFAADD4695D9BA08BF1E703D96"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="05EC3723EE44BB3FC935532A7A6B8A79"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="05EC3723EE44BB3FC935532A7A6B8A79"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="0" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="573638EFAADD4695D9BA08BF1E703D96"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="1951.6316803076086" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="shmi"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="5400" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="399B9AB737A32E7050E1369C88386E64"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="anakin"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="6A515996BF6FA2315E5971FE8C221829"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="399B9AB737A32E7050E1369C88386E64"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="37847690C395F3B0849DBF5E944EF3C6"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="anakin"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="37847690C395F3B0849DBF5E944EF3C6"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="5400" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="399B9AB737A32E7050E1369C88386E64"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="7351.631680307609" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="leia"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="10800" y="0" scale="400" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="49397B61B809EE9C8EC9072661315412"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="123BCB9E3375CF7E5005E2350E4F1E08"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="123BCB9E3375CF7E5005E2350E4F1E08"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="10800" y="0" scale="6" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="1B7E4AA35EAEA474D4D13F163FEBE428"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="12751.631680307608" y="-2.5985065218541377e-14" scale="6" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="anakin"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="7776" y="-5.115907697472721e-13" scale="108.1547985616654" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="luke"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="542E908474EC23EF459173C77AB901E9"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="448DDACC611014ABE7154912D0908AE2"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="luke"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="448DDACC611014ABE7154912D0908AE2"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="7776" y="-5.115907697472721e-13" scale="1.622321978424981" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="AF1C4C53B582EDD999FEC5577D2D4F36"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8303.695828125585" y="-5.186167934830798e-13" scale="1.622321978424981" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="luke"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="8418.439503456293" y="-6.536993168992922e-13" scale="29.24365112978603" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="1B87E7F6B3B214F9350354648CAFF224"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray>\t\t\t\t  <xRef value="ben"/>\t\t\t\t</xArray>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="946898C0180D667E2B1F702AC993B25F"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="1B87E7F6B3B214F9350354648CAFF224"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="E4AC6DB1D8BA0861606CF792B4DBC8B5"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="ben"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="E4AC6DB1D8BA0861606CF792B4DBC8B5"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="8418.439503456293" y="-6.536993168992922e-13" scale="0.43865476694679045" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="1B87E7F6B3B214F9350354648CAFF224"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8561.121593438178" y="-6.555990623538816e-13" scale="0.43865476694679045" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="ben"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame2"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="planetChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="8592.146791167223" y="-6.892264536872972e-13" scale="7.907102992874228" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="smartStructure">\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\t\t\t  <xField name="baseline">\t\t\t\t<xJust>\t\t\t\t  <xRef value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t\t\t\t</xJust>\t\t\t  </xField>\t\t\t  <xField name="children">\t\t\t\t<xArray/>\t\t\t  </xField>\t\t\t  <xField name="id">\t\t\t\t<xString value="23D2AB47F0A1AFAE49829F00F7DCFB36"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="98AAC08B38BEE07DA486EEDA2E6B42C5"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="98AAC08B38BEE07DA486EEDA2E6B42C5"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="8592.146791167223" y="-6.892264536872972e-13" scale="0.11860654489311342" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<zLine>\t  <arcHeight>\t\t<double value="-141.4561065641304"/>\t  </arcHeight>\t  <id>\t\t<string value="3AB8109C3DC4F64A44388084CB6FD8FA"/>\t  </id>\t  <localToWorld>\t\t<transform2D x="8630.726172918094" y="-6.897401201546961e-13" scale="0.11860654489311342" rotation="1.5707963267948966"/>\t  </localToWorld>\t  <startEndDistance>\t\t<double value="606.7071989502306"/>\t  </startEndDistance>\t  <styleClasses>\t\t<array>\t\t  <token value="baseLine"/>\t\t</array>\t  </styleClasses>\t</zLine>  </array></zObjects></prezi>';
break;case 2:this.Ob='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#EB9DD20ED490A788B46332E81E889EB5"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="planet"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="planet"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="planet"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="planetbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray/>\n                </xField>\n                <xField name="id">\n                  <xString value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="-1384.0043765465798" y="0" scale="341.39553657049083" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="planetbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="EB9DD20ED490A788B46332E81E889EB5"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="EB9DD20ED490A788B46332E81E889EB5"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="-1384.0043765465798" y="0" scale="5.1209330485573625" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="planetbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="113.86854015644894" y="0" scale="5.120933048557363" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="675.499814951862"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-194.99999999999997"/>\n        </arcHeight>\n      </zLine>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 3:this.Ob='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#9B8F7C2A1855997607A21BC4EB3607C8"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#049EBD641430A7D62535396D7D7F6A08"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="planet"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="planet"/>\n        </target>\n      </flyToObject>\n      <flyToObject>\n        <target>\n          <ref value="subtopic"/>\n        </target>\n      </flyToObject>\n      <flyToObject>\n        <target>\n          <ref value="grandchild"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="planet"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="planetbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray>\n                    <xRef value="subtopic"/>\n                  </xArray>\n                </xField>\n                <xField name="id">\n                  <xString value="6492728DD4FCB59B523C90728AACDEBF"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="-773.7561269597054" y="0" scale="341.39553657049083" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="planetbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="subtopic"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="9B8F7C2A1855997607A21BC4EB3607C8"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="9B8F7C2A1855997607A21BC4EB3607C8"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="-1384.0043765465798" y="0" scale="5.1209330485573625" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame3"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="planetbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="113.86854015644894" y="0" scale="5.120933048557363" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="675.499814951862"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-194.99999999999997"/>\n        </arcHeight>\n      </zLine>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="subtopic"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray>\n                    <xRef value="grandchild"/>\n                  </xArray>\n                </xField>\n                <xField name="id">\n                  <xString value="D5DDFB9A1F5D5340F02A41483C62E3D5"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="754.1520374691986" y="-3.979039320256561e-13" scale="106.13943881039378" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="grandchild"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="049EBD641430A7D62535396D7D7F6A08"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="049EBD641430A7D62535396D7D7F6A08"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="613.1595123907919" y="-3.979039320256561e-13" scale="1.5920915821559067" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="FA3D3D2F7C9048D910581F846C4AF217baseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="1131.0222406718804" y="-4.0479903262502474e-13" scale="1.5920915821559067" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="606.7071989502306"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-141.4561065641304"/>\n        </arcHeight>\n      </zLine>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="grandchild"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="planetChapter">\n            <xField name="smartStructure">\n              <xConstructor type="smartStructure" name="linearSmartStructure">\n                <xField name="baseline">\n                  <xJust>\n                    <xRef value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n                  </xJust>\n                </xField>\n                <xField name="children">\n                  <xArray/>\n                </xField>\n                <xField name="id">\n                  <xString value="51E2F918E9C72DB260534D3D52E1F54B"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="1243.627778924531" y="-5.400124791776761e-13" scale="28.698724059965873" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="8DF22C8037F8A5D94D5BDB6A3C851DD1"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="1243.627778924531" y="-5.400124791776761e-13" scale="0.4304808608994881" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame2"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <zLine>\n        <id>\n          <string value="4EEA4D2D8756796C21B131B54F9A81BAbaseline"/>\n        </id>\n        <localToWorld>\n          <transform2D x="1383.6511265741199" y="-5.41876824718644e-13" scale="0.4304808608994881" rotation="1.5707963267948966"/>\n        </localToWorld>\n        <startEndDistance>\n          <double value="606.7071989502306"/>\n        </startEndDistance>\n        <arcHeight>\n          <double value="-141.4561065641304"/>\n        </arcHeight>\n      </zLine>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 4:this.Ob='\n<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n  <xFields>\n    <xField name="topicType">\n      <xEnum type="TopicType" value="WrappedInTopicContainer"/>\n    </xField>\n  </xFields>\n  <aspectRatio>\n    <aspectRatio value="16:9"/>\n  </aspectRatio>\n  <documentStyle>\n    <documentStyle>\n      <styleDeclarations>\n        <array>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <alpha>\n                  <double value="0"/>\n                </alpha>\n                <fillType>\n                  <fillType value="solid"/>\n                </fillType>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="*.baseLine"/>\n            </styleSelector>\n          </styleDeclaration>\n          <styleDeclaration>\n            <styleBlock>\n              <styleBlock>\n                <gradEndAlpha>\n                  <double value="0.7"/>\n                </gradEndAlpha>\n                <gradStartAlpha>\n                  <double value="0.5"/>\n                </gradStartAlpha>\n              </styleBlock>\n            </styleBlock>\n            <styleSelector>\n              <simpleSelector value="#EF9DAF6186A36E790CB6729EEF71FC18"/>\n            </styleSelector>\n          </styleDeclaration>\n        </array>\n      </styleDeclarations>\n    </documentStyle>\n  </documentStyle>\n  <overview>\n    <overview>\n      <xFields>\n        <xField name="usesChapters">\n          <xBool value="true"/>\n        </xField>\n      </xFields>\n      <minimumScale>\n        <transform2D x="0" y="0" scale="2000" rotation="0"/>\n      </minimumScale>\n      <smartStructure>\n        <xConstructor name="chainSmartStructure" type="smartStructure">\n          <xField name="children">\n            <xArray>\n              <xRef value="stack"/>\n            </xArray>\n          </xField>\n          <xField name="id">\n            <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n          </xField>\n        </xConstructor>\n      </smartStructure>\n    </overview>\n  </overview>\n  <path>\n    <array>\n      <flyToOverview/>\n      <flyToObject>\n        <target>\n          <ref value="page"/>\n        </target>\n      </flyToObject>\n      <flyToOverview/>\n    </array>\n  </path>\n  <templateInfo>\n    <templateInfo>\n      <baseId>\n        <string value="sphere_linear_-_blue"/>\n      </baseId>\n      <themeId>\n        <string value="sphere_linear_-_blue_default"/>\n      </themeId>\n    </templateInfo>\n  </templateInfo>\n  <zObjects>\n    <array>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="stack"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="stackChapter">\n            <xField name="position">\n              <xConstructor type="position" name="absolute">\n                <xField name="localToWorld">\n                  <xTransform2D x="0" y="0" scale="213.33333333333331" rotation="0"/>\n                </xField>\n              </xConstructor>\n            </xField>\n            <xField name="topicChildren">\n              <xArray>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="content"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="page"/>\n                  </xField>\n                </xRecord>\n                <xRecord type="topicChild">\n                  <xField name="behaviour">\n                    <xConstructor type="topicChildBehaviour" name="visual"/>\n                  </xField>\n                  <xField name="child">\n                    <xRef value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n                  </xField>\n                </xRecord>\n              </xArray>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame1"/>\n          </xArray>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zShape" type="zObject">\n        <xField name="id">\n          <xString value="EF9DAF6186A36E790CB6729EEF71FC18"/>\n        </xField>\n        <xField name="shapeType">\n          <xEnum type="ShapeType" value="oval"/>\n        </xField>\n        <xField name="localToWorld">\n          <xTransform2D x="0" y="0" scale="10.666666666666666" rotation="0"/>\n        </xField>\n        <xField name="styleClasses">\n          <xArray>\n            <xToken value="frame1"/>\n          </xArray>\n        </xField>\n        <xField name="width">\n          <xDouble value="600"/>\n        </xField>\n        <xField name="height">\n          <xDouble value="600"/>\n        </xField>\n      </xConstructor>\n      <xConstructor name="zTopicContainer" type="zObject">\n        <xField name="id">\n          <xString value="page"/>\n        </xField>\n        <xField name="topic">\n          <xConstructor type="topic" name="page">\n            <xField name="children">\n              <xArray/>\n            </xField>\n          </xConstructor>\n        </xField>\n        <xField name="styleClasses">\n          <xArray/>\n        </xField>\n      </xConstructor>\n    </array>\n  </zObjects>\n</prezi>\n';
break;case 5:this.Ob='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n<xFields>\n\t<xField name="topicType">\n\t\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>\n\t</xField>\n</xFields>\n<aspectRatio>\n\t<aspectRatio value="16:9"/>\n</aspectRatio>\n<documentStyle>\n\t<documentStyle>\n\t\t<styleDeclarations>\n\t\t\t<array>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<alpha>\n\t\t\t\t\t\t\t\t<double value="0"/>\n\t\t\t\t\t\t\t</alpha>\n\t\t\t\t\t\t\t<fillType>\n\t\t\t\t\t\t\t\t<fillType value="solid"/>\n\t\t\t\t\t\t\t</fillType>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="*.baseLine"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t\t<styleDeclaration>\n\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t<styleBlock>\n\t\t\t\t\t\t\t<gradEndAlpha>\n\t\t\t\t\t\t\t\t<double value="0.7"/>\n\t\t\t\t\t\t\t</gradEndAlpha>\n\t\t\t\t\t\t\t<gradStartAlpha>\n\t\t\t\t\t\t\t\t<double value="0.5"/>\n\t\t\t\t\t\t\t</gradStartAlpha>\n\t\t\t\t\t\t</styleBlock>\n\t\t\t\t\t</styleBlock>\n\t\t\t\t\t<styleSelector>\n\t\t\t\t\t\t<simpleSelector value="#E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t\t\t</styleSelector>\n\t\t\t\t</styleDeclaration>\n\t\t\t</array>\n\t\t</styleDeclarations>\n\t</documentStyle>\n</documentStyle>\n<overview>\n\t<overview>\n\t\t<xFields>\n\t\t\t<xField name="usesChapters">\n\t\t\t\t<xBool value="true"/>\n\t\t\t</xField>\n\t\t</xFields>\n\t\t<minimumScale>\n\t\t\t<transform2D x="0" y="0" scale="2000" rotation="0"/>\n\t\t</minimumScale>\n\t\t<smartStructure>\n\t\t\t<xConstructor name="chainSmartStructure" type="smartStructure">\n\t\t\t\t<xField name="children">\n\t\t\t\t\t<xArray>\n\t\t\t\t\t\t<xRef value="top_planet"/>\n\t\t\t\t\t</xArray>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="id">\n\t\t\t\t\t<xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n\t\t\t\t</xField>\n\t\t\t</xConstructor>\n\t\t</smartStructure>\n\t</overview>\n</overview>\n<path>\n\t<array>\n\t\t<flyToOverview/>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="top_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page2"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="inner_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack2_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToOverview/>\n\t</array>\n</path>\n<templateInfo>\n\t<templateInfo>\n\t\t<baseId>\n\t\t\t<string value="sphere_linear_-_blue"/>\n\t\t</baseId>\n\t\t<themeId>\n\t\t\t<string value="sphere_linear_-_blue_default"/>\n\t\t</themeId>\n\t</templateInfo>\n</templateInfo>\n<zObjects>\n\t<array>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="top_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xArray>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="82A7DD4D007AFFC7FEEA81EEA242D0F4"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="10544.619194246661" y="0" scale="711.1111111111111" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="A4618369B7F36091EB23A334BF83A37C"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="9600" y="0" scale="10.666666666666666" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="13069.567431657972" y="-4.6195671499629117e-14" scale="10.666666666666666" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="9584E558D872FEA1AAB1D0D260E9DFBB"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="inner_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="73723C1289EB77C832F8339812A0A2AB"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="192.27519744296063" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="65E3A2D12AB973680C3F0D9533D2717C"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="14762.125916667708" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="E2F0212A31C6109B532A23BAF73643D8"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t</array>\n</zObjects>\n</prezi>\n';
break;case 6:this.Ob='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2">\n<xFields>\n\t<xField name="topicType">\n\t\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>\n\t</xField>\n</xFields>\n<aspectRatio>\n\t<aspectRatio value="16:9"/>\n</aspectRatio>\n<overview>\n\t<overview>\n\t\t<xFields>\n\t\t\t<xField name="usesChapters">\n\t\t\t\t<xBool value="true"/>\n\t\t\t</xField>\n\t\t</xFields>\n\t\t<minimumScale>\n\t\t\t<transform2D x="0" y="0" scale="2000" rotation="0"/>\n\t\t</minimumScale>\n\t\t<smartStructure>\n\t\t\t<xConstructor name="chainSmartStructure" type="smartStructure">\n\t\t\t\t<xField name="chainLinks">\n\t\t\t\t\t<xArray/>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="children">\n\t\t\t\t\t<xArray>\n\t\t\t\t\t\t<xRef value="top_planet"/>\n\t\t\t\t\t</xArray>\n\t\t\t\t</xField>\n\t\t\t\t<xField name="id">\n\t\t\t\t\t<xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\n\t\t\t\t</xField>\n\t\t\t</xConstructor>\n\t\t</smartStructure>\n\t</overview>\n</overview>\n<path>\n\t<array>\n\t\t<flyToOverview/>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="top_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack1_page2"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="inner_planet"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToObject>\n\t\t\t<target>\n\t\t\t\t<ref value="stack2_page1"/>\n\t\t\t</target>\n\t\t</flyToObject>\n\t\t<flyToOverview/>\n\t</array>\n</path>\n<templateInfo>\n\t<templateInfo>\n\t\t<baseId>\n\t\t\t<string value="sphere_linear_-_blue"/>\n\t\t</baseId>\n\t\t<themeId>\n\t\t\t<string value="sphere_linear_-_blue_default"/>\n\t\t</themeId>\n\t</templateInfo>\n</templateInfo>\n<zObjects>\n\t<array>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="top_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xArray>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="E17E515CDA7E01F5FFB65838A6FB1396"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="10688.825592328882" y="0" scale="711.1111111111111" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="inner_planet"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="647D1241761691B45A3BF5288EFA28F1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="647D1241761691B45A3BF5288EFA28F1"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="9600" y="0" scale="10.666666666666666" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="D15107317F9FD6F036D33A625B5FCD7Dbaseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="13069.567431657972" y="-4.6195671499629117e-14" scale="10.666666666666666" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack1_page2"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="EEF8C675995BADA1DADD4BDC3F8043BC"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="EEF8C675995BADA1DADD4BDC3F8043BC"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157756" y="-2058.5737122814726" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="inner_planet"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="planetChapter">\n\t\t\t\t\t<xField name="smartStructure">\n\t\t\t\t\t\t<xConstructor type="smartStructure" name="linearSmartStructure">\n\t\t\t\t\t\t\t<xField name="baseline">\n\t\t\t\t\t\t\t\t<xJust>\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xJust>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t<xField name="id">\n\t\t\t\t\t\t\t\t<xString value="60EE8CBB69D88FCAB3B8ADDD633E38EA"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="192.27519744296063" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="CB7C5A78E40C191218D60EB848818FB8"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="CB7C5A78E40C191218D60EB848818FB8"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13824.000000000002" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame2"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<zLine>\n\t\t\t<id>\n\t\t\t\t<string value="B2684DB95E3CE2E75222798661B1B796baseline"/>\n\t\t\t</id>\n\t\t\t<localToWorld>\n\t\t\t\t<transform2D x="14762.125916667708" y="-9.094947017729282e-13" scale="2.8841279616444098" rotation="1.5707963267948966"/>\n\t\t\t</localToWorld>\n\t\t\t<startEndDistance>\n\t\t\t\t<double value="606.7071989502306"/>\n\t\t\t</startEndDistance>\n\t\t\t<arcHeight>\n\t\t\t\t<double value="-141.4561065641304"/>\n\t\t\t</arcHeight>\n\t\t</zLine>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack1_page2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="stackChapter">\n\t\t\t\t\t<xField name="position">\n\t\t\t\t\t\t<xConstructor type="position" name="absolute">\n\t\t\t\t\t\t\t<xField name="localToWorld">\n\t\t\t\t\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="57.682559232888124" rotation="0"/>\n\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t</xConstructor>\n\t\t\t\t\t</xField>\n\t\t\t\t\t<xField name="topicChildren">\n\t\t\t\t\t\t<xArray>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="content"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="stack2_page1"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t\t<xRecord type="topicChild">\n\t\t\t\t\t\t\t\t<xField name="behaviour">\n\t\t\t\t\t\t\t\t\t<xConstructor type="topicChildBehaviour" name="visual"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t\t<xField name="child">\n\t\t\t\t\t\t\t\t\t<xRef value="2AE3418BBBA54D13B5E6BE770C893ED0"/>\n\t\t\t\t\t\t\t\t</xField>\n\t\t\t\t\t\t\t</xRecord>\n\t\t\t\t\t\t</xArray>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zShape" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="2AE3418BBBA54D13B5E6BE770C893ED0"/>\n\t\t\t</xField>\n\t\t\t<xField name="shapeType">\n\t\t\t\t<xEnum type="ShapeType" value="oval"/>\n\t\t\t</xField>\n\t\t\t<xField name="localToWorld">\n\t\t\t\t<xTransform2D x="13288.421108157758" y="2058.5737122814708" scale="2.884127961644406" rotation="0"/>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray>\n\t\t\t\t\t<xToken value="frame1"/>\n\t\t\t\t</xArray>\n\t\t\t</xField>\n\t\t\t<xField name="width">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t\t<xField name="height">\n\t\t\t\t<xDouble value="600"/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t\t<xConstructor name="zTopicContainer" type="zObject">\n\t\t\t<xField name="id">\n\t\t\t\t<xString value="stack2_page1"/>\n\t\t\t</xField>\n\t\t\t<xField name="topic">\n\t\t\t\t<xConstructor type="topic" name="page">\n\t\t\t\t\t<xField name="children">\n\t\t\t\t\t\t<xArray/>\n\t\t\t\t\t</xField>\n\t\t\t\t</xConstructor>\n\t\t\t</xField>\n\t\t\t<xField name="styleClasses">\n\t\t\t\t<xArray/>\n\t\t\t</xField>\n\t\t</xConstructor>\n\t</array>\n</zObjects>\n</prezi>\n';
break;case 7:this.Ob='<prezi version="2" xmlns="http://prezi.com/schema/prezi/2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://prezi.com/schema/prezi/2 http://prezi.com/schema/prezi/2"><xFields>  <xField name="topicType">\t<xEnum type="TopicType" value="WrappedInTopicContainer"/>  </xField></xFields><aspectRatio>  <aspectRatio value="16:9"/></aspectRatio><overview>  <overview>\t<xFields>\t  <xField name="usesChapters">\t\t<xBool value="true"/>\t  </xField>\t</xFields>\t<minimumScale>\t  <transform2D x="0" y="0" scale="2000" rotation="0"/>\t</minimumScale>\t<smartStructure>\t  <xConstructor name="chainSmartStructure" type="smartStructure">\t\t<xField name="chainLinks">\t\t  <xArray/>\t\t</xField>\t\t<xField name="children">\t\t  <xArray>\t\t\t<xRef value="stack"/>\t\t  </xArray>\t\t</xField>\t\t<xField name="id">\t\t  <xString value="6A959E2BD5CCD12BDD4BD1C53D8793B8"/>\t\t</xField>\t  </xConstructor>\t</smartStructure>  </overview></overview><path>  <array>\t<flyToOverview/>\t<flyToObject>\t  <target>\t\t<ref value="page"/>\t  </target>\t</flyToObject>\t<flyToOverview/>  </array></path><templateInfo>  <templateInfo>\t<baseId>\t  <string value="sphere_linear_-_blue"/>\t</baseId>\t<themeId>\t  <string value="sphere_linear_-_blue_default"/>\t</themeId>  </templateInfo></templateInfo><zObjects>  <array>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="stack"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="stackChapter">\t\t  <xField name="position">\t\t\t<xConstructor type="position" name="absolute">\t\t\t  <xField name="localToWorld">\t\t\t\t<xTransform2D x="0" y="0" scale="213.33333333333331" rotation="0"/>\t\t\t  </xField>\t\t\t</xConstructor>\t\t  </xField>\t\t  <xField name="topicChildren">\t\t\t<xArray>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="content"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="page"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t  <xRecord type="topicChild">\t\t\t\t<xField name="behaviour">\t\t\t\t  <xConstructor type="topicChildBehaviour" name="visual"/>\t\t\t\t</xField>\t\t\t\t<xField name="child">\t\t\t\t  <xRef value="5CA88A0F19ED7648AE16792B49D2844B"/>\t\t\t\t</xField>\t\t\t  </xRecord>\t\t\t</xArray>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>\t<xConstructor name="zShape" type="zObject">\t  <xField name="height">\t\t<xDouble value="600"/>\t  </xField>\t  <xField name="id">\t\t<xString value="5CA88A0F19ED7648AE16792B49D2844B"/>\t  </xField>\t  <xField name="localToWorld">\t\t<xTransform2D x="0" y="0" scale="10.666666666666666" rotation="0"/>\t  </xField>\t  <xField name="shapeType">\t\t<xEnum type="ShapeType" value="oval"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray>\t\t  <xToken value="frame1"/>\t\t</xArray>\t  </xField>\t  <xField name="width">\t\t<xDouble value="600"/>\t  </xField>\t</xConstructor>\t<xConstructor name="zTopicContainer" type="zObject">\t  <xField name="id">\t\t<xString value="page"/>\t  </xField>\t  <xField name="styleClasses">\t\t<xArray/>\t  </xField>\t  <xField name="topic">\t\t<xConstructor type="topic" name="page">\t\t  <xField name="children">\t\t\t<xArray/>\t\t  </xField>\t\t</xConstructor>\t  </xField>\t</xConstructor>  </array></zObjects></prezi>'}return this}assetManager(a){this.xl=
a;return this}nt(a,b,c){let d=a.getIPrezi();this.Ja=Oa.Jf.createCetApplication(a,b);this.Ja.getMainStage().setAspectRatio(d.getAspectRatio());a=this.Ja.getMainStage();null!=c&&a.resizeStage(c);this.j=Oa.Jf.Kt(this.Ja);this.Ja.getMainStage().setScene(this.j,this.j);this.Ja.initializeLoop(p.Bacon.newBus())}addEntity(a){let b=this.j.getEntityList().createEntity(a);b.set(k.i.getDefComponentKey(),f.CetModel.ID.Z_OBJECT);b.set(k.i.getDecoratorComponentKey(),!0);var c=m.DOM.createLocalSessionWithCorrection(m.DOM.emptyPrezi(),
()=>{}).getPrezi();a=m.DOM.createZTriangle(a);c.getTypedZObjects().append(a);k.i.setPdomCompForTest(b,new Ca.Ce(c.getTypedZObjects().getTyped(c.getTypedZObjects().length()-1)));b.set(f.CetModel.ID.RECTANGULAR.HEIGHT,20);b.set(f.CetModel.ID.RECTANGULAR.WIDTH,20);b.set(f.CetModel.ID.HAS_FILL.ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_END_ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_START_ALPHA,1);b.set(f.CetModel.ID.HAS_FILL.GRAD_START_COLOR,v.Geometry.colorFromRGBInt(0));b.set(f.CetModel.ID.HAS_FILL.GRAD_END_COLOR,
v.Geometry.colorFromRGBInt(0));k.i.setTransformComp(b,v.Geometry.transform2dFromRad({x:-80,y:0},1,0));c=v.Geometry.rectangleFromData({x:0,y:0,width:20,height:20});l.f.setLocalBounds(b,c);k.i.updateLocalBounds(b).setBoundingShape(v.Geometry.obbFromRect(c.getData()));b.set(h.CetRendererModule.getDrawingDimensionsKey(),v.Geometry.rectangleFromData({x:0,y:0,height:20,width:20}));b.setComponent(h.CetRendererModule.getDrawComponentKey(),h.CetRendererModule.createRectangleRenderer());k.i.setGrouping(b,"NotGroup");
k.i.setVisibility(b,!0,1);return b}refresh(){this.j.Em();this.j.update();return this}setMargins(a,b,c,d){this.Ja.getMainStage().setMargins(a,b,c,d,!0);this.Ja.ra.update();return this}focusTo(a){this.Ja.getMainStage().focusToId(a,!1);this.Ja.getMainStage().forceDraw();return this}render(){this.Ja.getMainStage().markViewChanged();this.Ja.ra.update();this.Ja.getBaseScene().update();return this}commit(){this.j.Em();return this}};var Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});Kc.ns=class{constructor(a){this.j=
a}getChildrenIds(a,b){return this.Xe(a,[b])}Xe(a,b){const c=this.j.getEntityById(a);if(null==c)return[];if(b.some((a)=>a===e.TopicChildBehavior.Content)){const b=e.Cet.createHierarchyQuery(this.j);if(a===this.j.getPreziW().getOverview().getEntity().getId())return b.getTopLevelEntities();if(this.Og(c))return b.getChildrenIds(c)}return this.Cu(c,b.map((a)=>this.Zm(a)))}Og(a){a=a.getWrapper(f.CetModel.ID.Z_OBJECT.W);return a.is(f.CetModel.ID.Z_TOPIC_CONTAINER)&&a.getTopic().is(f.CetModel.ID.PAGE)}getChildrenIdsVisibleOutside(a){return this.Xe(a,
[e.TopicChildBehavior.Cover,e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface])}getChildrenIdsVisibleInside(a){return this.Xe(a,[e.TopicChildBehavior.Content,e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface,e.TopicChildBehavior.Master])}getChildrenIdsVisibleBelow(a){return this.Xe(a,[e.TopicChildBehavior.Visual,e.TopicChildBehavior.Master])}getChildrenIdsVisibleOutsideAndInside(a){return this.Xe(a,[e.TopicChildBehavior.Visual,e.TopicChildBehavior.Surface])}hasBehavior(a,b){return null==
this.getChildReferer(a)?b===e.TopicChildBehavior.Content:null!=this.getBehaviorReferer(a,b)}getBehavior(a){a=e.Cet.getBehavior(this.j.getEntityById(a));if(a===f.CetModel.ID.COVER)return e.TopicChildBehavior.Cover;if(a===f.CetModel.ID.VISUAL)return e.TopicChildBehavior.Visual;if(a!==f.CetModel.ID.CONTENT){if(a===f.CetModel.ID.SURFACE)return e.TopicChildBehavior.Surface;if(a===f.CetModel.ID.MASTER)return e.TopicChildBehavior.Master}return e.TopicChildBehavior.Content}getBehaviorReferer(a,b){a=this.j.getEntityById(a);
return e.Cet.getReferer(a,this.Zm(b))}getChildReferer(a){a=this.j.getEntityById(a);return e.Cet.getReferer(a)}Zm(a){switch(a){case e.TopicChildBehavior.Cover:return f.CetModel.ID.COVER;case e.TopicChildBehavior.Content:return f.CetModel.ID.CONTENT;case e.TopicChildBehavior.Visual:return f.CetModel.ID.VISUAL;case e.TopicChildBehavior.Surface:return f.CetModel.ID.SURFACE;case e.TopicChildBehavior.Master:return f.CetModel.ID.MASTER;default:throw x.Utils.assertNever(a);}}isVisibleOutside(a){a=this.getBehavior(a);
switch(a){case e.TopicChildBehavior.Cover:case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:return!1;default:throw x.Utils.assertNever(a);}}isVisibleInside(a){a=this.getBehavior(a);switch(a){case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Cover:return!1;default:throw x.Utils.assertNever(a);
}}isVisibleBelow(a){a=this.getBehavior(a);switch(a){case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:return!0;case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:case e.TopicChildBehavior.Cover:return!1;default:throw x.Utils.assertNever(a);}}isVisibleOutsideAndInside(a){a=this.getBehavior(a);switch(a){case e.TopicChildBehavior.Visual:case e.TopicChildBehavior.Surface:return!0;case e.TopicChildBehavior.Content:case e.TopicChildBehavior.Master:case e.TopicChildBehavior.Cover:return!1;
default:throw x.Utils.assertNever(a);}}Cu(a,b){a=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic();if(null==a)return[];const c=a.getEntity();a=[];if(c.isDef(f.CetModel.ID.HAS_TOPIC_CHILDREN)){var d=c.getComponent(f.CetModel.ID.HAS_TOPIC_CHILDREN.TOPIC_CHILDREN);for(const c of d.items())if(d=this.j.getEntityById(c),null!=d&&d.isDef(f.CetModel.ID.TOPIC_CHILD)){const c=this.j.getEntityById(d.getComponent(f.CetModel.ID.TOPIC_CHILD.BEHAVIOUR).getValue());b.some((a)=>c.isDef(a))&&a.push(d.get(f.CetModel.ID.TOPIC_CHILD.CHILD))}}else if(c.isDef(f.CetModel.ID.HAS_CHILDREN)&&
b.some((a)=>a.isDef(f.CetModel.ID.CONTENT)))for(d of c.getWrapper(f.CetModel.ID.HAS_CHILDREN.W).getChildren().items())a.push(d);return a}};var W={};Object.defineProperty(W,"__esModule",{value:!0});W.Cb=class{static get(a){switch(a){case e.AnimationType.PAGE_FADE_IN:return W.Cb.Jr;case e.AnimationType.PAGE_FADE_OUT:return W.Cb.Kr;case e.AnimationType.INSTANT:return W.Cb.ir;case e.AnimationType.GENERAL:return W.Cb.br;default:return{duration:300,delay:150}}}};W.Cb.ir={duration:0,delay:0};W.Cb.br={duration:300,
delay:250};W.Cb.hy={duration:300,delay:150};W.Cb.iy={duration:300,delay:150};W.Cb.Jr={duration:200,delay:150};W.Cb.Kr={duration:200,delay:300};var k={};Object.defineProperty(k,"__esModule",{value:!0});k.Xh=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,k.Xh.prototype)}};k.If=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,k.If.prototype)}};k.ki=class extends Error{constructor(a){super(a);Object.setPrototypeOf(this,k.ki.prototype)}};class dd extends U.mb{constructor(a){super();
this.kill=a}dispose(){this.kill()}}k.oa=class{constructor(){this.errorOfflineAssetId="###ERROR###";this.DEFAULT_IMAGE_SIZE=this.DEFAULT_THUMBNAIL_SIZE=42;this.pathKludge=new ed;this.wk=this.createOverlayComponentKey("SpinnerOverlay")}createDisposableComponent(a){return new dd(a)}createCetApplication(a,b,c,d){return new qb.Sk(a,c,d,b,()=>T.VideoModule.createVideo(),null,!0)}getBehavior(a){a=this.$m(a);return null!=a?a.def:null}$m(a){if(null==a)return null;var b=a.get(f.CetModel.ID.TOPIC_CHILD.CHILD_PARENT);
b=null!=b&&0<b.length?b[0]:null;a=a.getEntityList().getEntityById(b);return null==a?null:{def:a.getChild(f.CetModel.ID.TOPIC_CHILD.BEHAVIOUR).getDef(),Cx:a}}getReferer(a,b=null){const c=this.$m(a);if(null==c||null!=b&&!c.def.isDef(b))return null;b=c.Cx.get(f.CetModel.ENTITY_OWNER_ID());a=a.getEntityList().getEntityById(b);return null==a?null:a.get(f.CetModel.ENTITY_OWNER_ID())}createHierarchyQuery(a){return new qc.fr(a)}createTopicChildrenQuery(a){return new Kc.ns(a)}setupPdomLogging(a){rb.kl.lx(a)}getUrlsInString(a){return J.Ha.getUrlsInString(a)}getEmailsInString(a){return zb.Nq.getEmailsInString(a)}createAssetManager(a){return Tc.AssetLoader.createAssetManager(a)}createCetTestHelperBuilder(){return new Oa.Jf}world(a){return l.f.world(a)}updateWorld(a){return l.f.world(a)}setWorld(a,
b){a.set(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD,b);h.CetRendererModule.updateWorldProperties(a);return a}visibility(a,b=!1){return l.f.visibility(a,b)}updateVisibility(a){return l.f.updateVisibility(a)}commentVisibility(a){return l.f.commentVisibility(a)}updateCommentVisibility(a){return l.f.updateCommentVisibility(a)}grouping(a){return l.f.grouping(a)}zOrder(a){return l.f.zOrder(a)}hasZOrder(a){return null!=l.f.zOrder(a)}setZOrderComp(a,b){return l.f.setZOrderComp(a,b)}transform(a){return l.f.transform(a)}getMask_Killme(a){const b=
a.getMask();return null==b?v.Geometry.rectangleFromData({x:0,y:0,width:a.getWidth(),height:a.getHeight()}):b}getCurrentPathPositionKey(){null==k.oa.im&&(k.oa.im=f.CetModel.createValueComponentKey("current_path_position",!1,!1));return k.oa.im}setTransformComp(a,b){k.i.updateTransform(a).setLocalToWorld(b);return a}updateTransform(a){return k.i.Lt(a)}gx(a,b){var c=a.getMutableWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getMutableTopic().getEntity();c.isDef(f.CetModel.ID.HAS_POSITION)&&(c=c.getMutableWrapper(f.CetModel.ID.HAS_POSITION.W).getMutablePosition().getEntity(),
c.isDef(f.CetModel.ID.ABSOLUTE)?c.getMutableWrapper(f.CetModel.ID.ABSOLUTE.W).setLocalToWorld(b):t.LoggerModule.getLoggerManager().createLogger("cet_static").error({action:"set_topic_position",object:"object",trigger:"machine",payload:{error:"Setting position of automatically calculated topics is not implemented!",jc:a.getId()}}))}Lt(a){return a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?new G.Id({getEntity:()=>a,getId:()=>a.getId(),asMutableEntity:()=>a,getLocalToWorld:()=>h.CetRendererModule.getLocalToWorld(a),
getWorldToLocal:()=>h.CetRendererModule.getLocalToWorld(a).invert(),setLocalToWorld:(b)=>{k.i.gx(a,b);h.CetRendererModule.updateWorldProperties(a)},toIPdom:()=>null}):new G.Id(a.getMutableWrapper(f.CetModel.ID.TRANSFORMED.W))}draw(a){a=a.getUntypedComponent(h.CetRendererModule.getDrawComponentKey(),!1);return null!=a?a:null}mutableDraw(a){a=a.getUntypedComponent(h.CetRendererModule.getDrawComponentKey(),!1);return null!=a?a:null}fading(a){return l.f.fading(a)}hasPdomComponent(a){return null!=a.getComponent(l.f.MODEL)}getPdomCompKey(){return l.f.MODEL}setPdomCompForTest(a,
b){a.setComponent(l.f.MODEL,b);return a}getVideoComponentKeyForTest(){return l.f.VIDEO}image(a){return a.isDef(f.CetModel.ID.IMAGE)?k.i.draw(a):null}video(a){return a.isDef(f.CetModel.ID.Z_VIDEO)?k.i.draw(a):null}createEntityListForTest(){return new La.Nf(new M.Xf(new Wa.gi,"test",null,null,!1),new hb.el)}createComponentFactoryForTest(){return new ob.Vk}setFadingComp(a,b){return l.f.setFadingComp(a,b)}setVisibility(a,b,c=1){return l.f.setVisibility(a,b,c)}setFocusBehavior(a,b){return l.f.setFocusBehavior(a,
b)}setGrouping(a,b,c,d){return l.f.setGrouping(a,b,c,d)}setGroupingComp(a,b){return l.f.setGroupingComp(a,b)}toggleDebugFlag(a){return A.fa.toggleDebugFlag(a)}getMutableFillComponent(a){return a.getMutableWrapper(f.CetModel.ID.HAS_FILL.W)}setFillComponentWithSolidColor(a,b,c){a.set(f.CetModel.ID.HAS_FILL.FILL_TYPE,f.FillType.Solid);a.set(f.CetModel.ID.HAS_COLOR.COLOR,b);a.set(f.CetModel.ID.HAS_FILL.ALPHA,c);return a}setWorldComp(a,b){return l.f.setWorldComp(a,b)}border(a){return a.getWrapper(f.CetModel.ID.HAS_BORDER.W)}localBounds(a){return h.CetRendererModule.getLocalBoundsComponent(a)}updateLocalBounds(a){return h.CetRendererModule.getMutableLocalBoundsComponent(a)}calculateZoomBounds(a,
b){let c=k.i.draw(b).calculateZoomBounds(b);a=k.i.createHierarchyQuery(a);a.isChapterWithSmartStructure(b.getId())&&(c=a.getTopicLocalZoomBounds_killme(b),c=h.CetRendererModule.addPaddingToBounds(c,b.get(f.CetModel.ID.HAS_PADDING.PADDING)));return c}fill(a){return a.getWrapper(f.CetModel.ID.HAS_FILL.W)}setBorder(a,b,c,d){a.set(f.CetModel.ID.HAS_BORDER.BORDER_THICKNESS,b);null!=c&&a.set(f.CetModel.ID.HAS_BORDER.BORDER_COLOR,c);null!=d&&a.set(f.CetModel.ID.HAS_BORDER.BORDER_ALPHA,d);return a}sortInZOrder(a){return h.CetRendererModule.sortEntitiesInZOrder(a)}shapedText(a){return a.getComponent(l.f.Aa).getShapedText()}hasShapedText(a){return a.hasComponent(l.f.Aa)}shapedTextVersion(a){return a.hasComponent(l.f.Aa)?
a.getComponent(l.f.Aa).getVersion():0}setText_Killme(a,b){a.setComponent(l.f.Aa,{zp:()=>{},getShapedText:()=>b,getVersion:()=>0,setVersion:()=>{},setOnEntity:()=>{},dispose:()=>{},incrementVersion:()=>{}});return a}setText(a,b){let c=a.getMutableComponent(l.f.Aa);if(null==c)throw Error("shapedtext component is missing");c.zp(a,b);return a}createSceneBuilderForTest(){return new Va.fi(new Wa.gi,null,null,null,null)}Pu(){return[...h.CetRendererModule.getBoundsComponentKeys(),h.CetRendererModule.getDrawComponentKey(),
h.CetRendererModule.getIsLoadedComponentKey(),f.CetModel.getNewEntityCompKey(),l.f.Aa,h.CetRendererModule.getInEditFontSizeComponentKey(),f.CetModel.ID.Z_SHAPE.SHAPE_TYPE,f.CetModel.ID.Z_TEXT.TEXT,l.f.Vf,...f.CetModel.ID.HAS_FILL.getFields(),...f.CetModel.ID.STYLED.getFields(),...f.CetModel.ID.HAS_COLOR_FILTER.getFields(),h.CetRendererModule.getTextUnderlineComponentKey(),...f.CetModel.ID.BACKGROUND.getFields(),h.CetRendererModule.getDrawingDimensionsKey(),f.CetModel.ID.NEXT_LOGO_V1.BACKGROUND_COLOR,
f.CetModel.ID.NEXT_LOGO_V1.BACKGROUND_ALPHA,f.CetModel.ID.HAS_CORNER_RADIUS.CORNER_RADIUS,f.CetModel.ID.HAS_FONT.BACKGROUND_CORNER_RADIUS]}getComponentKey(a){return a._compkey_}getDrawComponentKey(){return h.CetRendererModule.getDrawComponentKey()}getFadingComponentKey(){return h.CetRendererModule.getFadingComponentKey()}getZOrderComponentKey(){return h.CetRendererModule.getZOrderComponentKey()}getNotCalculatedIntoOverviewCompKey(){null==k.oa.Ho&&(k.oa.Ho=f.CetModel.createValueComponentKey("notCalculatedIntoOverviewKey",
!1,!1));return k.oa.Ho}getDisableSpinnerKey(){null==k.oa.lm&&(k.oa.lm=f.CetModel.createValueComponentKey("disableSpinnerKey",!1,!1));return k.oa.lm}curvedLine(a){return a.getWrapper(f.CetModel.ID.CURVED_LINE.W)}getMutableCurvedLine(a){return a.getMutableWrapper(f.CetModel.ID.CURVED_LINE.W)}hasCurvedLine(a){return a.isDef(f.CetModel.ID.CURVED_LINE)}mediaAsset(a){return a.getWrapper(f.CetModel.ID.MEDIA_ASSET.W)}mutableMediaAsset(a){return a.getMutableWrapper(f.CetModel.ID.MEDIA_ASSET.W)}transformedImage(a){return a.getWrapper(f.CetModel.ID.TRANSFORMED_IMAGE.W)}mutableTransformedImage(a){return a.getMutableWrapper(f.CetModel.ID.TRANSFORMED_IMAGE.W)}curvedLineStartPoint(a){return h.CetRendererModule.CurvedLineCalculation().getStartPoint(a)}curvedLineEndPoint(a){return h.CetRendererModule.CurvedLineCalculation().getEndPoint(a)}isCurvedLineInverse(a){return h.CetRendererModule.CurvedLineCalculation().isInverse(a)}curvedLineOrigin(a){return h.CetRendererModule.CurvedLineCalculation().getOrigin(a)}curvedLineRadius(a){return h.CetRendererModule.CurvedLineCalculation().getRadius(a)}curvedLineStartAngle(a){return h.CetRendererModule.CurvedLineCalculation().getStartAngle(a)}curvedLineEndAngle(a){return h.CetRendererModule.CurvedLineCalculation().getEndAngle(a)}getArrowHeadLength(){return h.CetRendererModule.ArrowCalculation().getHeadLength()}createIdDataEvent(a,
b){return new pc.kr(a,b)}getAspectRatioClipComponentKey(){return l.f.Pk}getDefComponentKey(){return f.CetModel.DEF()}getDecoratorComponentKey(){return l.f.Yh}getPendingInsertComponentKey(){return l.f.PENDING_INSERT}getSelectionTextRangeComponentKey(){return l.f.Vf}getTextCaretOffsetComponentKey(){return l.f.sl}createSimpleReplaceMergeStrategy(){let a=new Ya.ai;a.Vh=e.MergeType.REPLACE;a.Hh=e.MergeType.REPLACE;a.zg=e.MergeType.REPLACE;a.yg=e.MergeType.REPLACE;a.xg=e.MergeType.REPLACE;a.fg=e.MergeType.REPLACE;
return a}createDiffReplaceMergeStrategy(){let a=new Ya.ai;a.Vh=e.MergeType.REPLACE_DIFFED;a.Hh=e.MergeType.REPLACE_DIFFED;a.zg=e.MergeType.REPLACE_DIFFED;a.yg=e.MergeType.REPLACE_DIFFED;a.xg=e.MergeType.REPLACE_DIFFED;a.fg=e.MergeType.REPLACE_DIFFED;return a}createSimpleKeepMergeStrategy(){let a=new Ya.ai;a.Vh=e.MergeType.KEEP;a.Hh=e.MergeType.KEEP;a.zg=e.MergeType.KEEP;a.yg=e.MergeType.KEEP;a.xg=e.MergeType.KEEP;a.fg=e.MergeType.KEEP;return a}createFastForwardNavigationStrategy(a){return new Fa.ye(a)}createSimpleFlyingNavigationStrategy(){return new bb.pl}createImmediateNavigationStrategy(){return new tc.mr}createAutoPlayer(a,
b){return new sc.sq(a,b)}createAutoplaySpeedTestHelper(a,b){return new yb.tq(a,b)}createEntityGroup(a,b){return new oc.Oq(a,b)}getEntityHittestDisabledKey(){return l.f.dr}getTemporaryEntityHittestDisabledKey(){return l.f.ks}getAnimationData(a){return W.Cb.get(a)}createTransformTween(a,b,c,d,e){return(new ba.uc).createTransformTween(a,b,c,d,e)}createAlphaTween(a,b,c,d,e){return(new ba.uc).createAlphaTween(a,b,c,d,e)}createTextWrapWidthTween(a,b,c,d){return(new ba.uc).createTextWrapWidthTween(a,b,c,
d)}createTweenFactory(){return new ba.uc}getShapedTextKey(){return l.f.Aa}pathPositionFromStepIndex_killMe(a,b=0){return new za.Be(a,b)}getStyleClass(a){a=a.getComponent(f.CetModel.ID.STYLED.STYLE_CLASSES);return null!=a&&0<a.length()?a.getAt(0):null}getStyleClassFromEnum(a,...b){a=a.getComponent(f.CetModel.ID.STYLED.STYLE_CLASSES);for(let c=0;c<a.length();c++){const d=this.kn(a.getAt(c),b);if(null!=d)return d}return null}setStyleClass(a,b){let c=a.getMutableWrapper(f.CetModel.ID.STYLED.W).getMutableStyleClasses();
for(;0<c.length();)c.removeAt(0);null!=b&&c.add(b);this.fp(a.getEntityList().getScene(),[a.getId()])}setStyleClassFromEnum(a,b,...c){let d=a.getMutableWrapper(f.CetModel.ID.STYLED.W).getMutableStyleClasses();for(let a=0;a<d.length();)null!=this.kn(d.getAt(a),c)?d.removeAt(a):a++;null!=b&&d.add(b);this.fp(a.getEntityList().getScene(),[a.getId()])}kn(a,b){for(const c of b)for(const b in c)if(c.hasOwnProperty(b)&&a===c[b])return c[b];return null}fp(a,b){const c=a.getPreziW().getMutableDocumentStyle().getMutableStyleDeclarations();
a=this.ou(a,b);for(b=a.length-1;0<=b;b--)c.removeAt(a[b])}ou(a,b){let c=0;const d=[];a.getPreziW().getMutableDocumentStyle().getMutableStyleDeclarations().forEachMutable((a)=>{a=a.getStyleSelector().toString();0===a.indexOf("#")&&(null!=b?-1!==b.indexOf(a.substr(1))&&d.push(c):d.push(c));c++});return d}fixIPrezi(a,b){return f.CetModel.createPreziFixer(b).fixIPrezi(a)}cetSessionFactoryInternal(a){return new Hc.wq(f.CetModel.createPreziFixer(f.getDocumentGenerationFromFeatureSwitches()),a,new zc.vq)}createEditorPath(a){return new ma.Mq(a)}createPlaybackPath(a){return new ma.ml(a)}getPathVisibilityKey(){null==
k.oa.Po&&(k.oa.Po=f.CetModel.createValueComponentKey("path-visibility",!1,!1));return k.oa.Po}Xm(){null==k.oa.Jl&&(k.oa.Jl=f.CetModel.createValueComponentKey("audio-buffer",!1,!1,!0));return k.oa.Jl}getAssetThumbnailKey(){null==k.oa.Il&&(k.oa.Il=f.CetModel.createValueComponentKey("asset-thumbnail",!1,!1,!0));return k.oa.Il}calcOverviewBoundsData(a,b){const c=a.getPreziW().getOverview().getEntity();var d=[];if(b)d=e.Cet.createHierarchyQuery(a).getReachableEntities(c.getId()).map((b)=>a.getEntityById(b));
else for(let b of a.getPreziW().getZObjects())d.push(b.getEntity());let g=null;d.forEach((a)=>{if(a.getId()!==c.getId()){var d=a.getChild(f.CetModel.ID.Z_TOPIC_CONTAINER.TOPIC);null!=d&&(d.isDef(f.CetModel.ID.PLANET_CHAPTER)||b&&d.isDef(f.CetModel.ID.STACK_CHAPTER))||a.get(e.Cet.getNotCalculatedIntoOverviewCompKey())||a.get(f.CetModel.ID.CONNECTOR.DEGENERATE_INVISIBLE)||null==k.i.world(a)||(a=this.getAxisAlignedWorldRectangle(a,b),null!=a&&(d=a.getData(),isNaN(d.height)||isNaN(d.width)||isNaN(d.x)||
isNaN(d.y)||(null!=g&&null!=a?g=g.union(a):null==g&&(g=a))))}});d=this.mv(a,c,g);return{documentWorldAABB:g,documentWithMinimumSizeAABB:d,localToWorld:this.calcOverviewLocalToWorld(c,d)}}calcOverviewLocalToWorld(a,b){a=h.CetRendererModule.getLocalBoundsComponent(a);a=b.getWidth()/a.getGraphicsBounds().getWidth()<b.getHeight()/a.getGraphicsBounds().getHeight()?b.getHeight()/a.getGraphicsBounds().getHeight():b.getWidth()/a.getGraphicsBounds().getWidth();b={x:b.getCenter().x,y:b.getCenter().y};return v.Geometry.transform2dFromDeg(b,
a,0)}getAxisAlignedWorldRectangle(a,b){var c;return b&&a.isDef(f.CetModel.ID.Z_TEXT)?(b=a.get(h.CetRendererModule.getZTextBoundsKey()).visible,a=e.Cet.transform(a).getLocalToWorld(),b.transformAABB(v.Geometry.createFromTransform(a))):null===(c=e.Cet.world(a))||void 0===c?void 0:c.getWorldAxisAlignedBounds()}mv(a,b,c){let d=b.get(f.CetModel.ID.OVERVIEW.MINIMUM_SCALE);if(null!=d)return a=k.i.localBounds(b).getGraphicsBounds().transformAABB(v.Geometry.createFromTransform(d)),null!=c?c.union(a):a;if(null!=
c)return c;c=e.Cet.parseAspectRatio(a.getPreziW().getAspectRatio());return v.Geometry.rectangleFromData({x:-c.width/2,y:-c.height/2,width:c.width,height:c.height})}Fg(a,b,c){a=a.getData();c=c.getData();var d=v.Geometry.createFromTransform(b);b=v.Geometry.createFromTransform(v.Geometry.transform2dFromRad({x:a.x+a.width/2,y:a.y+a.height/2},1,0));b.concat(d);d=a.width/c.width;a=a.height/c.height;if(0===d||0===a)a=d=1;b.invert();b.scale(1/Math.max(d,a));return b.toTransform()}getTargetTransform(a,b,c){b=
a.getEntityById(b);if(null==b)return null;a=k.i.calculateZoomBounds(a,b);return k.i.Fg(a,k.i.transform(b).getLocalToWorld(),c)}getViewportWorldIfFocusedOnEntity(a,b,c){a=k.i.getTargetTransform(b,a.getId(),c.getViewport());return v.Geometry.obbFromRect(c.getViewport().getData()).transform(a.invert())}createOverlayComponentKey(a){return O.Pa.createOverlayComponentKey(a,!0)}createOverlayComponent(a,b){return O.Pa.createOverlayComponent(a,b)}getLegacyOverlayComponentKey(){return O.Pa.getLegacyOverlayComponentKey()}cleanupTransformation(a){null!=
a&&(a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?(a=a.getMutableWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getMutableTopic().getEntity(),a.discardOwnComponent(f.CetModel.ID.HAS_POSITION.POSITION),a=a.getMutableWrapper(f.CetModel.ID.HAS_POSITION.W).getMutablePosition(),null!=a&&a.getEntity().discardOwnComponent(f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD)):a.discardOwnComponent(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD))}Su(a){return null==a?0:a.isDef(f.CetModel.ID.Z_TOPIC_CONTAINER)?(a=a.getWrapper(f.CetModel.ID.Z_TOPIC_CONTAINER.W).getTopic().getEntity().getWrapper(f.CetModel.ID.HAS_POSITION.W).getPosition(),
null!=a?a.getEntity().getComponent(f.CetModel.ID.ABSOLUTE.LOCAL_TO_WORLD).getVersion():0):a.getComponent(f.CetModel.ID.TRANSFORMED.LOCAL_TO_WORLD).getVersion()}isSystemInit(a){return"init"in a}isInflator(a){return"initializeEntities"in a}hasIndirectTriggerConfig(a){return"getRequiredKeysForIndirectTrigger"in a}createCoeditOfflineOnlineSwitchHandler(a,b){return x.Utils.ActorSystem().startSyncActor("CoeditOfflineOnlineSwitchHandler",Ic.yq,{startedInOffline:a,isPresenting:b})}createDummyCoeditOfflineOnlineSwitchHandler(){const a=
{actionsWired(){},desktopNetworkOnlineStatusUpdate(){},coeditInitialConnectionFailure(){},coeditFinishedAndWaitingForGoOnline(){},coeditReconnected(){},mediaAssetSyncSuccess(){},mediaAssetSyncNonRetryableFailure(){},mediaAssetSyncRetryableFailure(){},cetSyncFinished(){},connectionLost(){},editorModeChanged(){}};return{get currentBehaviourName(){return"dummyState"},tell(){return a}}}createImagePatcher(a){return new Na.Of(a)}createPdfPatcher(a){return new wc.Sr(a)}createVideoPatcher(a){return new xc.vs(a)}createChartPatcher(a){return new vc.xq(a)}createAudioPatcher(a){return new uc.qq(a)}getErrorInfo(a){return{get isCannotStartTransactionError(){return a instanceof
k.Xh},get isCannotFinishTransactionError(){return a instanceof k.If},get isTransactionNotInProgressError(){return a instanceof k.ki}}}getEditorApiLogger(){null==k.oa.tm&&(k.oa.tm=new nc.Lq);return k.oa.tm}parseAspectRatio(a){return f.CetModel.parseAspectRatio(a)}createPreziDOMStatCollector(a){return new yc.Ur(a)}getZTextFixer(a){let b=a;for(;null!=b;){for(const c of b.Cg())if(c instanceof N.mi)return c.getZTextFixer(a);b=b.getParentScene()}return null}addSpinner(a,b){null!=b&&Ga.Ee.Ks(b,a)}removeSpinner(a){null!=
a&&Ga.Ee.Aw(a)}createTestIdGenerator(a){const b=m.DOM.createSeededIdGenerator(a);let c=0;return{generateId:()=>{const a=b.generateId(),e=`${c}_`;c++;return`${e}${a.substring(e.length)}`}}}selectBestMatchingFontFace(a,b){let c=0,d=null;for(let e of b)if(b=e.fontStyle===a.fontStyle&&e.fontWeight===a.fontWeight?4:e.fontStyle===f.FontStyle.Normal&&e.fontWeight===e.fontWeight?3:e.fontStyle===a.fontStyle&&e.fontWeight===f.FontWeight.Normal?2:e.fontStyle===f.FontStyle.Normal&&e.fontWeight===f.FontWeight.Normal?
1:0,b>c&&(d=e,c=b),4===c)break;return d}};class ed{assertEditorPathV2(a){var b;a=a.getEditorPath();x.Utils.assert(0<(null===(b=m.DOM.RuntimeTypeInfo().safeCastToEditorPathV2(a))||void 0===b?void 0:b.getSteps().length()),"editorpathV2 expected")}getEditorPathComponent(a){a=a.getPreziW();this.assertEditorPathV2(a);return a.getEditorPath().getEntity().getComponent(f.CetModel.ID.EDITOR_PATH_V2.STEPS)}getEditorPathStepWList(a){a=a.getPreziW();this.assertEditorPathV2(a);return[...a.getEditorPath().getSteps()]}getIEditorPathStepsFromIPrezi(a){this.assertEditorPathV2(a);
return[...f.CetModel.pdomIterable(a.getEditorPath().getSteps())]}getISomeEditorPathActionW(a){return(null===a||void 0===a?0:a.isDef(f.CetModel.ID.EDITOR_PATH_ACTION))?a.getWrapper(f.CetModel.ID.EDITOR_PATH_ACTION.W):null}getISomeEditorPathStepW(a){return(null===a||void 0===a?0:a.isDef(f.CetModel.ID.EDITOR_PATH_STEP))?a.getWrapper(f.CetModel.ID.EDITOR_PATH_STEP.W):null}}k.i=new k.oa;var e={};Object.defineProperty(e,"__esModule",{value:!0});(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote"})(e.EditKind||
(e.EditKind={}));(function(a){a.ALL_ASSETS_LOADED="allAssetsLoaded";a.VIDEO_LOADING_STARTED="videoLoadingStarted";a.VIDEO_LOADING_FINISHED="videoLoadingFinished"})(e.AssetLoadingMessage||(e.AssetLoadingMessage={}));(function(a){a[a.InitialConnectionFailure=0]="InitialConnectionFailure";a[a.AccessDeniedError=1]="AccessDeniedError";a[a.MultiUserLockError=2]="MultiUserLockError";a[a.TransportError=3]="TransportError";a[a.ConnectionLost=4]="ConnectionLost";a[a.Reconnected=5]="Reconnected";a[a.HardResetedPreziIsAvailable=
6]="HardResetedPreziIsAvailable";a[a.RoomInfoChanged=7]="RoomInfoChanged";a[a.RequestSync=8]="RequestSync";a[a.RemoteChangesAvailable=9]="RemoteChangesAvailable";a[a.RoomKeyValueStoreChanged=10]="RoomKeyValueStoreChanged";a[a.PeerKeyValueStoreChanged=11]="PeerKeyValueStoreChanged";a[a.KeyValueStoresReset=12]="KeyValueStoresReset";a[a.Finished=13]="Finished";a[a.IllegalStateError=14]="IllegalStateError";a[a.SessionReady=15]="SessionReady";a[a.InvalidDocumentStateError=16]="InvalidDocumentStateError";
a[a.OfflineTimerTriggered=17]="OfflineTimerTriggered";a[a.ReconnectingFromFinished=18]="ReconnectingFromFinished";a[a.ResetUndoRedo=19]="ResetUndoRedo"})(e.CetNetworkEventType||(e.CetNetworkEventType={}));(function(a){a[a.StyleSheet=0]="StyleSheet";a[a.Entity=1]="Entity";a[a.EntitiesModified=2]="EntitiesModified";a[a.Document=3]="Document"})(e.ChangeEventKind||(e.ChangeEventKind={}));(function(a){a.RENDER_ZOOMED_OUT_TO_SHOW_SURROUNDINGS=1;a.USE_PARTITION_RENDERER=2;a.DRAW_PARTITION_BORDERS=3;a.RENDER_PARTITIONS_ON_DEMAND=
4;a.SHOW_OBJECT_IDS=5;a.QUADTREE_BOUNDS=7;a.CAMERA_AREA=8;a.CHECK_INVARIANTS=10})(e.DebugFlag||(e.DebugFlag={}));(function(a){a[a.ToId=0]="ToId";a[a.ToRectangle=1]="ToRectangle";a[a.ToOverview=2]="ToOverview"})(e.NavigationActionTargetType||(e.NavigationActionTargetType={}));(function(a){a[a.Focus=0]="Focus";a[a.Fly=1]="Fly";a[a.FadeIn=2]="FadeIn";a[a.FadeOut=3]="FadeOut";a[a.Snap=4]="Snap";a[a.Slide=5]="Slide"})(e.NavigationActionAnimationType||(e.NavigationActionAnimationType={}));(function(a){a[a.Start=
0]="Start";a[a.End=1]="End";a[a.Cancel=2]="Cancel"})(e.NavigationActionAnimationPhase||(e.NavigationActionAnimationPhase={}));(function(a){a[a.ANIMATE_ONLY_CURRENT=0]="ANIMATE_ONLY_CURRENT";a[a.NEVER_ANIMATE=1]="NEVER_ANIMATE"})(e.StageTweenMode||(e.StageTweenMode={}));(function(a){a[a.NONE=0]="NONE";a[a.FLY=1]="FLY";a[a.SNAP_IN=2]="SNAP_IN";a[a.SNAP_OUT=3]="SNAP_OUT";a[a.FOCUS=4]="FOCUS"})(e.CameraNavigationType||(e.CameraNavigationType={}));(function(a){a[a.None=0]="None";a[a.Pan=1]="Pan";a[a.Zoom=
2]="Zoom";a[a.Fly=3]="Fly"})(e.CameraTransitionType||(e.CameraTransitionType={}));(function(a){a[a.ZOOM_IN=0]="ZOOM_IN";a[a.ZOOM_OUT=1]="ZOOM_OUT"})(e.ZoomingDirection||(e.ZoomingDirection={}));(function(a){a[a.NoZoom=0]="NoZoom";a[a.ZoomIn=1]="ZoomIn";a[a.ZoomOut=2]="ZoomOut"})(e.ZoomingEvent||(e.ZoomingEvent={}));(function(a){a[a.WithinLimits=0]="WithinLimits";a[a.ZoomInLimitReached=1]="ZoomInLimitReached";a[a.ZoomOutLimitReached=2]="ZoomOutLimitReached"})(e.ZoomingLimit||(e.ZoomingLimit={}));(function(a){a[a.PanningStarted=
0]="PanningStarted";a[a.PanningFinished=1]="PanningFinished"})(e.PanningEvent||(e.PanningEvent={}));(function(a){a[a.TransitionStarted=0]="TransitionStarted";a[a.TransitionFinished=1]="TransitionFinished"})(e.TransitionEvent||(e.TransitionEvent={}));(function(a){a[a.EndTransaction=0]="EndTransaction";a[a.BeginOtherTransaction=1]="BeginOtherTransaction";a[a.AbortTransaction=2]="AbortTransaction";a[a.RollbackTransaction=3]="RollbackTransaction"})(e.FinishEventKind||(e.FinishEventKind={}));(function(a){a[a.KEEP=
0]="KEEP";a[a.REPLACE=1]="REPLACE";a[a.REPLACE_DIFFED=2]="REPLACE_DIFFED";a[a.REPLACE_DIFFED_CUSTOM=3]="REPLACE_DIFFED_CUSTOM"})(e.MergeType||(e.MergeType={}));(function(a){a[a.UPDATE=0]="UPDATE";a[a.PRE_RENDER=1]="PRE_RENDER";a[a.UPDATE_ONCE=2]="UPDATE_ONCE";a[a.FIXER=3]="FIXER";a[a.TWEEN=4]="TWEEN";a[a.GEOMETRY=5]="GEOMETRY";a[a.DOCUMENT=6]="DOCUMENT"})(e.UpdatePhase||(e.UpdatePhase={}));(function(a){a.next="next";a.prev="prev";a["goto"]="goto"})(e.NavigationIntent||(e.NavigationIntent={}));(function(a){a[a.NEW_TRANSITION=
0]="NEW_TRANSITION";a[a.JUMP=1]="JUMP";a[a.ACCELERATE=2]="ACCELERATE";a[a.ACCELERATE_2=3]="ACCELERATE_2";a[a.INVERSE_ACCELERATE=4]="INVERSE_ACCELERATE";a[a.INVERSE_ACCELERATE_2=5]="INVERSE_ACCELERATE_2"})(e.NavigationMode||(e.NavigationMode={}));(function(a){a[a.NEW_TARGET=0]="NEW_TARGET";a[a.CONTINUE=1]="CONTINUE";a[a.TURN_BACK=2]="TURN_BACK"})(e.NavigationChange||(e.NavigationChange={}));(function(a){a[a.START=0]="START";a[a.STOP=1]="STOP";a[a.WAIT=2]="WAIT";a[a.RESTART=3]="RESTART";a[a.NEXT=4]=
"NEXT"})(e.AutoPlayEventType||(e.AutoPlayEventType={}));(function(a){a[a.NONE=0]="NONE";a[a.OWN_VISUAL=1]="OWN_VISUAL";a[a.ALL_VISUALS=2]="ALL_VISUALS";a[a.ALL_VISUALS_AND_BACKGROUND=3]="ALL_VISUALS_AND_BACKGROUND"})(e.VisualBackgroundReachLevel||(e.VisualBackgroundReachLevel={}));(function(a){a.Cover="cover";a.Content="content";a.Visual="visual";a.Surface="surface";a.Master="master"})(e.TopicChildBehavior||(e.TopicChildBehavior={}));(function(a){a[a.IMMEDIATE=0]="IMMEDIATE";a[a.ANIMATION=1]="ANIMATION"})(e.TweenMode||
(e.TweenMode={}));(function(a){a[a.INSTANT=0]="INSTANT";a[a.GENERAL=1]="GENERAL";a[a.OVERVIEW_FADE_IN=2]="OVERVIEW_FADE_IN";a[a.OVERVIEW_FADE_OUT=3]="OVERVIEW_FADE_OUT";a[a.PAGE_FADE_IN=4]="PAGE_FADE_IN";a[a.PAGE_FADE_OUT=5]="PAGE_FADE_OUT";a[a.COVER_ITEM_FADE_OUT=6]="COVER_ITEM_FADE_OUT";a[a.CONTENT_FADE_IN=7]="CONTENT_FADE_IN";a[a.CONTENT_FADE_OUT=8]="CONTENT_FADE_OUT";a[a.SUBTOPIC_FADE_IN=9]="SUBTOPIC_FADE_IN";a[a.SIBLING_FADE_OUT=10]="SIBLING_FADE_OUT"})(e.AnimationType||(e.AnimationType={}));
e.Cet=k.i;return Rc=e});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_cet",["require","prezi.engine.dom","prezi.engine.dom.converter.xpdom2","prezi.geometry","prezi.text","prezi.text.model","prezi_bacon","prezi_cet_model","prezi_cet_renderer","prezi_externalserviceprovider","prezi_featureswitcher","prezi_logger","prezi_nativeapitypes","prezi_service_assetloader","prezi_service_data","prezi_service_fontcatalogue","prezi_service_media","prezi_utils","prezi_video"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_cet.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi.engine.dom"),require("prezi.engine.dom.converter.xpdom2"),require("prezi.geometry"),require("prezi.text"),require("prezi.text.model"),require("prezi_bacon"),require("prezi_cet_model"),require("prezi_cet_renderer"),require("prezi_externalserviceprovider"),require("prezi_featureswitcher"),require("prezi_logger"),require("prezi_nativeapitypes"),require("prezi_service_assetloader"),require("prezi_service_data"),require("prezi_service_fontcatalogue"),require("prezi_service_media"),require("prezi_utils"),require("prezi_video"));}else{this["prezi_cet"]=__factory(this["prezi.engine.dom"],this["prezi.engine.dom.converter.xpdom2"],this["prezi.geometry"],this["prezi.text"],this["prezi.text.model"],this["prezi_bacon"],this["prezi_cet_model"],this["prezi_cet_renderer"],this["prezi_externalserviceprovider"],this["prezi_featureswitcher"],this["prezi_logger"],this["prezi_nativeapitypes"],this["prezi_service_assetloader"],this["prezi_service_data"],this["prezi_service_fontcatalogue"],this["prezi_service_media"],this["prezi_utils"],this["prezi_video"]);}}).call(this);