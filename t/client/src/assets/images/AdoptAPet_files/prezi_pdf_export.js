;(function(){var baseUrl;var __factory=function(){var React=arguments[0];var ReactDOM=arguments[1];var ReactTransitionGroup=arguments[2];var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_pdf_export";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_client_player":dependencies[3],"prezi_externalserviceprovider":dependencies[4],"prezi_thumbnail_render":dependencies[5]}};})(),React,ReactDOM,ReactTransitionGroup);};})(arguments);var moduleImpl=(function(){return module(function(e,b,g,h){var f=e.dependencies.prezi_thumbnail_render,d={};Object.defineProperty(d,"__esModule",{value:!0});d.PdfExportImpl=class{constructor(a,c){this.pdfProvider=a;this.playerUI=c;this.preziToPdfModule=null;this.shouldStart=this.isInitialized=!1;this.playerUI.addAllAssetsLoadedHandler(()=>{this.handleAllAssetsLoaded()})}loadPdfModule(){require([e.getResourceUrl("preziToPdf.js")],(a)=>{this.preziToPdfModule=a;this.reportPdfExportInitialized();this.runIfReady()})}startPdfExport(){this.shouldStart=
!0;this.runIfReady()}cancelPdfExport(){this.reset()}handleAllAssetsLoaded(){this.isInitialized=!0;this.reportPdfExportInitialized();this.runIfReady()}reportPdfExportInitialized(){this.isInitialized&&this.preziToPdfModule&&this.pdfProvider.reportPdfExportInitialized()}runIfReady(){this.isInitialized&&this.shouldStart&&this.preziToPdfModule&&this.run()}run(){this.reset();this.pdfProvider.reportPdfExportProgress(0,this.pathLength);this.thumbnailUnsubscribe=this.playerUI.getThumbnailService().renderPath({size:f.ThumbnailSize._1920,
includePathElement:()=>!0,needHighQuality:!0}).getThumbnailStream().onValue((a)=>{this.onThumbnail(a)})}reset(){this.pdfGenerator=new this.preziToPdfModule.PreziToPdf;this.pdfGenerator.setupStream();this.thumbnails=[];this.pathLength=this.playerUI.getPathNavigator().getPath().getAllPathPositions().length;this.thumbnailUnsubscribe&&(this.thumbnailUnsubscribe(),this.thumbnailUnsubscribe=null)}onThumbnail(a){a=a.canvas.toDataURL("image/png");this.thumbnails.push(a);this.pdfProvider.reportPdfExportProgress(this.thumbnails.length,
this.pathLength);if(this.thumbnails.length===this.pathLength){try{this.pdfGenerator.setPdfInitialSize(this.pathLength),this.thumbnails.forEach((a,b)=>{this.pdfGenerator.addPage(a,b)})}catch(c){this.onError(c)}this.pdfGenerator.end().then((a)=>{const c=new FileReader;c.onloadend=()=>{const a=c.result.slice(28);this.onResult(a)};c.readAsDataURL(a)}).catch((a)=>{this.onError(a)})}}onError(a){this.pdfProvider.reportPdfExportCompleted({error:a})}onResult(a){this.pdfProvider.reportPdfExportCompleted({pdfData:a})}};
b={};Object.defineProperty(b,"__esModule",{value:!0});(function(a){a.createPdfExport=function(a){return new d.PdfExportImpl(a.pdfProvider,a.playerUI)}})(b.PdfExportModule||(b.PdfExportModule={}));return b});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_pdf_export",["require","react","react-dom","react-transition-group","prezi_client_player","prezi_externalserviceprovider","prezi_thumbnail_render"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_pdf_export.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("react"),require("react-dom"),require("react-transition-group"),require("prezi_client_player"),require("prezi_externalserviceprovider"),require("prezi_thumbnail_render"));}else{this["prezi_pdf_export"]=__factory(React,ReactDOM,ReactTransitionGroup,this["prezi_client_player"],this["prezi_externalserviceprovider"],this["prezi_thumbnail_render"]);}}).call(this);