;(function(){var baseUrl;var __factory=function(){var module=(function(dependencies){return function(init){return init.call({},(function(){return{getSpaghettiVersion:function(){return "13.0-25-g6015dbc";},getModuleName:function(){return "prezi_favorites";},getModuleVersion:function(){return "release-2021w06-base-26-gaeb382e";},getResourceUrl:function(resource){if(resource.substr(0,1)!="/"){resource="/"+resource;}return baseUrl+resource;},"dependencies":{"prezi_cet_model_editor":dependencies[0],"prezi_featureswitcher":dependencies[1],"prezi_i18n":dependencies[2],"prezi_libraryprovider":dependencies[3],"prezi_logger":dependencies[4],"prezi_plugin_api":dependencies[5],"prezi_plugin_meta":dependencies[6],"prezi_service_data":dependencies[7],"prezi_utils":dependencies[8],"prezi_widgets":dependencies[9]}};})());};})(arguments);var moduleImpl=(function(){return module(function(p){var v=p.dependencies.prezi_featureswitcher,f=p.dependencies.prezi_plugin_api,w=p.dependencies.prezi_widgets,C=p.dependencies.prezi_cet_model_editor,e=p.dependencies.prezi_i18n,z=p.dependencies.prezi_logger,b=p.dependencies.prezi_libraryprovider,x=p.dependencies.prezi_plugin_meta,D=p.dependencies.prezi_utils,y=p.dependencies.prezi_service_data,h={};Object.defineProperty(h,"__esModule",{value:!0});h.INSERT_HIGHLIGHT_ID="favoritesInsertHighlight";h.ADD_HIGHLIGHT_ID="favoritesAddToFavHighlight";
h.EMPTY_HIGHLIGHT_ID="favoritesEmptySidebarHighlight";h.FIRST_ITEM_HIGHLIGHT_ID="favoritesFirstItemHighlight";h.NON_NATIVE_INSERT_HIGHLIGHT_ID="NON_NATIVE_INSERT_HIGHLIGHT_ID";const E={around:{uiElementId:"insert"},shape:w.HoleShape.rounded,callout:null,pulse:!0},B={around:{uiElementId:"property-bar-add-favorites"},shape:w.HoleShape.rounded,pulse:!0},F={around:{uiElementId:"insertMenu/favorites-icon"},shape:w.HoleShape.rounded,pulse:!0},G={around:{uiElementId:"favorites-sidebar"},shape:w.HoleShape.rounded,
pulse:!0},H={around:{uiElementId:"listItem-0"},shape:w.HoleShape.rounded,pulse:!0};h.default=class{constructor(a){this.glassboxLogger=z.avro.Avro.createDefaultLogger();this.userSettingsApi=a;this.canStartOnboarding=!this.isMyLibraryFavoritesOnboardingShown();this.canShowNonNativeOnboarding=!this.isMyLibraryNonNativeFavoriteOnboardingShown()}isMyLibraryFavoritesOnboardingShown(){return this.userSettingsApi.getBoolean(y.UserSettingBooleanKeys.MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN)}isMyLibraryNonNativeFavoriteOnboardingShown(){return this.userSettingsApi.getBoolean(y.UserSettingBooleanKeys.MY_LIBRARY_NON_NATIVE_ONBOARDING_SHOWN)}registerSpotlights(a,
c){const {insertedImageIdToSpotlight:b}=c.getState();b&&this.canShowNonNativeOnboarding&&a.spotlight({id:h.NON_NATIVE_INSERT_HIGHLIGHT_ID,overlay:null,highlights:[{around:{preziElementId:b},shape:w.HoleShape.rounded,pulse:!0,callout:{text:e.I18n.ts("Library objects added in Prezi Design can only be edited there."),anchor:"bottom",buttons:[{id:"generic-library-learn-more",text:"Learn More",onClick:()=>{window.open("https://support.prezi.com/hc/en-us/articles/360040260973-Adding-and-reusing-content-in-your-library")}}],
onClose:()=>{c.spotlight.close(h.NON_NATIVE_INSERT_HIGHLIGHT_ID);this.finishNonNativeOnboarding()}}}]});this.isMyLibraryFavoritesOnboardingShown()||(a.spotlight({id:h.INSERT_HIGHLIGHT_ID,overlay:null,highlights:[E,F]}),a.spotlight({id:h.ADD_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},B),{callout:{text:e.I18n.ts("Add items to your library so you can easily use them again in any presentation or video"),anchor:"bottom",onClose:()=>{this.glassboxLogger.logCloseOnboardingCallout({onboarding_callout_name:"MYLIBRARY_PROPERTYBAR"});
this.hideOnboarding(c);this.finishOnboarding()}}})]}));a.spotlight({id:h.EMPTY_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},G),{callout:{text:e.I18n.ts("Select any item in the presentation."),anchor:"left",steps:{currentStep:1,lastStep:3}}})]});a.spotlight({id:h.ADD_HIGHLIGHT_ID,overlay:null,highlights:[Object.assign(Object.assign({},B),{callout:{text:e.I18n.ts("Click here to add your selection to the library."),anchor:"bottom",steps:{currentStep:2,lastStep:3}}})]});a.spotlight({id:h.FIRST_ITEM_HIGHLIGHT_ID,
overlay:null,highlights:[Object.assign(Object.assign({},H),{callout:{text:e.I18n.ts("You can access it from here."),anchor:"left",steps:{currentStep:3,lastStep:3},onClose:()=>this.handleEmptyOnboarding(c,"off")}})]})}startOnboarding(a){this.canStartOnboarding&&setTimeout(()=>a.spotlight.open(h.ADD_HIGHLIGHT_ID),100)}onboardingStep2(a){this.canStartOnboarding&&(a.spotlight.close(h.ADD_HIGHLIGHT_ID),a.spotlight.open(h.INSERT_HIGHLIGHT_ID))}hideOnboarding(a){a.spotlight.close(h.ADD_HIGHLIGHT_ID);a.spotlight.close(h.INSERT_HIGHLIGHT_ID)}finishOnboarding(){this.canStartOnboarding=
!1;this.userSettingsApi.setBoolean(y.UserSettingBooleanKeys.MY_LIBRARY_FAVORITES_ONBOARDING_SHOWN,!0)}finishNonNativeOnboarding(){this.canShowNonNativeOnboarding=!1;this.userSettingsApi.setBoolean(y.UserSettingBooleanKeys.MY_LIBRARY_NON_NATIVE_ONBOARDING_SHOWN,!0)}handleNonNativeInsert(a){a.spotlight.open(h.NON_NATIVE_INSERT_HIGHLIGHT_ID)}handleEmptyOnboarding(a,c){const {emptyOnboardingState:b}=a.getState();switch(c){case "started":"off"===b&&(a.setState({emptyOnboardingState:c}),a.spotlight.open(h.EMPTY_HIGHLIGHT_ID));
break;case "selected":"started"===b&&(a.setState({emptyOnboardingState:c}),a.spotlight.close(h.EMPTY_HIGHLIGHT_ID),a.spotlight.open(h.ADD_HIGHLIGHT_ID));break;case "added":"selected"===b&&(a.setState({emptyOnboardingState:c}),a.spotlight.close(h.ADD_HIGHLIGHT_ID),setTimeout(()=>a.spotlight.open(h.FIRST_ITEM_HIGHLIGHT_ID),1E3));break;case "off":a.setState({emptyOnboardingState:c}),a.spotlight.close(h.EMPTY_HIGHLIGHT_ID),a.spotlight.close(h.ADD_HIGHLIGHT_ID),a.spotlight.close(h.FIRST_ITEM_HIGHLIGHT_ID)}}};
var l={};Object.defineProperty(l,"__esModule",{value:!0});l.AllAssetTypesConst="all";(l.NonObjectKindAssetType||(l.NonObjectKindAssetType={})).preziDesign="prezi_design";var d={},q=this&&d.__awaiter||function(a,c,b,d){function n(a){return a instanceof b?a:new b(function(c){c(a)})}return new (b||(b=Promise))(function(b,e){function r(a){try{u(d.next(a))}catch(A){e(A)}}function g(a){try{u(d["throw"](a))}catch(A){e(A)}}function u(a){a.done?b(a.value):n(a.value).then(r,g)}u((d=d.apply(a,c||[])).next())})};
Object.defineProperty(d,"__esModule",{value:!0});var m=C.base.ObjectKind;d.FavoritesPlugin=class{constructor(){this.pasteCount=0;this.handleClickTabMenuItem=()=>{this.uiRoot.sidebar.toggle(d.FavoritesPlugin.SIDEBAR_ID);this.glassboxLogger.logClickTabMenuItem({tab_menu_item:"MYLIBRARY"});this.onboardingObj.hideOnboarding(this.uiRoot);this.onboardingObj.finishOnboarding()};this.favoriteSorterDesc=(a,c)=>{a=(new Date(a.modifiedAt)).getTime();return(new Date(c.modifiedAt)).getTime()-a};this.logger=z.LoggerModule.getLoggerManager().createLogger("prezi_favorites.FavoritesPlugin");
this.glassboxLogger=z.avro.Avro.createDefaultLogger()}init(a){this.libraryProvider=b.LibraryProviderModule.getLibraryProvider(a);this.onboardingObj=new h.default(this.userSettings);this.uiRoot=a.declareUI({sidebarOpen:!1,openSidebarOrigin:null,collectionFilter:b.CollectionFilter.allAssets,assetTypeFilter:l.AllAssetTypesConst,favoritesDataState:"none",favorites:[],isMissingItems:!1,selectionType:null,showFilterDropdowns:!1,removingFavorite:null,generalErrorMessage:"",emptyOnboardingState:"off",hasClassicFavorites:!1,
insertedImageIdToSpotlight:null},(a,b)=>{this.createMenuItems(b,a,this.uiRoot);this.createSidebar(b,a,this.uiRoot);this.createPropertyBarItems(b,a,this.uiRoot);this.createDialogs(b,a,this.uiRoot);this.onboardingObj.registerSpotlights(b,this.uiRoot)});a.onSelectionChange((a)=>{const c=a.allObjects.map((a)=>a.id),b=a.groups.map((a)=>a.id);0<c.length?this.session.document.read((a)=>{this.uiRoot.setState({selectionType:this.getSupportedSelectionObjectKind(a,c.slice(),b)})}):(this.uiRoot.setState({selectionType:null}),
this.onboardingObj.hideOnboarding(this.uiRoot),this.pasteCount>=d.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES&&this.onboardingObj.finishOnboarding());this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"selected")});a.onAfterPaste(()=>{this.pasteCount++;this.pasteCount<=d.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES&&(this.onboardingObj.startOnboarding(this.uiRoot),this.glassboxLogger.logShowOnboardingCallout({onboarding_callout_name:"MYLIBRARY_PROPERTYBAR"}))});this.supportedGenerations=this.session.document.read((a)=>
a.meta.getSupportedGenerations())}processMessage(a){switch(a.kind){case "openFavoritesSidebar":return this.uiRoot.sidebar.open(d.FavoritesPlugin.SIDEBAR_ID);case "openFavoritesFromAnotherSidebar":return this.uiRoot.setState({openSidebarOrigin:a.origin,assetTypeFilter:d.FavoritesPlugin.DefaultSelectedAssetTypeForSidebarMap[a.origin]}),this.uiRoot.sidebar.open(d.FavoritesPlugin.SIDEBAR_ID,d.FavoritesPlugin.PAGE_ID);default:D.Utils.assertNever(a)}}createMenuItems(a,c){a.createMenuItem({kind:f.MenuItemKind.largeButton,
id:"insertMenu/favorites",parent:f.TabMenuId.Insert,weight:.5,title:d.FavoritesPlugin.SIDEBAR_TITLE,icon:f.IconSmallId.MyLibrary,onClick:this.handleClickTabMenuItem});null!=c.selectionType&&a.createMenuItem({kind:f.MenuItemKind.context,id:"context-menu-add-favorites",title:d.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS,weight:120,enabled:!0,onClick:(a)=>this.onAddToFavorites(a,"context-menu")})}createPropertyBarItems(a,c){null!=c.selectionType&&(a.createPropertyBarItem((a)=>a.separator({id:"small-group-separator",
weight:14,size:w.PropertyBarSeparatorSize.Small,parent:f.PropertyBarId.Left})),a.createPropertyBarItem((a)=>a.button({id:"property-bar-add-favorites",weight:15,parent:f.PropertyBarId.Left,enabled:!0,icon:f.IconSmallId.MyLibrary,tooltip:d.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS,onClick:(a)=>this.onAddToFavorites(a,"property-bar")})))}createDialogs(a,c,b){this.createRemoveConfirmDialog(a,c,b);this.createGeneralErrorDialog(a,c,b);this.createStackPlanetErrorDialog(a,b)}createRemoveConfirmDialog(a){const {removingFavorite:c}=
this.uiRoot.getState(),b=()=>{this.uiRoot.dialog.hide(d.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID);this.uiRoot.setState({removingFavorite:null})};a.dialog.small((a)=>({id:d.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID,title:e.I18n.ts("Remove from library?"),footer:(a)=>[a.button({color:f.ButtonColor.Red,content:{text:e.I18n.ts("Yes, remove")},id:d.FavoritesPlugin.CONFIRM_DELETE_BUTTON_ID,onClick:()=>{this.glassboxLogger.logConfirmRemovalFromLibrary({mylibrary_id:c.guid});this.deleteFavorite(c);b()}}),
a.button({color:f.ButtonColor.Ghost,content:{text:e.I18n.ts("No, cancel")},id:d.FavoritesPlugin.CANCEL_DELETE_BUTTON_ID,onClick:()=>{this.glassboxLogger.logCancelRemovalFromLibrary();b()}})],content:[a.label(e.I18n.ts("This item will no longer be available in your library. Are you sure you want to remove it?"))],align:f.DialogAlign.center}))}createGeneralErrorDialog(a,c,b){a.dialog.alert(()=>({id:d.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID,title:d.FavoritesPlugin.SIDEBAR_GENERAL_ERROR_TITLE,description:c.generalErrorMessage,
footer:(a)=>[a.button({color:f.ButtonColor.Gray,content:{text:e.I18n.ts("OK")},id:d.FavoritesPlugin.GENERAL_ERROR_CLOSE_BUTTON_ID,onClick:()=>{b.dialog.hide(d.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID);b.setState({generalErrorMessage:""})}})]}))}showGeneralErrorDialog(a){this.uiRoot.setState({generalErrorMessage:a});this.uiRoot.dialog.show(d.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID)}createStackPlanetErrorDialog(a,c){a.dialog.alert(()=>({id:d.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID,title:e.I18n.ts("Unable to add planet topics to a stack"),
description:e.I18n.ts("Your item contains a planet topic type, which can only be added to other planet topics. "),footer:(a)=>[a.button({color:f.ButtonColor.Blue,content:{text:e.I18n.ts("OK")},id:d.FavoritesPlugin.STACK_INSERT_ERROR_BUTTON_ID,onClick:()=>c.dialog.hide(d.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID)}),a.button({color:f.ButtonColor.Ghost,content:{text:e.I18n.ts("Learn more")},id:d.FavoritesPlugin.STACK_INSERT_ERROR_LEARN_MORE_BUTTON_ID,onClick:()=>window.open("https://prez.is/9pbst46/",
"_blank_info")})]}))}createSidebar(a,c,b){return a.createSidebar((a)=>({id:d.FavoritesPlugin.SIDEBAR_ID,root:this.createRootPage(c,a),pages:c.openSidebarOrigin?{[d.FavoritesPlugin.PAGE_ID]:this.createRootPage(c,a)}:{},onOpen:()=>{this.loadFavorites();this.glassboxLogger.logShowMyLibraryOptions({library_source:c.openSidebarOrigin?"OTHER_SIDEBAR":"TOOLBAR"});b.setState({sidebarOpen:!0})},onClose:()=>{b.setState({sidebarOpen:!1,openSidebarOrigin:null});this.glassboxLogger.logCloseMyLibrarySidebar();
this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},onPageBack:()=>{const {pluginDescription:a,message:b}=d.FavoritesPlugin.SidebarDescriptorMap[c.openSidebarOrigin];a&&b&&this.pluginAccess.send(a,b)}}))}createRootPage(a,c){return{title:d.FavoritesPlugin.SIDEBAR_TITLE,content:this.createRootPageContent(a,c)}}createRootPageContent(a,c){const {favoritesDataState:b}=a;switch(b){case "loading":return[c.spinner(f.SpinnerColor.neutral,w.SpinnerSize.l)];case "success":return v.isActive("js-mylibrary-double-dropdown")?
[...this.createCollectionsDropwdown(c,a,this.uiRoot),...this.createAssetTypesDropwdown(c,a,this.uiRoot),...this.createFilteredFavoritesList(c)]:[...this.createMyCollectionDropwdown(c,a,this.uiRoot),...this.createFavoritesList(c)];case "error":return[c.illustration(e.I18n.ts("Something went wrong"),f.IllustrationLargeLightId.Error)];default:return[]}}getFavoriteCollectionsV3(a){return a.systemCollectionKeys&&-1===a.systemCollectionKeys.indexOf(b.CollectionFilter.myUploads)?a.systemCollectionKeys:[b.CollectionFilter.savedAssets]}convertV3ApiResponse(a){const [c,
b]=this.getDefaultThumbnailWithStatus(a.thumbnails);return Object.assign(Object.assign({},a),{thumbnailSrc:b,thumbnailStatus:c,videoThumbnailSrc:this.getVideoThumbnailSrc(a.thumbnails),collections:this.getFavoriteCollectionsV3(a)})}convertV2ApiResponse(a){return{guid:a.guid,dataVersion:a.dataVersion,data:{dataUrl:a.dataUrl,dataType:b.CopydataTypeEnum.presentation,documentGeneration:a.docGeneration},media:null,name:a.name,objectType:a.objectType,thumbnailSrc:a.thumbnailUrl,thumbnailStatus:b.ThumbnailStatus.success,
videoThumbnailSrc:a.videoThumbnailURl,createdAt:a.createdAt,modifiedAt:a.modifiedAt,collections:[b.CollectionFilter.savedAssets]}}loadFavorites(){return q(this,void 0,void 0,function*(){this.uiRoot.setState({favoritesDataState:"loading"});try{let a,c,d;if(v.isActive("js-generic-favorites")){const b=yield this.libraryProvider.getFavoritesV3();a=b.items.map((a)=>this.convertV3ApiResponse(a));this.initiateThumbnailPolling(a);c=b.meta.isMissingItems}else{const b=yield this.libraryProvider.getFavorites(this.supportedGenerations);
a=b.items.map((a)=>this.convertV2ApiResponse(a));a.sort(this.favoriteSorterDesc);c=b.meta.isMissingItems}v.isActive("js-mylibrary-enable-list-classic-favorites")?d=-1!==a.findIndex((a)=>a.objectType===b.FavoritesObjectKind.preziClassic):(a=a.filter((a)=>a.objectType!==b.FavoritesObjectKind.preziClassic),d=!1);this.uiRoot.setState({showFilterDropdowns:0<a.length,favoritesDataState:"success",favorites:a,isMissingItems:c,hasClassicFavorites:d})}catch(a){this.uiRoot.setState({favoritesDataState:"error"}),
this.logger.error({action:"error",object:"favorites-load",trigger:"machine",payload:{error:`${a}`}})}})}createCollectionsDropwdown(a,c,n){return c.showFilterDropdowns?[a.sectionHeader({content:e.I18n.ts("My collections")}),a.dropdown({id:"favorites-collection-selector",activeId:c.collectionFilter,onChange:(a,c)=>{a=this.uiRoot.getState().assetTypeFilter;-1===d.FavoritesPlugin.UPLOADABLE_ASSET_TYPES.indexOf(a)?n.setState({assetTypeFilter:l.AllAssetTypesConst,collectionFilter:c}):n.setState({collectionFilter:c});
this.glassboxLogger.logSelectMyLibraryAssetCollectionOption({collection_name:c});c===b.CollectionFilter.myUploads&&this.glassboxLogger.logSeeMyUploads();this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},options:[{id:b.CollectionFilter.allAssets,title:d.FavoritesPlugin.COLLECTION_TRANSLATIONS[b.CollectionFilter.allAssets]},{id:b.CollectionFilter.myUploads,title:d.FavoritesPlugin.COLLECTION_TRANSLATIONS[b.CollectionFilter.myUploads]},{id:b.CollectionFilter.savedAssets,title:d.FavoritesPlugin.COLLECTION_TRANSLATIONS[b.CollectionFilter.savedAssets]}]})]:
[]}createAssetTypesDropwdown(a,c,n){const {showFilterDropdowns:r,hasClassicFavorites:f}=c;return r?[a.sectionHeader({content:e.I18n.ts("Asset type")}),a.dropdown({id:"favorites-asset-type-selector",activeId:c.assetTypeFilter,onChange:(a,c)=>{n.setState({assetTypeFilter:c});this.glassboxLogger.logSelectMyLibraryAssetTypeOption({asset_type:c.toUpperCase()});this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},options:c.collectionFilter===b.CollectionFilter.myUploads?[{id:l.AllAssetTypesConst,
title:e.I18n.ts("All types")},{id:b.FavoritesObjectKind.image,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.image].plural},{id:b.FavoritesObjectKind.video,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.video].plural},{id:b.FavoritesObjectKind.pdf,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.pdf].plural}]:[{id:l.AllAssetTypesConst,title:e.I18n.ts("All types")},...this.generateAssetTypeDropdownOptions(f)]})]:[]}createMyCollectionDropwdown(a,
c,b){const {showFilterDropdowns:d,hasClassicFavorites:n}=c;return d?[a.sectionHeader({content:e.I18n.ts("My collection")}),a.dropdown({id:"favorites-asset-type-selector",activeId:c.assetTypeFilter,onChange:(a,c)=>{b.setState({assetTypeFilter:c});this.glassboxLogger.logSelectMyLibraryAssetTypeOption({asset_type:c.toUpperCase()});this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},options:[{id:l.AllAssetTypesConst,title:e.I18n.ts("All items")},...this.generateAssetTypeDropdownOptions(n)]})]:
[]}generateAssetTypeDropdownOptions(a){return[...v.isActive("js-generic-favorites")?[{id:l.NonObjectKindAssetType.preziDesign,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[l.NonObjectKindAssetType.preziDesign].plural}]:[],...v.isActive("js-mylibrary-enable-list-classic-favorites")&&a?[{id:b.FavoritesObjectKind.preziClassic,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.preziClassic].plural}]:[],{id:b.FavoritesObjectKind.topic,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.topic].plural},
{id:b.FavoritesObjectKind.image,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.image].plural},{id:b.FavoritesObjectKind.text,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.text].singular},{id:b.FavoritesObjectKind.shape,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.shape].plural},{id:b.FavoritesObjectKind.video,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.video].plural},{id:b.FavoritesObjectKind.chart,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.chart].plural},
{id:b.FavoritesObjectKind.pdf,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.pdf].plural},{id:b.FavoritesObjectKind.group,title:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[b.FavoritesObjectKind.group].plural}]}openOtherSidebar(a){if(a===b.FavoritesObjectKind.topic){const a=this.session.document.read((a)=>this.session.insertTarget.getSimpleObjectParentReader(a).kind);this.glassboxLogger.logShowTopicInsertOptions({topic_level:a===m.overview?"MAIN_TOPIC":"SUB_TOPIC",topic_sidebar_trigger:"MYLIBRARY"})}const {pluginDescription:c,
message:e}=d.FavoritesPlugin.SidebarDescriptorMap[d.FavoritesPlugin.ObjectTypeToSidebarMap[a]];c&&e&&(null!=this.uiRoot.getState().openSidebarOrigin&&(this.uiRoot.sidebar.close(d.FavoritesPlugin.PAGE_ID),this.uiRoot.sidebar.close(d.FavoritesPlugin.SIDEBAR_ID)),this.pluginAccess.send(c,e))}deleteFavorite(a){return q(this,void 0,void 0,function*(){var {favorites:c}=this.uiRoot.getState();let b=!1;try{b=v.isActive("js-generic-favorites")?yield this.libraryProvider.deleteFavoriteV3(a.guid):yield this.libraryProvider.deleteFavorite(a.guid)}catch(r){this.logger.error({action:"error",
object:"favorites-delete",trigger:"machine",payload:{error:`${r}`,guid:a.guid}})}b?(c=c.filter((c)=>c.guid!==a.guid),this.uiRoot.setState({favorites:c})):this.showGeneralErrorDialog(e.I18n.ts("We were unable to delete this item from your library. Please try again."))})}isFavoriteObjectTypeInAssetTypeFilter(a,c){const d=a.objectType;return c===l.AllAssetTypesConst?!0:c===b.FavoritesObjectKind.group?d===b.FavoritesObjectKind.group||d===b.FavoritesObjectKind.composite:c===l.NonObjectKindAssetType.preziDesign?
a.data?"design-document"===a.data.dataType:!1:d===c}isFavoriteInCollection(a,c){return c===b.CollectionFilter.allAssets||-1!==a.collections.indexOf(c)}createFilteredFavoritesList(a){const {assetTypeFilter:c,collectionFilter:n,showFilterDropdowns:r,isMissingItems:u,favorites:t}=this.uiRoot.getState(),g=c===l.AllAssetTypesConst&&n===b.CollectionFilter.allAssets?t:t.filter((a)=>this.isFavoriteInCollection(a,n)&&this.isFavoriteObjectTypeInAssetTypeFilter(a,c));if(0<g.length){var k=[];k.push(a.separator());
u?(this.glassboxLogger.logShowedMissingMyLibraryItemsMessage({asset_type:c.toUpperCase(),collection_name:n}),k.push(a.label(e.I18n.ts("There are items in your library that cannot be displayed."))),k.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({id:"stack-error-dialog-learn-more-button",color:f.ButtonColor.Gray,content:{text:e.I18n.ts("Learn more")},onClick:()=>window.open("https://prez.is/12rrhel/","_blank_info")})])),k.push(a.separator())):t.length<=d.FavoritesPlugin.ONBOARDING_VISIBLE_MAX_ITEMS&&
(k.push(a.label(e.I18n.ts("Nice collection! You can add more items anytime, including: topics, images, text, icons, shapes, videos, charts, PDFs, and even combined items."))),k.push(a.separator()));k.push(a.simpleList((a)=>({items:g.map((c)=>this.createFavoriteItem(a,c)),itemType:d.FavoritesPlugin.LIST_ITEM_TYPE_MAP[c],itemLayout:f.ListItemLayout.fixed,id:"favorites/favoritelist"})));return k}this.glassboxLogger.logShowEmptyLibrary();if(c!==l.AllAssetTypesConst&&r){if(c===l.NonObjectKindAssetType.preziDesign)return[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",
{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Save {assetType} in Prezi Design to see them in your Library.",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural.toLocaleLowerCase()}))];k=c===b.FavoritesObjectKind.group?[a.illustration(e.I18n.ts("You don\u2019t have any of these items in your library yet"),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.ts("Insert items into your presentation so you can add them to your library."))]:
[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Insert {assetType} into your presentation so you can add them to your library.",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural.toLocaleLowerCase()}))];-1!==[b.FavoritesObjectKind.chart,b.FavoritesObjectKind.image,b.FavoritesObjectKind.pdf,b.FavoritesObjectKind.shape,
b.FavoritesObjectKind.topic,b.FavoritesObjectKind.video].indexOf(c)&&k.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({color:f.ButtonColor.Gray,id:"empty-favs-open-other-sidebar",content:{text:e.I18n.tsFormatKeys("Insert {assetType}",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural})},onClick:()=>this.openOtherSidebar(c)})]));return k}return[a.illustration(e.I18n.ts("Add items to your library so you can reuse them anytime"),f.IllustrationLargeLightId.MyLibrary),
a.label(e.I18n.ts("Select an item and click the library icon in the context toolbar to add it to your library.")),a.label(e.I18n.ts("You can add topics, images, text, icons, shapes, videos, charts, PDFs, and even combined items."))]}createFavoritesList(a){const {assetTypeFilter:c,collectionFilter:n,showFilterDropdowns:r,isMissingItems:u,favorites:t}=this.uiRoot.getState(),g=c===l.AllAssetTypesConst?t:t.filter((a)=>this.isFavoriteObjectTypeInAssetTypeFilter(a,c));if(0<g.length){var k=[];k.push(a.separator());
u?(this.glassboxLogger.logShowedMissingMyLibraryItemsMessage({asset_type:c.toUpperCase(),collection_name:n}),k.push(a.label(e.I18n.ts("There are items in your library that cannot be displayed."))),k.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({id:"stack-error-dialog-learn-more-button",color:f.ButtonColor.Gray,content:{text:e.I18n.ts("Learn more")},onClick:()=>window.open("https://prez.is/12rrhel/","_blank_info")})])),k.push(a.separator())):t.length<=d.FavoritesPlugin.ONBOARDING_VISIBLE_MAX_ITEMS&&
(k.push(a.label(e.I18n.ts("Nice collection! You can add more items anytime, including: topics, images, text, icons, shapes, videos, charts, PDFs, and even combined items."))),k.push(a.separator()));k.push(a.simpleList((a)=>({items:g.map((c)=>this.createFavoriteItem(a,c)),itemType:d.FavoritesPlugin.LIST_ITEM_TYPE_MAP[c],itemLayout:f.ListItemLayout.fixed,id:"favorites/favoritelist"})));return k}if(c!==l.AllAssetTypesConst&&r){if(c===l.NonObjectKindAssetType.preziDesign)return[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",
{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Save {assetType} in Prezi Design to see them in your Library.",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural.toLocaleLowerCase()}))];k=c===b.FavoritesObjectKind.group?[a.illustration(e.I18n.ts("You don\u2019t have any of these items in your library yet"),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.ts("Insert items into your presentation so you can add them to your library."))]:
[a.illustration(e.I18n.tsFormatKeys("You don\u2019t have any {assetType} in your library yet",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural}),f.IllustrationLargeLightId.MyLibrary),a.label(e.I18n.tsFormatKeys("Insert {assetType} into your presentation so you can add them to your library.",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural.toLocaleLowerCase()}))];-1!==[b.FavoritesObjectKind.chart,b.FavoritesObjectKind.image,b.FavoritesObjectKind.pdf,b.FavoritesObjectKind.shape,
b.FavoritesObjectKind.topic,b.FavoritesObjectKind.video].indexOf(c)&&k.push(a.button(f.ButtonSize.Large,f.ButtonAlign.Start,(a)=>[a.button({color:f.ButtonColor.Gray,id:"empty-favs-open-other-sidebar",content:{text:e.I18n.tsFormatKeys("Insert {assetType}",{assetType:d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS[c].plural})},onClick:()=>this.openOtherSidebar(c)})]));return k}return[a.illustration(e.I18n.ts("Your favorite assets, all in one place."),f.IllustrationLargeLightId.MyLibrary),a.paragraph(e.I18n.ts("Library"),
e.I18n.ts("Store all your favorite assets for easy access.")),a.button(f.ButtonSize.Small,f.ButtonAlign.Center,(a)=>[a.button({color:f.ButtonColor.Gray,flexibleWidth:!0,id:"empty-favs-onboarding",content:{text:"Get Started"},onClick:()=>this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"started")})]),a.paragraph(e.I18n.ts("Pro Tip"),e.I18n.ts("You can save assets from other places, too.")),a.button(f.ButtonSize.Small,f.ButtonAlign.Center,(a)=>[a.button({color:f.ButtonColor.Gray,flexibleWidth:!0,
id:"pro-tip-read-more",content:{text:"Read More"},onClick:()=>{window.open("https://support.prezi.com/hc/en-us/articles/360040260973-Adding-and-reusing-content-in-your-library","_blank")}})])]}getVideoThumbnailSrc(a){return a.reduce((a,b)=>{b.urls.mp4&&a.push(b.urls.mp4);return a},[])[0]}getThumbnailWithStatus(a){return q(this,void 0,void 0,function*(){const c=yield this.libraryProvider.getFavoriteThumbnailWithStatus(a.guid,a.dataVersion);return c.status===b.ThumbnailStatus.success?this.getDefaultThumbnailWithStatus(c.thumbnails):
c.status===b.ThumbnailStatus.failed?[c.status,""]:[c.status,null]})}getDefaultThumbnailWithStatus(a){const c=a.sort((a,c)=>a.width-c.width);if(a=a.find((a)=>700===a.width))return[b.ThumbnailStatus.success,a.urls.png];if(0===c.length)return[b.ThumbnailStatus.none,null];if(c[0].urls.png)return[b.ThumbnailStatus.success,c[0].urls.png];if(c[0].urls.jpg)return[b.ThumbnailStatus.success,c[0].urls.jpg];for(const a of c){if(a.urls.png)return[b.ThumbnailStatus.success,a.urls.png];if(a.urls.jpg)return[b.ThumbnailStatus.success,
a.urls.jpg]}return[b.ThumbnailStatus.failed,""]}initiateThumbnailPolling(a){return q(this,void 0,void 0,function*(){a.filter((a)=>a.thumbnailStatus===b.ThumbnailStatus.none||a.thumbnailStatus===b.ThumbnailStatus.inProgress).forEach((a)=>{this.pollThumbnailWithRetries(a)})})}pollThumbnailWithRetries(a,c=0){return q(this,void 0,void 0,function*(){const [e,f]=yield this.getThumbnailWithStatus(a);if(e===b.ThumbnailStatus.inProgress&&c<d.FavoritesPlugin.MAX_RETRIES)setTimeout(()=>{this.pollThumbnailWithRetries(a,
++c)},5>c?1E3:500*c);else{const t=Object.assign(Object.assign({},a),{thumbnailSrc:f,thumbnailStatus:c>=d.FavoritesPlugin.MAX_RETRIES?b.ThumbnailStatus.failed:e});var {favorites:u}=this.uiRoot.getState();u=u.map((a)=>a.guid===t.guid?t:a);this.uiRoot.setState({favorites:u})}})}createFavoriteItem(a,c){const b=c.thumbnailSrc,r=this.isDesignFavorite(c);return a.droppableImage({src:{url:b},badge:r?f.IconSmallId.NotEditable:null,badgeTooltipText:r?e.I18n.ts("Can be edited only in the editor where it was created"):
null,addChecker:!0,onDrop:(a,b)=>{this.insertFavorite(a,c,b);this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"off")},primaryAction:{id:"primaryAction",onClick:()=>{this.uiRoot.setState({removingFavorite:c});this.uiRoot.dialog.show(d.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID);this.glassboxLogger.logRemoveFromLibraryButton()},icon:f.IconSmallId.Trash,enabled:!0,title:"Delete"}})}getParsedCopyData(a){return q(this,void 0,void 0,function*(){let c;c=v.isActive("js-generic-favorites")?yield this.libraryProvider.getFavoriteDataV3(a):
yield this.libraryProvider.getFavoriteData(a);return this.session.document.parseCopyDataAsync(JSON.stringify(c))})}insertCopyData(a,c,b){return q(this,void 0,void 0,function*(){return a.doAsync(c,(a,c)=>{a.isValid()&&this.session.document.executeApiCommand(a,{name:"insertFavorite",run:(f)=>{f=this.session.insertTarget.getSimpleObjectParent(f);var g=f.add.inserter(c);if(g.isValid()){g=g.insert();0<g.topics.length&&0===g.simpleObjects.length&&this.fixInsertedTopicPosition(f,g.topics);if(0<g.simpleObjects.length){const a=
1===g.simpleObjects.length?g.simpleObjects[0]:g.simpleObjects[0].createLayoutGroupWith(g.simpleObjects.slice(1));a.fitInto(this.session.positionFinder.findLayoutBox(f,a.layoutBox.size.width,a.layoutBox.size.height,b.stageX,b.stageY).withRotationRad(1===g.simpleObjects.length?0:a.layoutBox.rotationRad))}this.session.selection.setSelection(a,g.simpleObjects);this.session.selection.addToSelection(a,g.topics)}else f.is(m.page)||f.is(m.stackTopic)?this.uiRoot.dialog.show(d.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID):
this.showGeneralErrorDialog(e.I18n.ts("We were unable to add this item to your library. Please try again."))}})})})}insertMediaId(a,b,d,f){return q(this,void 0,void 0,function*(){return a.doAsync(b,(a,b)=>{if(a.isValid()){const c=b.exportedImageMediaAssetId;c?(this.session.document.executeApiCommand(a,{name:"insert exported image favorite",run:(a)=>{a=this.session.insertTarget.getSimpleObjectParent(a);var b=this.session.document.progressiveAssetManager.createExportedImageAssetFromMediaId(c);b=a.add.image(b.token);
b.fitInto(this.session.positionFinder.findLayoutBox(a,b.layoutBox.size.width,b.layoutBox.size.height,f.stageX,f.stageY));this.uiRoot.setState({insertedImageIdToSpotlight:b.id})}}),this.onboardingObj.handleNonNativeInsert(this.uiRoot)):(this.showGeneralErrorDialog(e.I18n.ts("We were unable to insert this. Please try again.")),this.logger.error({action:"error",object:"favorites-get-media",trigger:"machine",payload:{message:`No ExportedImageMediaAssetId for favorite with guid: ${d.guid} and dataVersion: ${d.dataVersion}`}}))}})})}isDesignFavorite(a){return a.data?
a.data.dataType===b.CopydataTypeEnum.design:!1}isCompatiblePresentationFavorite(a){if(v.isActive("js-generic-favorites")){const c=this.session.document.read((a)=>a.meta.getSupportedGenerations());return a.data&&a.data.dataType===b.CopydataTypeEnum.presentation&&-1!==c.indexOf(a.data.documentGeneration)}return!0}getLoggingAssetType(a){return this.isDesignFavorite(a)?"PUBLISH":a.objectType.toString().toUpperCase()}insertFavorite(a,b,d){return q(this,void 0,void 0,function*(){if(this.isCompatiblePresentationFavorite(b)){var c=
this.getParsedCopyData(b.data.dataUrl);this.insertCopyData(a,c,d)}else c=this.libraryProvider.getFavoriteMedia(b.guid),this.insertMediaId(a,c,b,d);this.glassboxLogger.logInsertMyLibraryItem({asset_type:this.getLoggingAssetType(b),mylibrary_id:b.guid,collection_name:this.isDesignFavorite(b)?"PUBLISH":null})})}fixInsertedTopicPosition(a,b){if(a.is(m.overview)||a.is(m.planetTopic)){const c=a.topicChildren.slice(0);b.forEach((a)=>{a.fitInto(this.session.positionFinder.findTopicPosition(a,c))});a.is(m.planetTopic)&&
a.layout.adjust(b)}}onAddToFavorites(a,b){return q(this,void 0,void 0,function*(){const c=this.uiRoot.getState().selectionType;switch(b){case "context-menu":this.glassboxLogger.logClickContextMenu({context_item:"ADDTO_MYLIBRARY",object_id:"context-menu-add-favorites",object_type:d.FavoritesPlugin.FavoriteKindToLogObjectType.get(c)});break;case "property-bar":this.glassboxLogger.logClickPropertyBar({property_item:"ADDTO_MYLIBRARY"})}let e=null;this.onboardingObj.onboardingStep2(this.uiRoot);const f=
yield this.session.document.executeApiCommand(a,{name:"Add to favorites",run:(a)=>0<this.session.selection.getSelectionInfo(a).allObjects.length?(e=a.meta.generation,this.getDataAndSnapshot(a)):null});if(f&&e){const a=f.snapshot.toDataURL();this.addToFavorites(f.data,a,this.session.document.preziMetaData.preziOid,e,c,f.assetId);this.flightAnimation(f.layoutBox,a,f.snapshotSize);this.onboardingObj.onboardingStep2(this.uiRoot);this.onboardingObj.handleEmptyOnboarding(this.uiRoot,"added")}})}flightAnimation(a,
b){return q(this,void 0,void 0,function*(){const c=a.scaleToWidth(100).size;var d=document.querySelector(".koi-editor-ui-storyline"),e=d?d.getBoundingClientRect().width:0;d?d.getBoundingClientRect().height:0;var f=document.querySelector("[data-lookup=sidebar-root-page]");d=f?f.getBoundingClientRect().width:0;f?f.getBoundingClientRect().height:0;(f=document.querySelector(".koi-topmenu"))?f.getBoundingClientRect().width:0;f=f?f.getBoundingClientRect().height:0;var g=document.querySelector(".koi-topmenu");
g?g.getBoundingClientRect().width:0;g=g?g.getBoundingClientRect().height:0;f+=g;f=f+(window.innerHeight-f)/2-c.height/2;e=e+(window.innerWidth-e-d)/2-c.width/2;g=d=0;if(this.uiRoot.getState().sidebarOpen)g=document.querySelector("div [data-lookup=favorites-sidebar]").getBoundingClientRect(),d=g.top+220-c.height/4,g=g.left+(g.width-c.width)/2,!0;else{const a=document.querySelector("div [data-lookup=insert]");a&&(g=a.getBoundingClientRect(),d=g.top+(g.height-c.height/2)/2,g=g.left+(g.width-c.width)/
2,!0)}const k=document.createElement("style");k.innerHTML=`
			@keyframes favanim {
			    0% {
			      opacity: 0;
			      transform: scale(0);
			      top: ${f}px;
			      left: ${e}px;
			    }

				20% {
                  opacity: 1;
                  transform: scale(2);
				}

			    30% {
			      opacity: 1;
			      transform: scale(1);
			      top: ${f}px;
			      left: ${e}px;
			    }

				60% {
			      opacity: 1;
			    }

				100% {
			      opacity: 0;
			      transform: scale(0.2);
			      top: ${d}px;
			      left: ${g}px;
			    }
			}
		`;document.head.appendChild(k);const h=document.createElement("img");h.id="fly-animation-object";h.src=b;h.width=100;h.height=100;h.style.zIndex="10000";h.style.position="fixed";h.style.animation="favanim 1.5s";document.body.appendChild(h);window.setTimeout(()=>{document.body.removeChild(h);document.head.removeChild(k)},2500)})}addToFavorites(a,b,d,f,h,t){return q(this,void 0,void 0,function*(){const {favorites:c,assetTypeFilter:k}=this.uiRoot.getState();try{let e;const g={data:a,documentGeneration:f,
favoriteType:h,name:`${this.session.document.preziMetaData.title} ${h}`};if(v.isActive("js-generic-favorites")){const a=Object.assign(Object.assign({},g),{thumbnailImage:b,origin:{preziOid:d,schemaVersion:"2"}}),c=yield this.libraryProvider.createFavoriteV3(a);e=this.convertV3ApiResponse(c);e.thumbnailSrc=b}else{const a=Object.assign(Object.assign({},g),{thumbnailImage:b,origPreziOid:d}),c=yield this.libraryProvider.createFavorite(a);e=this.convertV2ApiResponse(c)}this.glassboxLogger.logSavedMyLibraryItem({asset_oid:t,
asset_type:this.getLoggingAssetType(e),mylibrary_id:e.guid});const n=c.slice();n.unshift(e);const m=this.isFavoriteObjectTypeInAssetTypeFilter(e,k)?k:l.AllAssetTypesConst;this.uiRoot.setState({assetTypeFilter:m,showFilterDropdowns:!0,favorites:n})}catch(I){this.showGeneralErrorDialog(e.I18n.ts("We were unable to add this item to your library. Please try again.")),this.logger.error({action:"error",object:"favorites-add",trigger:"machine",payload:{error:`${I}`}})}})}getDataAndSnapshot(a){return q(this,
void 0,void 0,function*(){var b=this.session.selection.getSelectionInfo(a).allObjects;let d,e,f;if(1<b.length)e=b[0].createLayoutGroupWith(b.slice(1)).copy().serialize(),d=b.map((a)=>a.layoutBox.aabb).reduce((a,b)=>a.union(b)),f="group";else{var h=b[0].rotationRad;b[0].rotationRad=0;e=b[0].copy().serialize();d=b[0].layoutBox.aabb;f=b[0].id;b[0].rotationRad=h}const g={width:700,height:700};b=yield this.session.snapshot(h?d.withRotationRad(h):d,{width:g.width,height:g.height},!1,b);h=document.createElement("canvas");
const k=h.getContext("2d");h.width=g.width;h.height=g.height;k.fillStyle="transparent";k.fillRect(0,0,g.width,g.height);k.drawImage(b,0,0);return{data:e,snapshot:h,snapshotSize:g,assetId:f,layoutBox:d}})}getSupportedSelectionObjectKind(a,c,d){1<c.length?a=1===d.length?b.FavoritesObjectKind.group:b.FavoritesObjectKind.composite:(a=a.lookup.transformedObject(c[0]),a=this.mapObjectKindToFavoriteKind(a.kind));return a||null}mapObjectKindToFavoriteKind(a){return d.FavoritesPlugin.ObjectKindToFavorite.get(a)}};
d.FavoritesPlugin.SIDEBAR_ID="favorites-sidebar";d.FavoritesPlugin.PAGE_ID="favorites-ugly-hack-kill-me-please";d.FavoritesPlugin.CONFIRM_DELETE_DIALOG_ID="confirm-delete-favorite-dialog";d.FavoritesPlugin.GENERAL_ERROR_DIALOG_ID="general-error-dialog-favorites";d.FavoritesPlugin.STACK_INSERT_ERROR_DIALOG_ID="stack-insert-error-dialog-favorites";d.FavoritesPlugin.GENERAL_ERROR_CLOSE_BUTTON_ID="general-error-close-dialog-favorites";d.FavoritesPlugin.CONFIRM_DELETE_BUTTON_ID="confirm-delete-favorite-button";
d.FavoritesPlugin.CANCEL_DELETE_BUTTON_ID="cancel-delete-favorite-button";d.FavoritesPlugin.STACK_INSERT_ERROR_BUTTON_ID="stack-insert-error-button-favorites";d.FavoritesPlugin.STACK_INSERT_ERROR_LEARN_MORE_BUTTON_ID="stack-error-dialog-learn-more-button";d.FavoritesPlugin.SIDEBAR_TITLE=e.I18n.ts("My Library");d.FavoritesPlugin.ONBOARDING_VISIBLE_MAX_ITEMS=4;d.FavoritesPlugin.ONBOARDING_STARTS_UNTIL_PASTES=2;d.FavoritesPlugin.MAX_RETRIES=10;d.FavoritesPlugin.SIDEBAR_BUTTON_TRANSLATIONS=e.I18n.ts("Add to my library");
d.FavoritesPlugin.SIDEBAR_GENERAL_ERROR_TITLE=e.I18n.ts("Something went wrong");d.FavoritesPlugin.ASSET_TYPE_TRANSLATIONS={[b.FavoritesObjectKind.topic]:{plural:e.I18n.ts("Topics"),singular:e.I18n.ts("Topic")},[b.FavoritesObjectKind.image]:{plural:e.I18n.ts("Images"),singular:e.I18n.ts("Image")},[b.FavoritesObjectKind.text]:{plural:e.I18n.ts("Text"),singular:e.I18n.ts("Text")},[b.FavoritesObjectKind.shape]:{plural:e.I18n.ts("Shapes"),singular:e.I18n.ts("Shape")},[b.FavoritesObjectKind.video]:{plural:e.I18n.ts("Videos"),
singular:e.I18n.ts("Video")},[b.FavoritesObjectKind.chart]:{plural:e.I18n.ts("Charts"),singular:e.I18n.ts("Chart")},[b.FavoritesObjectKind.pdf]:{plural:e.I18n.ts("Icons and PDFs"),singular:e.I18n.ts("Icon or PDF")},[b.FavoritesObjectKind.group]:{plural:e.I18n.ts("Grouped items"),singular:e.I18n.ts("Grouped item")},[b.FavoritesObjectKind.composite]:{plural:e.I18n.ts("Combined items"),singular:e.I18n.ts("Combined item")},[l.NonObjectKindAssetType.preziDesign]:{plural:e.I18n.ts("Design items"),singular:e.I18n.ts("Design item")},
[b.FavoritesObjectKind.preziClassic]:{plural:e.I18n.ts("Classic items"),singular:e.I18n.ts("Classic item")}};d.FavoritesPlugin.UPLOADABLE_ASSET_TYPES=[b.FavoritesObjectKind.image,b.FavoritesObjectKind.video,b.FavoritesObjectKind.pdf];d.FavoritesPlugin.COLLECTION_TRANSLATIONS={[b.CollectionFilter.allAssets]:e.I18n.ts("All assets"),[b.CollectionFilter.myUploads]:e.I18n.ts("My uploads"),[b.CollectionFilter.savedAssets]:e.I18n.ts("My saved assets")};d.FavoritesPlugin.LIST_ITEM_TYPE_MAP={[l.AllAssetTypesConst]:f.ListItemType.small,
[b.FavoritesObjectKind.topic]:f.ListItemType.full,[b.FavoritesObjectKind.image]:f.ListItemType.large,[b.FavoritesObjectKind.text]:f.ListItemType.full,[b.FavoritesObjectKind.shape]:f.ListItemType.large,[b.FavoritesObjectKind.video]:f.ListItemType.large,[b.FavoritesObjectKind.chart]:f.ListItemType.large,[b.FavoritesObjectKind.pdf]:f.ListItemType.large,[b.FavoritesObjectKind.group]:f.ListItemType.full,[b.FavoritesObjectKind.composite]:f.ListItemType.full,[l.NonObjectKindAssetType.preziDesign]:f.ListItemType.small,
[b.FavoritesObjectKind.preziClassic]:f.ListItemType.large};d.FavoritesPlugin.ObjectKindToFavorite=new Map([[m.planetTopic,b.FavoritesObjectKind.topic],[m.stackTopic,b.FavoritesObjectKind.topic],[m.image,b.FavoritesObjectKind.image],[m.text,b.FavoritesObjectKind.text],[m.shape,b.FavoritesObjectKind.shape],[m.arc,b.FavoritesObjectKind.shape],[m.video,b.FavoritesObjectKind.video],[m.chart,b.FavoritesObjectKind.chart],[m.pdf,b.FavoritesObjectKind.pdf],[m.swf,b.FavoritesObjectKind.pdf],[m.group,b.FavoritesObjectKind.group]]);
d.FavoritesPlugin.FavoriteKindToLogObjectType=new Map([[b.FavoritesObjectKind.topic,"TOPIC"],[b.FavoritesObjectKind.image,"IMAGE"],[b.FavoritesObjectKind.text,"TEXT"],[b.FavoritesObjectKind.shape,"SHAPE"],[b.FavoritesObjectKind.video,"VIDEO"],[b.FavoritesObjectKind.chart,"CHART"],[b.FavoritesObjectKind.pdf,"PDF"],[b.FavoritesObjectKind.group,"MULTIPLE"],[b.FavoritesObjectKind.composite,"MULTIPLE"]]);d.FavoritesPlugin.SidebarDescriptorMap={["image"]:{pluginDescription:x.imageInsert,message:"openImageInsertSidebar"},
["icon"]:{pluginDescription:x.iconInsert,message:"openIconInsertSidebar"},["storyblocks"]:{pluginDescription:x.storyblocks,message:{kind:"openStoryblocksSidebar",trigger:"MYLIBRARY"}},["video"]:{pluginDescription:x.videoInsert,message:"openVideoInsertSidebar"},["charts"]:{pluginDescription:x.chartInsert,message:"openChartInsertSidebar"},["arcs"]:{pluginDescription:x.shapeAndArcEditor,message:"openArcInsertSidebar"},["shapes"]:{pluginDescription:x.shapeAndArcEditor,message:"openShapeInsertSidebar"}};
d.FavoritesPlugin.ObjectTypeToSidebarMap={[b.FavoritesObjectKind.image]:"image",[b.FavoritesObjectKind.pdf]:"icon",[b.FavoritesObjectKind.chart]:"charts",[b.FavoritesObjectKind.shape]:"shapes",[b.FavoritesObjectKind.video]:"video",[b.FavoritesObjectKind.topic]:"storyblocks"};d.FavoritesPlugin.DefaultSelectedAssetTypeForSidebarMap={["image"]:b.FavoritesObjectKind.image,["icon"]:b.FavoritesObjectKind.pdf,["storyblocks"]:b.FavoritesObjectKind.topic,["video"]:b.FavoritesObjectKind.video,["charts"]:b.FavoritesObjectKind.chart,
["arcs"]:b.FavoritesObjectKind.shape,["shapes"]:b.FavoritesObjectKind.shape};p={};Object.defineProperty(p,"__esModule",{value:!0});p.lazyModule={createPlugin(){return new d.FavoritesPlugin}};return p});

})() || {};
moduleImpl["module"]=moduleImpl;
return moduleImpl;};if(typeof define==="function"&&define.amd){define("prezi_favorites",["require","prezi_cet_model_editor","prezi_featureswitcher","prezi_i18n","prezi_libraryprovider","prezi_logger","prezi_plugin_api","prezi_plugin_meta","prezi_service_data","prezi_utils","prezi_widgets"],function(){var moduleUrl=arguments[0]["toUrl"]("prezi_favorites.js");baseUrl=moduleUrl.substr(0,moduleUrl.lastIndexOf("/"));return(__factory).apply({},[].slice.call(arguments,1));});}else if(typeof exports==="object"&&typeof exports.nodeName!=="string"){baseUrl=__dirname;module.exports=(__factory)(require("prezi_cet_model_editor"),require("prezi_featureswitcher"),require("prezi_i18n"),require("prezi_libraryprovider"),require("prezi_logger"),require("prezi_plugin_api"),require("prezi_plugin_meta"),require("prezi_service_data"),require("prezi_utils"),require("prezi_widgets"));}else{this["prezi_favorites"]=__factory(this["prezi_cet_model_editor"],this["prezi_featureswitcher"],this["prezi_i18n"],this["prezi_libraryprovider"],this["prezi_logger"],this["prezi_plugin_api"],this["prezi_plugin_meta"],this["prezi_service_data"],this["prezi_utils"],this["prezi_widgets"]);}}).call(this);